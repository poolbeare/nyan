import{h as ia,r as zm,n as Mn,o as Yr,_ as Hm}from"./index-05d1abdc.js";import{r as Gd}from"./events-86ccc6d8.js";var qr=Gd();const Bu=ia(qr);var zu={},na={},Ue={},Wd={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,g){var p=f>>>16&65535,v=f&65535,D=g>>>16&65535,S=g&65535;return v*S+(p*S+v*D<<16>>>0)|0}i.mul=Math.imul||e;function t(f,g){return f+g|0}i.add=t;function s(f,g){return f-g|0}i.sub=s;function o(f,g){return f<<g|f>>>32-g}i.rotl=o;function c(f,g){return f<<32-g|f>>>g}i.rotr=c;function l(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||l,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(Wd);Object.defineProperty(Ue,"__esModule",{value:!0});var Yd=Wd;function Km(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}Ue.readInt16BE=Km;function km(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}Ue.readUint16BE=km;function Vm(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}Ue.readInt16LE=Vm;function Gm(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}Ue.readUint16LE=Gm;function Jd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}Ue.writeUint16BE=Jd;Ue.writeInt16BE=Jd;function Qd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}Ue.writeUint16LE=Qd;Ue.writeInt16LE=Qd;function hu(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}Ue.readInt32BE=hu;function lu(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}Ue.readUint32BE=lu;function fu(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}Ue.readInt32LE=fu;function du(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}Ue.readUint32LE=du;function Jo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}Ue.writeUint32BE=Jo;Ue.writeInt32BE=Jo;function Qo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}Ue.writeUint32LE=Qo;Ue.writeInt32LE=Qo;function Wm(i,e){e===void 0&&(e=0);var t=hu(i,e),s=hu(i,e+4);return t*4294967296+s-(s>>31)*4294967296}Ue.readInt64BE=Wm;function Ym(i,e){e===void 0&&(e=0);var t=lu(i,e),s=lu(i,e+4);return t*4294967296+s}Ue.readUint64BE=Ym;function Jm(i,e){e===void 0&&(e=0);var t=fu(i,e),s=fu(i,e+4);return s*4294967296+t-(t>>31)*4294967296}Ue.readInt64LE=Jm;function Qm(i,e){e===void 0&&(e=0);var t=du(i,e),s=du(i,e+4);return s*4294967296+t}Ue.readUint64LE=Qm;function Xd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Jo(i/4294967296>>>0,e,t),Jo(i>>>0,e,t+4),e}Ue.writeUint64BE=Xd;Ue.writeInt64BE=Xd;function Zd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Qo(i>>>0,e,t),Qo(i/4294967296>>>0,e,t+4),e}Ue.writeUint64LE=Zd;Ue.writeInt64LE=Zd;function Xm(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Ue.readUintBE=Xm;function Zm(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}Ue.readUintLE=Zm;function ew(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Yd.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Ue.writeUintBE=ew;function tw(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Yd.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}Ue.writeUintLE=tw;function rw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}Ue.readFloat32BE=rw;function iw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}Ue.readFloat32LE=iw;function nw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}Ue.readFloat64BE=nw;function sw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}Ue.readFloat64LE=sw;function ow(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}Ue.writeFloat32BE=ow;function aw(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}Ue.writeFloat32LE=aw;function cw(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}Ue.writeFloat64BE=cw;function uw(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}Ue.writeFloat64LE=uw;var Cr={};Object.defineProperty(Cr,"__esModule",{value:!0});function hw(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Cr.wipe=hw;Object.defineProperty(na,"__esModule",{value:!0});var Zt=Ue,pu=Cr,lw=20;function fw(i,e,t){for(var s=1634760805,o=857760878,c=2036477234,l=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],g=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],v=t[15]<<24|t[14]<<16|t[13]<<8|t[12],D=t[19]<<24|t[18]<<16|t[17]<<8|t[16],S=t[23]<<24|t[22]<<16|t[21]<<8|t[20],x=t[27]<<24|t[26]<<16|t[25]<<8|t[24],O=t[31]<<24|t[30]<<16|t[29]<<8|t[28],q=e[3]<<24|e[2]<<16|e[1]<<8|e[0],H=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ie=e[11]<<24|e[10]<<16|e[9]<<8|e[8],$=e[15]<<24|e[14]<<16|e[13]<<8|e[12],j=s,C=o,T=c,E=l,u=f,w=g,G=p,W=v,se=D,ue=S,de=x,b=O,A=q,ee=H,Q=ie,k=$,V=0;V<lw;V+=2)j=j+u|0,A^=j,A=A>>>32-16|A<<16,se=se+A|0,u^=se,u=u>>>32-12|u<<12,C=C+w|0,ee^=C,ee=ee>>>32-16|ee<<16,ue=ue+ee|0,w^=ue,w=w>>>32-12|w<<12,T=T+G|0,Q^=T,Q=Q>>>32-16|Q<<16,de=de+Q|0,G^=de,G=G>>>32-12|G<<12,E=E+W|0,k^=E,k=k>>>32-16|k<<16,b=b+k|0,W^=b,W=W>>>32-12|W<<12,T=T+G|0,Q^=T,Q=Q>>>32-8|Q<<8,de=de+Q|0,G^=de,G=G>>>32-7|G<<7,E=E+W|0,k^=E,k=k>>>32-8|k<<8,b=b+k|0,W^=b,W=W>>>32-7|W<<7,C=C+w|0,ee^=C,ee=ee>>>32-8|ee<<8,ue=ue+ee|0,w^=ue,w=w>>>32-7|w<<7,j=j+u|0,A^=j,A=A>>>32-8|A<<8,se=se+A|0,u^=se,u=u>>>32-7|u<<7,j=j+w|0,k^=j,k=k>>>32-16|k<<16,de=de+k|0,w^=de,w=w>>>32-12|w<<12,C=C+G|0,A^=C,A=A>>>32-16|A<<16,b=b+A|0,G^=b,G=G>>>32-12|G<<12,T=T+W|0,ee^=T,ee=ee>>>32-16|ee<<16,se=se+ee|0,W^=se,W=W>>>32-12|W<<12,E=E+u|0,Q^=E,Q=Q>>>32-16|Q<<16,ue=ue+Q|0,u^=ue,u=u>>>32-12|u<<12,T=T+W|0,ee^=T,ee=ee>>>32-8|ee<<8,se=se+ee|0,W^=se,W=W>>>32-7|W<<7,E=E+u|0,Q^=E,Q=Q>>>32-8|Q<<8,ue=ue+Q|0,u^=ue,u=u>>>32-7|u<<7,C=C+G|0,A^=C,A=A>>>32-8|A<<8,b=b+A|0,G^=b,G=G>>>32-7|G<<7,j=j+w|0,k^=j,k=k>>>32-8|k<<8,de=de+k|0,w^=de,w=w>>>32-7|w<<7;Zt.writeUint32LE(j+s|0,i,0),Zt.writeUint32LE(C+o|0,i,4),Zt.writeUint32LE(T+c|0,i,8),Zt.writeUint32LE(E+l|0,i,12),Zt.writeUint32LE(u+f|0,i,16),Zt.writeUint32LE(w+g|0,i,20),Zt.writeUint32LE(G+p|0,i,24),Zt.writeUint32LE(W+v|0,i,28),Zt.writeUint32LE(se+D|0,i,32),Zt.writeUint32LE(ue+S|0,i,36),Zt.writeUint32LE(de+x|0,i,40),Zt.writeUint32LE(b+O|0,i,44),Zt.writeUint32LE(A+q|0,i,48),Zt.writeUint32LE(ee+H|0,i,52),Zt.writeUint32LE(Q+ie|0,i,56),Zt.writeUint32LE(k+$|0,i,60)}function ep(i,e,t,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,l;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),l=c.length-e.length,c.set(e,l)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,l=o}for(var f=new Uint8Array(64),g=0;g<t.length;g+=64){fw(f,c,i);for(var p=g;p<g+64&&p<t.length;p++)s[p]=t[p]^f[p-g];pw(c,0,l)}return pu.wipe(f),o===0&&pu.wipe(c),s}na.streamXOR=ep;function dw(i,e,t,s){return s===void 0&&(s=0),pu.wipe(t),ep(i,e,t,t,s)}na.stream=dw;function pw(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var tp={},Mi={};Object.defineProperty(Mi,"__esModule",{value:!0});function gw(i,e,t){return~(i-1)&e|i-1&t}Mi.select=gw;function yw(i,e){return(i|0)-(e|0)-1>>>31&1}Mi.lessOrEqual=yw;function rp(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}Mi.compare=rp;function vw(i,e){return i.length===0||e.length===0?!1:rp(i,e)!==0}Mi.equal=vw;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Mi,t=Cr;i.DIGEST_LENGTH=16;var s=function(){function l(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=f[0]|f[1]<<8;this._r[0]=g&8191;var p=f[2]|f[3]<<8;this._r[1]=(g>>>13|p<<3)&8191;var v=f[4]|f[5]<<8;this._r[2]=(p>>>10|v<<6)&7939;var D=f[6]|f[7]<<8;this._r[3]=(v>>>7|D<<9)&8191;var S=f[8]|f[9]<<8;this._r[4]=(D>>>4|S<<12)&255,this._r[5]=S>>>1&8190;var x=f[10]|f[11]<<8;this._r[6]=(S>>>14|x<<2)&8191;var O=f[12]|f[13]<<8;this._r[7]=(x>>>11|O<<5)&8065;var q=f[14]|f[15]<<8;this._r[8]=(O>>>8|q<<8)&8191,this._r[9]=q>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return l.prototype._blocks=function(f,g,p){for(var v=this._fin?0:2048,D=this._h[0],S=this._h[1],x=this._h[2],O=this._h[3],q=this._h[4],H=this._h[5],ie=this._h[6],$=this._h[7],j=this._h[8],C=this._h[9],T=this._r[0],E=this._r[1],u=this._r[2],w=this._r[3],G=this._r[4],W=this._r[5],se=this._r[6],ue=this._r[7],de=this._r[8],b=this._r[9];p>=16;){var A=f[g+0]|f[g+1]<<8;D+=A&8191;var ee=f[g+2]|f[g+3]<<8;S+=(A>>>13|ee<<3)&8191;var Q=f[g+4]|f[g+5]<<8;x+=(ee>>>10|Q<<6)&8191;var k=f[g+6]|f[g+7]<<8;O+=(Q>>>7|k<<9)&8191;var V=f[g+8]|f[g+9]<<8;q+=(k>>>4|V<<12)&8191,H+=V>>>1&8191;var J=f[g+10]|f[g+11]<<8;ie+=(V>>>14|J<<2)&8191;var re=f[g+12]|f[g+13]<<8;$+=(J>>>11|re<<5)&8191;var we=f[g+14]|f[g+15]<<8;j+=(re>>>8|we<<8)&8191,C+=we>>>5|v;var oe=0,be=oe;be+=D*T,be+=S*(5*b),be+=x*(5*de),be+=O*(5*ue),be+=q*(5*se),oe=be>>>13,be&=8191,be+=H*(5*W),be+=ie*(5*G),be+=$*(5*w),be+=j*(5*u),be+=C*(5*E),oe+=be>>>13,be&=8191;var le=oe;le+=D*E,le+=S*T,le+=x*(5*b),le+=O*(5*de),le+=q*(5*ue),oe=le>>>13,le&=8191,le+=H*(5*se),le+=ie*(5*W),le+=$*(5*G),le+=j*(5*w),le+=C*(5*u),oe+=le>>>13,le&=8191;var _e=oe;_e+=D*u,_e+=S*E,_e+=x*T,_e+=O*(5*b),_e+=q*(5*de),oe=_e>>>13,_e&=8191,_e+=H*(5*ue),_e+=ie*(5*se),_e+=$*(5*W),_e+=j*(5*G),_e+=C*(5*w),oe+=_e>>>13,_e&=8191;var z=oe;z+=D*w,z+=S*u,z+=x*E,z+=O*T,z+=q*(5*b),oe=z>>>13,z&=8191,z+=H*(5*de),z+=ie*(5*ue),z+=$*(5*se),z+=j*(5*W),z+=C*(5*G),oe+=z>>>13,z&=8191;var B=oe;B+=D*G,B+=S*w,B+=x*u,B+=O*E,B+=q*T,oe=B>>>13,B&=8191,B+=H*(5*b),B+=ie*(5*de),B+=$*(5*ue),B+=j*(5*se),B+=C*(5*W),oe+=B>>>13,B&=8191;var F=oe;F+=D*W,F+=S*G,F+=x*w,F+=O*u,F+=q*E,oe=F>>>13,F&=8191,F+=H*T,F+=ie*(5*b),F+=$*(5*de),F+=j*(5*ue),F+=C*(5*se),oe+=F>>>13,F&=8191;var d=oe;d+=D*se,d+=S*W,d+=x*G,d+=O*w,d+=q*u,oe=d>>>13,d&=8191,d+=H*E,d+=ie*T,d+=$*(5*b),d+=j*(5*de),d+=C*(5*ue),oe+=d>>>13,d&=8191;var R=oe;R+=D*ue,R+=S*se,R+=x*W,R+=O*G,R+=q*w,oe=R>>>13,R&=8191,R+=H*u,R+=ie*E,R+=$*T,R+=j*(5*b),R+=C*(5*de),oe+=R>>>13,R&=8191;var ae=oe;ae+=D*de,ae+=S*ue,ae+=x*se,ae+=O*W,ae+=q*G,oe=ae>>>13,ae&=8191,ae+=H*w,ae+=ie*u,ae+=$*E,ae+=j*T,ae+=C*(5*b),oe+=ae>>>13,ae&=8191;var fe=oe;fe+=D*b,fe+=S*de,fe+=x*ue,fe+=O*se,fe+=q*W,oe=fe>>>13,fe&=8191,fe+=H*G,fe+=ie*w,fe+=$*u,fe+=j*E,fe+=C*T,oe+=fe>>>13,fe&=8191,oe=(oe<<2)+oe|0,oe=oe+be|0,be=oe&8191,oe=oe>>>13,le+=oe,D=be,S=le,x=_e,O=z,q=B,H=F,ie=d,$=R,j=ae,C=fe,g+=16,p-=16}this._h[0]=D,this._h[1]=S,this._h[2]=x,this._h[3]=O,this._h[4]=q,this._h[5]=H,this._h[6]=ie,this._h[7]=$,this._h[8]=j,this._h[9]=C},l.prototype.finish=function(f,g){g===void 0&&(g=0);var p=new Uint16Array(10),v,D,S,x;if(this._leftover){for(x=this._leftover,this._buffer[x++]=1;x<16;x++)this._buffer[x]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(v=this._h[1]>>>13,this._h[1]&=8191,x=2;x<10;x++)this._h[x]+=v,v=this._h[x]>>>13,this._h[x]&=8191;for(this._h[0]+=v*5,v=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=v,v=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=v,p[0]=this._h[0]+5,v=p[0]>>>13,p[0]&=8191,x=1;x<10;x++)p[x]=this._h[x]+v,v=p[x]>>>13,p[x]&=8191;for(p[9]-=8192,D=(v^1)-1,x=0;x<10;x++)p[x]&=D;for(D=~D,x=0;x<10;x++)this._h[x]=this._h[x]&D|p[x];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,S=this._h[0]+this._pad[0],this._h[0]=S&65535,x=1;x<8;x++)S=(this._h[x]+this._pad[x]|0)+(S>>>16)|0,this._h[x]=S&65535;return f[g+0]=this._h[0]>>>0,f[g+1]=this._h[0]>>>8,f[g+2]=this._h[1]>>>0,f[g+3]=this._h[1]>>>8,f[g+4]=this._h[2]>>>0,f[g+5]=this._h[2]>>>8,f[g+6]=this._h[3]>>>0,f[g+7]=this._h[3]>>>8,f[g+8]=this._h[4]>>>0,f[g+9]=this._h[4]>>>8,f[g+10]=this._h[5]>>>0,f[g+11]=this._h[5]>>>8,f[g+12]=this._h[6]>>>0,f[g+13]=this._h[6]>>>8,f[g+14]=this._h[7]>>>0,f[g+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(f){var g=0,p=f.length,v;if(this._leftover){v=16-this._leftover,v>p&&(v=p);for(var D=0;D<v;D++)this._buffer[this._leftover+D]=f[g+D];if(p-=v,g+=v,this._leftover+=v,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(v=p-p%16,this._blocks(f,g,v),g+=v,p-=v),p){for(var D=0;D<p;D++)this._buffer[this._leftover+D]=f[g+D];this._leftover+=p}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},l.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();i.Poly1305=s;function o(l,f){var g=new s(l);g.update(f);var p=g.digest();return g.clean(),p}i.oneTimeAuth=o;function c(l,f){return l.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:e.equal(l,f)}i.equal=c})(tp);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=na,t=tp,s=Cr,o=Ue,c=Mi;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var l=new Uint8Array(16),f=function(){function g(p){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,p.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return g.prototype.seal=function(p,v,D,S){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var x=new Uint8Array(16);x.set(p,x.length-p.length);var O=new Uint8Array(32);e.stream(this._key,x,O,4);var q=v.length+this.tagLength,H;if(S){if(S.length!==q)throw new Error("ChaCha20Poly1305: incorrect destination length");H=S}else H=new Uint8Array(q);return e.streamXOR(this._key,x,v,H,4),this._authenticate(H.subarray(H.length-this.tagLength,H.length),O,H.subarray(0,H.length-this.tagLength),D),s.wipe(x),H},g.prototype.open=function(p,v,D,S){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(v.length<this.tagLength)return null;var x=new Uint8Array(16);x.set(p,x.length-p.length);var O=new Uint8Array(32);e.stream(this._key,x,O,4);var q=new Uint8Array(this.tagLength);if(this._authenticate(q,O,v.subarray(0,v.length-this.tagLength),D),!c.equal(q,v.subarray(v.length-this.tagLength,v.length)))return null;var H=v.length-this.tagLength,ie;if(S){if(S.length!==H)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=S}else ie=new Uint8Array(H);return e.streamXOR(this._key,x,v.subarray(0,v.length-this.tagLength),ie,4),s.wipe(x),ie},g.prototype.clean=function(){return s.wipe(this._key),this},g.prototype._authenticate=function(p,v,D,S){var x=new t.Poly1305(v);S&&(x.update(S),S.length%16>0&&x.update(l.subarray(S.length%16))),x.update(D),D.length%16>0&&x.update(l.subarray(D.length%16));var O=new Uint8Array(8);S&&o.writeUint64LE(S.length,O),x.update(O),o.writeUint64LE(D.length,O),x.update(O);for(var q=x.digest(),H=0;H<q.length;H++)p[H]=q[H];x.clean(),s.wipe(q),s.wipe(O)},g}();i.ChaCha20Poly1305=f})(zu);var ip={},Cs={},Hu={};Object.defineProperty(Hu,"__esModule",{value:!0});function _w(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}Hu.isSerializableHash=_w;Object.defineProperty(Cs,"__esModule",{value:!0});var ri=Hu,mw=Mi,ww=Cr,np=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),ri.isSerializableHash(this._inner)&&ri.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),ww.wipe(s)}return i.prototype.reset=function(){if(!ri.isSerializableHash(this._inner)||!ri.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){ri.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ri.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!ri.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!ri.isSerializableHash(this._inner)||!ri.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!ri.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Cs.HMAC=np;function bw(i,e,t){var s=new np(i,e);s.update(t);var o=s.digest();return s.clean(),o}Cs.hmac=bw;Cs.equal=mw.equal;Object.defineProperty(ip,"__esModule",{value:!0});var uf=Cs,hf=Cr,Ew=function(){function i(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=uf.hmac(this._hash,s,t);this._hmac=new uf.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),hf.wipe(this._buffer),hf.wipe(this._counter),this._bufpos=0},i}(),Dw=ip.HKDF=Ew,qn={},sa={},oa={};Object.defineProperty(oa,"__esModule",{value:!0});oa.BrowserRandomSource=void 0;const lf=65536;class Sw{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=lf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,lf)));return t}}oa.BrowserRandomSource=Sw;function Iw(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var aa={};Object.defineProperty(aa,"__esModule",{value:!0});aa.NodeRandomSource=void 0;const xw=Cr;class Ow{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Iw<"u"){const e=zm;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,xw.wipe)(t),s}}aa.NodeRandomSource=Ow;Object.defineProperty(sa,"__esModule",{value:!0});sa.SystemRandomSource=void 0;const Pw=oa,Cw=aa;class Aw{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Pw.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Cw.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}sa.SystemRandomSource=Aw;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=sa,t=Ue,s=Cr;i.defaultRandomSource=new e.SystemRandomSource;function o(p,v=i.defaultRandomSource){return v.randomBytes(p)}i.randomBytes=o;function c(p=i.defaultRandomSource){const v=o(4,p),D=(0,t.readUint32LE)(v);return(0,s.wipe)(v),D}i.randomUint32=c;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(p,v=l,D=i.defaultRandomSource){if(v.length<2)throw new Error("randomString charset is too short");if(v.length>256)throw new Error("randomString charset is too long");let S="";const x=v.length,O=256-256%x;for(;p>0;){const q=o(Math.ceil(p*256/O),D);for(let H=0;H<q.length&&p>0;H++){const ie=q[H];ie<O&&(S+=v.charAt(ie%x),p--)}(0,s.wipe)(q)}return S}i.randomString=f;function g(p,v=l,D=i.defaultRandomSource){const S=Math.ceil(p/(Math.log(v.length)/Math.LN2));return f(S,v,D)}i.randomStringForEntropy=g})(qn);var ca={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Ue,t=Cr;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(g,p){if(p===void 0&&(p=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var v=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=g[v++],p--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(v=c(this._temp,this._state,g,v,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=g[v++],p--;return this},f.prototype.finish=function(g){if(!this._finished){var p=this._bytesHashed,v=this._bufferLength,D=p/536870912|0,S=p<<3,x=p%64<56?64:128;this._buffer[v]=128;for(var O=v+1;O<x-8;O++)this._buffer[O]=0;e.writeUint32BE(D,this._buffer,x-8),e.writeUint32BE(S,this._buffer,x-4),c(this._temp,this._state,this._buffer,0,x),this._finished=!0}for(var O=0;O<this.digestLength/4;O++)e.writeUint32BE(this._state[O],g,O*4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){t.wipe(g.state),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,g,p,v,D){for(;D>=64;){for(var S=g[0],x=g[1],O=g[2],q=g[3],H=g[4],ie=g[5],$=g[6],j=g[7],C=0;C<16;C++){var T=v+C*4;f[C]=e.readUint32BE(p,T)}for(var C=16;C<64;C++){var E=f[C-2],u=(E>>>17|E<<32-17)^(E>>>19|E<<32-19)^E>>>10;E=f[C-15];var w=(E>>>7|E<<32-7)^(E>>>18|E<<32-18)^E>>>3;f[C]=(u+f[C-7]|0)+(w+f[C-16]|0)}for(var C=0;C<64;C++){var u=(((H>>>6|H<<26)^(H>>>11|H<<21)^(H>>>25|H<<7))+(H&ie^~H&$)|0)+(j+(o[C]+f[C]|0)|0)|0,w=((S>>>2|S<<32-2)^(S>>>13|S<<32-13)^(S>>>22|S<<32-22))+(S&x^S&O^x&O)|0;j=$,$=ie,ie=H,H=q+u|0,q=O,O=x,x=S,S=u+w|0}g[0]+=S,g[1]+=x,g[2]+=O,g[3]+=q,g[4]+=H,g[5]+=ie,g[6]+=$,g[7]+=j,v+=64,D-=64}return v}function l(f){var g=new s;g.update(f);var p=g.digest();return g.clean(),p}i.hash=l})(ca);var Ku={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=qn,t=Cr;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(C){const T=new Float64Array(16);if(C)for(let E=0;E<C.length;E++)T[E]=C[E];return T}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function l(C){let T=1;for(let E=0;E<16;E++){let u=C[E]+T+65535;T=Math.floor(u/65536),C[E]=u-T*65536}C[0]+=T-1+37*(T-1)}function f(C,T,E){const u=~(E-1);for(let w=0;w<16;w++){const G=u&(C[w]^T[w]);C[w]^=G,T[w]^=G}}function g(C,T){const E=s(),u=s();for(let w=0;w<16;w++)u[w]=T[w];l(u),l(u),l(u);for(let w=0;w<2;w++){E[0]=u[0]-65517;for(let W=1;W<15;W++)E[W]=u[W]-65535-(E[W-1]>>16&1),E[W-1]&=65535;E[15]=u[15]-32767-(E[14]>>16&1);const G=E[15]>>16&1;E[14]&=65535,f(u,E,1-G)}for(let w=0;w<16;w++)C[2*w]=u[w]&255,C[2*w+1]=u[w]>>8}function p(C,T){for(let E=0;E<16;E++)C[E]=T[2*E]+(T[2*E+1]<<8);C[15]&=32767}function v(C,T,E){for(let u=0;u<16;u++)C[u]=T[u]+E[u]}function D(C,T,E){for(let u=0;u<16;u++)C[u]=T[u]-E[u]}function S(C,T,E){let u,w,G=0,W=0,se=0,ue=0,de=0,b=0,A=0,ee=0,Q=0,k=0,V=0,J=0,re=0,we=0,oe=0,be=0,le=0,_e=0,z=0,B=0,F=0,d=0,R=0,ae=0,fe=0,Ie=0,ze=0,ke=0,Le=0,pt=0,gt=0,Me=E[0],xe=E[1],Ne=E[2],$e=E[3],qe=E[4],Pe=E[5],Fe=E[6],Se=E[7],Ce=E[8],He=E[9],Oe=E[10],Ve=E[11],We=E[12],et=E[13],tt=E[14],Qe=E[15];u=T[0],G+=u*Me,W+=u*xe,se+=u*Ne,ue+=u*$e,de+=u*qe,b+=u*Pe,A+=u*Fe,ee+=u*Se,Q+=u*Ce,k+=u*He,V+=u*Oe,J+=u*Ve,re+=u*We,we+=u*et,oe+=u*tt,be+=u*Qe,u=T[1],W+=u*Me,se+=u*xe,ue+=u*Ne,de+=u*$e,b+=u*qe,A+=u*Pe,ee+=u*Fe,Q+=u*Se,k+=u*Ce,V+=u*He,J+=u*Oe,re+=u*Ve,we+=u*We,oe+=u*et,be+=u*tt,le+=u*Qe,u=T[2],se+=u*Me,ue+=u*xe,de+=u*Ne,b+=u*$e,A+=u*qe,ee+=u*Pe,Q+=u*Fe,k+=u*Se,V+=u*Ce,J+=u*He,re+=u*Oe,we+=u*Ve,oe+=u*We,be+=u*et,le+=u*tt,_e+=u*Qe,u=T[3],ue+=u*Me,de+=u*xe,b+=u*Ne,A+=u*$e,ee+=u*qe,Q+=u*Pe,k+=u*Fe,V+=u*Se,J+=u*Ce,re+=u*He,we+=u*Oe,oe+=u*Ve,be+=u*We,le+=u*et,_e+=u*tt,z+=u*Qe,u=T[4],de+=u*Me,b+=u*xe,A+=u*Ne,ee+=u*$e,Q+=u*qe,k+=u*Pe,V+=u*Fe,J+=u*Se,re+=u*Ce,we+=u*He,oe+=u*Oe,be+=u*Ve,le+=u*We,_e+=u*et,z+=u*tt,B+=u*Qe,u=T[5],b+=u*Me,A+=u*xe,ee+=u*Ne,Q+=u*$e,k+=u*qe,V+=u*Pe,J+=u*Fe,re+=u*Se,we+=u*Ce,oe+=u*He,be+=u*Oe,le+=u*Ve,_e+=u*We,z+=u*et,B+=u*tt,F+=u*Qe,u=T[6],A+=u*Me,ee+=u*xe,Q+=u*Ne,k+=u*$e,V+=u*qe,J+=u*Pe,re+=u*Fe,we+=u*Se,oe+=u*Ce,be+=u*He,le+=u*Oe,_e+=u*Ve,z+=u*We,B+=u*et,F+=u*tt,d+=u*Qe,u=T[7],ee+=u*Me,Q+=u*xe,k+=u*Ne,V+=u*$e,J+=u*qe,re+=u*Pe,we+=u*Fe,oe+=u*Se,be+=u*Ce,le+=u*He,_e+=u*Oe,z+=u*Ve,B+=u*We,F+=u*et,d+=u*tt,R+=u*Qe,u=T[8],Q+=u*Me,k+=u*xe,V+=u*Ne,J+=u*$e,re+=u*qe,we+=u*Pe,oe+=u*Fe,be+=u*Se,le+=u*Ce,_e+=u*He,z+=u*Oe,B+=u*Ve,F+=u*We,d+=u*et,R+=u*tt,ae+=u*Qe,u=T[9],k+=u*Me,V+=u*xe,J+=u*Ne,re+=u*$e,we+=u*qe,oe+=u*Pe,be+=u*Fe,le+=u*Se,_e+=u*Ce,z+=u*He,B+=u*Oe,F+=u*Ve,d+=u*We,R+=u*et,ae+=u*tt,fe+=u*Qe,u=T[10],V+=u*Me,J+=u*xe,re+=u*Ne,we+=u*$e,oe+=u*qe,be+=u*Pe,le+=u*Fe,_e+=u*Se,z+=u*Ce,B+=u*He,F+=u*Oe,d+=u*Ve,R+=u*We,ae+=u*et,fe+=u*tt,Ie+=u*Qe,u=T[11],J+=u*Me,re+=u*xe,we+=u*Ne,oe+=u*$e,be+=u*qe,le+=u*Pe,_e+=u*Fe,z+=u*Se,B+=u*Ce,F+=u*He,d+=u*Oe,R+=u*Ve,ae+=u*We,fe+=u*et,Ie+=u*tt,ze+=u*Qe,u=T[12],re+=u*Me,we+=u*xe,oe+=u*Ne,be+=u*$e,le+=u*qe,_e+=u*Pe,z+=u*Fe,B+=u*Se,F+=u*Ce,d+=u*He,R+=u*Oe,ae+=u*Ve,fe+=u*We,Ie+=u*et,ze+=u*tt,ke+=u*Qe,u=T[13],we+=u*Me,oe+=u*xe,be+=u*Ne,le+=u*$e,_e+=u*qe,z+=u*Pe,B+=u*Fe,F+=u*Se,d+=u*Ce,R+=u*He,ae+=u*Oe,fe+=u*Ve,Ie+=u*We,ze+=u*et,ke+=u*tt,Le+=u*Qe,u=T[14],oe+=u*Me,be+=u*xe,le+=u*Ne,_e+=u*$e,z+=u*qe,B+=u*Pe,F+=u*Fe,d+=u*Se,R+=u*Ce,ae+=u*He,fe+=u*Oe,Ie+=u*Ve,ze+=u*We,ke+=u*et,Le+=u*tt,pt+=u*Qe,u=T[15],be+=u*Me,le+=u*xe,_e+=u*Ne,z+=u*$e,B+=u*qe,F+=u*Pe,d+=u*Fe,R+=u*Se,ae+=u*Ce,fe+=u*He,Ie+=u*Oe,ze+=u*Ve,ke+=u*We,Le+=u*et,pt+=u*tt,gt+=u*Qe,G+=38*le,W+=38*_e,se+=38*z,ue+=38*B,de+=38*F,b+=38*d,A+=38*R,ee+=38*ae,Q+=38*fe,k+=38*Ie,V+=38*ze,J+=38*ke,re+=38*Le,we+=38*pt,oe+=38*gt,w=1,u=G+w+65535,w=Math.floor(u/65536),G=u-w*65536,u=W+w+65535,w=Math.floor(u/65536),W=u-w*65536,u=se+w+65535,w=Math.floor(u/65536),se=u-w*65536,u=ue+w+65535,w=Math.floor(u/65536),ue=u-w*65536,u=de+w+65535,w=Math.floor(u/65536),de=u-w*65536,u=b+w+65535,w=Math.floor(u/65536),b=u-w*65536,u=A+w+65535,w=Math.floor(u/65536),A=u-w*65536,u=ee+w+65535,w=Math.floor(u/65536),ee=u-w*65536,u=Q+w+65535,w=Math.floor(u/65536),Q=u-w*65536,u=k+w+65535,w=Math.floor(u/65536),k=u-w*65536,u=V+w+65535,w=Math.floor(u/65536),V=u-w*65536,u=J+w+65535,w=Math.floor(u/65536),J=u-w*65536,u=re+w+65535,w=Math.floor(u/65536),re=u-w*65536,u=we+w+65535,w=Math.floor(u/65536),we=u-w*65536,u=oe+w+65535,w=Math.floor(u/65536),oe=u-w*65536,u=be+w+65535,w=Math.floor(u/65536),be=u-w*65536,G+=w-1+37*(w-1),w=1,u=G+w+65535,w=Math.floor(u/65536),G=u-w*65536,u=W+w+65535,w=Math.floor(u/65536),W=u-w*65536,u=se+w+65535,w=Math.floor(u/65536),se=u-w*65536,u=ue+w+65535,w=Math.floor(u/65536),ue=u-w*65536,u=de+w+65535,w=Math.floor(u/65536),de=u-w*65536,u=b+w+65535,w=Math.floor(u/65536),b=u-w*65536,u=A+w+65535,w=Math.floor(u/65536),A=u-w*65536,u=ee+w+65535,w=Math.floor(u/65536),ee=u-w*65536,u=Q+w+65535,w=Math.floor(u/65536),Q=u-w*65536,u=k+w+65535,w=Math.floor(u/65536),k=u-w*65536,u=V+w+65535,w=Math.floor(u/65536),V=u-w*65536,u=J+w+65535,w=Math.floor(u/65536),J=u-w*65536,u=re+w+65535,w=Math.floor(u/65536),re=u-w*65536,u=we+w+65535,w=Math.floor(u/65536),we=u-w*65536,u=oe+w+65535,w=Math.floor(u/65536),oe=u-w*65536,u=be+w+65535,w=Math.floor(u/65536),be=u-w*65536,G+=w-1+37*(w-1),C[0]=G,C[1]=W,C[2]=se,C[3]=ue,C[4]=de,C[5]=b,C[6]=A,C[7]=ee,C[8]=Q,C[9]=k,C[10]=V,C[11]=J,C[12]=re,C[13]=we,C[14]=oe,C[15]=be}function x(C,T){S(C,T,T)}function O(C,T){const E=s();for(let u=0;u<16;u++)E[u]=T[u];for(let u=253;u>=0;u--)x(E,E),u!==2&&u!==4&&S(E,E,T);for(let u=0;u<16;u++)C[u]=E[u]}function q(C,T){const E=new Uint8Array(32),u=new Float64Array(80),w=s(),G=s(),W=s(),se=s(),ue=s(),de=s();for(let Q=0;Q<31;Q++)E[Q]=C[Q];E[31]=C[31]&127|64,E[0]&=248,p(u,T);for(let Q=0;Q<16;Q++)G[Q]=u[Q];w[0]=se[0]=1;for(let Q=254;Q>=0;--Q){const k=E[Q>>>3]>>>(Q&7)&1;f(w,G,k),f(W,se,k),v(ue,w,W),D(w,w,W),v(W,G,se),D(G,G,se),x(se,ue),x(de,w),S(w,W,w),S(W,G,ue),v(ue,w,W),D(w,w,W),x(G,w),D(W,se,de),S(w,W,c),v(w,w,se),S(W,W,w),S(w,se,de),S(se,G,u),x(G,ue),f(w,G,k),f(W,se,k)}for(let Q=0;Q<16;Q++)u[Q+16]=w[Q],u[Q+32]=W[Q],u[Q+48]=G[Q],u[Q+64]=se[Q];const b=u.subarray(32),A=u.subarray(16);O(b,b),S(A,A,b);const ee=new Uint8Array(32);return g(ee,A),ee}i.scalarMult=q;function H(C){return q(C,o)}i.scalarMultBase=H;function ie(C){if(C.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const T=new Uint8Array(C);return{publicKey:H(T),secretKey:T}}i.generateKeyPairFromSeed=ie;function $(C){const T=(0,e.randomBytes)(32,C),E=ie(T);return(0,t.wipe)(T),E}i.generateKeyPair=$;function j(C,T,E=!1){if(C.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(T.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=q(C,T);if(E){let w=0;for(let G=0;G<u.length;G++)w|=u[G];if(w===0)throw new Error("X25519: invalid shared key")}return u}i.sharedKey=j})(Ku);function ku(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function sp(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ku(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function gu(i,e){e||(e=i.reduce((o,c)=>o+c.length,0));const t=sp(e);let s=0;for(const o of i)t.set(o,s),s+=o.length;return ku(t)}function Tw(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var f=i.length,g=i.charAt(0),p=Math.log(f)/Math.log(256),v=Math.log(256)/Math.log(f);function D(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var q=0,H=0,ie=0,$=O.length;ie!==$&&O[ie]===0;)ie++,q++;for(var j=($-ie)*v+1>>>0,C=new Uint8Array(j);ie!==$;){for(var T=O[ie],E=0,u=j-1;(T!==0||E<H)&&u!==-1;u--,E++)T+=256*C[u]>>>0,C[u]=T%f>>>0,T=T/f>>>0;if(T!==0)throw new Error("Non-zero carry");H=E,ie++}for(var w=j-H;w!==j&&C[w]===0;)w++;for(var G=g.repeat(q);w<j;++w)G+=i.charAt(C[w]);return G}function S(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var q=0;if(O[q]!==" "){for(var H=0,ie=0;O[q]===g;)H++,q++;for(var $=(O.length-q)*p+1>>>0,j=new Uint8Array($);O[q];){var C=t[O.charCodeAt(q)];if(C===255)return;for(var T=0,E=$-1;(C!==0||T<ie)&&E!==-1;E--,T++)C+=f*j[E]>>>0,j[E]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");ie=T,q++}if(O[q]!==" "){for(var u=$-ie;u!==$&&j[u]===0;)u++;for(var w=new Uint8Array(H+($-u)),G=H;u!==$;)w[G++]=j[u++];return w}}}function x(O){var q=S(O);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:S,decode:x}}var Rw=Tw,Nw=Rw;const $w=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},Fw=i=>new TextEncoder().encode(i),Uw=i=>new TextDecoder().decode(i);class Lw{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class jw{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return op(this,e)}}class Mw{constructor(e){this.decoders=e}or(e){return op(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const op=(i,e)=>new Mw({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class qw{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new Lw(e,t,s),this.decoder=new jw(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ua=({name:i,prefix:e,encode:t,decode:s})=>new qw(i,e,t,s),As=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=Nw(t,e);return ua({prefix:i,name:e,encode:s,decode:c=>$w(o(c))})},Bw=(i,e,t,s)=>{const o={};for(let v=0;v<e.length;++v)o[e[v]]=v;let c=i.length;for(;i[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let f=0,g=0,p=0;for(let v=0;v<c;++v){const D=o[i[v]];if(D===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<t|D,f+=t,f>=8&&(f-=8,l[p++]=255&g>>f)}if(f>=t||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return l},zw=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,f=0;for(let g=0;g<i.length;++g)for(f=f<<8|i[g],l+=8;l>t;)l-=t,c+=e[o&f>>l];if(l&&(c+=e[o&f<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Yt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>ua({prefix:e,name:i,encode(o){return zw(o,s,t)},decode(o){return Bw(o,s,t,i)}}),Hw=ua({prefix:"\0",name:"identity",encode:i=>Uw(i),decode:i=>Fw(i)}),Kw=Object.freeze(Object.defineProperty({__proto__:null,identity:Hw},Symbol.toStringTag,{value:"Module"})),kw=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Vw=Object.freeze(Object.defineProperty({__proto__:null,base2:kw},Symbol.toStringTag,{value:"Module"})),Gw=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Ww=Object.freeze(Object.defineProperty({__proto__:null,base8:Gw},Symbol.toStringTag,{value:"Module"})),Yw=As({prefix:"9",name:"base10",alphabet:"0123456789"}),Jw=Object.freeze(Object.defineProperty({__proto__:null,base10:Yw},Symbol.toStringTag,{value:"Module"})),Qw=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Xw=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Zw=Object.freeze(Object.defineProperty({__proto__:null,base16:Qw,base16upper:Xw},Symbol.toStringTag,{value:"Module"})),eb=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),tb=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),rb=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ib=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),nb=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),sb=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ob=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ab=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),cb=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ub=Object.freeze(Object.defineProperty({__proto__:null,base32:eb,base32hex:nb,base32hexpad:ob,base32hexpadupper:ab,base32hexupper:sb,base32pad:rb,base32padupper:ib,base32upper:tb,base32z:cb},Symbol.toStringTag,{value:"Module"})),hb=As({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),lb=As({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),fb=Object.freeze(Object.defineProperty({__proto__:null,base36:hb,base36upper:lb},Symbol.toStringTag,{value:"Module"})),db=As({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),pb=As({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),gb=Object.freeze(Object.defineProperty({__proto__:null,base58btc:db,base58flickr:pb},Symbol.toStringTag,{value:"Module"})),yb=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),vb=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),_b=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),mb=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),wb=Object.freeze(Object.defineProperty({__proto__:null,base64:yb,base64pad:vb,base64url:_b,base64urlpad:mb},Symbol.toStringTag,{value:"Module"})),ap=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),bb=ap.reduce((i,e,t)=>(i[t]=e,i),[]),Eb=ap.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function Db(i){return i.reduce((e,t)=>(e+=bb[t],e),"")}function Sb(i){const e=[];for(const t of i){const s=Eb[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const Ib=ua({prefix:"ðŸš€",name:"base256emoji",encode:Db,decode:Sb}),xb=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Ib},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const ff={...Kw,...Vw,...Ww,...Jw,...Zw,...ub,...fb,...gb,...wb,...xb};function cp(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const df=cp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Bc=cp("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=sp(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),up={utf8:df,"utf-8":df,hex:ff.base16,latin1:Bc,ascii:Bc,binary:Bc,...ff};function wr(i,e="utf8"){const t=up[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ku(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}function lr(i,e="utf8"){const t=up[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):t.encoder.encode(i).substring(1)}var pf=globalThis&&globalThis.__spreadArray||function(i,e,t){if(t||arguments.length===2)for(var s=0,o=e.length,c;s<o;s++)(c||!(s in e))&&(c||(c=Array.prototype.slice.call(e,0,s)),c[s]=e[s]);return i.concat(c||Array.prototype.slice.call(e))},Ob=function(){function i(e,t,s){this.name=e,this.version=t,this.os=s,this.type="browser"}return i}(),Pb=function(){function i(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return i}(),Cb=function(){function i(e,t,s,o){this.name=e,this.version=t,this.os=s,this.bot=o,this.type="bot-device"}return i}(),Ab=function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i}(),Tb=function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i}(),Rb=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Nb=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,gf=3,$b=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Rb]],yf=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Fb(i){return i?vf(i):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Tb:typeof navigator<"u"?vf(navigator.userAgent):jb()}function Ub(i){return i!==""&&$b.reduce(function(e,t){var s=t[0],o=t[1];if(e)return e;var c=o.exec(i);return!!c&&[s,c]},!1)}function vf(i){var e=Ub(i);if(!e)return null;var t=e[0],s=e[1];if(t==="searchbot")return new Ab;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<gf&&(o=pf(pf([],o,!0),Mb(gf-o.length),!0)):o=[];var c=o.join("."),l=Lb(i),f=Nb.exec(i);return f&&f[1]?new Cb(t,c,l,f[1]):new Ob(t,c,l)}function Lb(i){for(var e=0,t=yf.length;e<t;e++){var s=yf[e],o=s[0],c=s[1],l=c.exec(i);if(l)return o}return null}function jb(){var i=typeof process<"u"&&process.version;return i?new Pb(process.version.slice(1)):null}function Mb(i){for(var e=[],t=0;t<i;t++)e.push("0");return e}var ve={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yu=function(i,e){return yu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},yu(i,e)};function qb(i,e){yu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var vu=function(){return vu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},vu.apply(this,arguments)};function Bb(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function zb(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Hb(i,e){return function(t,s){e(t,s,i)}}function Kb(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function kb(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(D){l(D)}}function g(v){try{p(s.throw(v))}catch(D){l(D)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function Vb(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Gb(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function Wb(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function _u(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function hp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-->0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function Yb(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(hp(arguments[e]));return i}function Jb(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Es(i){return this instanceof Es?(this.v=i,this):new Es(i)}function Qb(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(x){return new Promise(function(O,q){c.push([S,x,O,q])>1||f(S,x)})})}function f(S,x){try{g(s[S](x))}catch(O){D(c[0][3],O)}}function g(S){S.value instanceof Es?Promise.resolve(S.value.v).then(p,v):D(c[0][2],S)}function p(S){f("next",S)}function v(S){f("throw",S)}function D(S,x){S(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Xb(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Es(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function Zb(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof _u=="function"?_u(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function eE(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function tE(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function rE(i){return i&&i.__esModule?i:{default:i}}function iE(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function nE(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const sE=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return vu},__asyncDelegator:Xb,__asyncGenerator:Qb,__asyncValues:Zb,__await:Es,__awaiter:kb,__classPrivateFieldGet:iE,__classPrivateFieldSet:nE,__createBinding:Gb,__decorate:zb,__exportStar:Wb,__extends:qb,__generator:Vb,__importDefault:rE,__importStar:tE,__makeTemplateObject:eE,__metadata:Kb,__param:Hb,__read:hp,__rest:Bb,__spread:Yb,__spreadArrays:Jb,__values:_u},Symbol.toStringTag,{value:"Module"})),ha=Mn(sE);var zc={},ls={},_f;function oE(){if(_f)return ls;_f=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return ls.delay=i,ls}var tn={},Hc={},rn={},mf;function aE(){return mf||(mf=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.ONE_THOUSAND=rn.ONE_HUNDRED=void 0,rn.ONE_HUNDRED=100,rn.ONE_THOUSAND=1e3),rn}var Kc={},wf;function cE(){return wf||(wf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(Kc)),Kc}var bf;function lp(){return bf||(bf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ha;e.__exportStar(aE(),i),e.__exportStar(cE(),i)}(Hc)),Hc}var Ef;function uE(){if(Ef)return tn;Ef=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.fromMiliseconds=tn.toMiliseconds=void 0;const i=lp();function e(s){return s*i.ONE_THOUSAND}tn.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return tn.fromMiliseconds=t,tn}var Df;function hE(){return Df||(Df=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ha;e.__exportStar(oE(),i),e.__exportStar(uE(),i)}(zc)),zc}var Nn={},Sf;function lE(){if(Sf)return Nn;Sf=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Nn.Watch=i,Nn.default=i,Nn}var kc={},fs={},If;function fE(){if(If)return fs;If=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.IWatch=void 0;class i{}return fs.IWatch=i,fs}var xf;function dE(){return xf||(xf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ha.__exportStar(fE(),i)}(kc)),kc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ha;e.__exportStar(hE(),i),e.__exportStar(lE(),i),e.__exportStar(dE(),i),e.__exportStar(lp(),i)})(ve);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=fp=lt.getLocation=lt.getLocationOrThrow=Gu=lt.getNavigator=lt.getNavigatorOrThrow=Vu=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function cn(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}lt.getFromWindow=cn;function Bn(i){const e=cn(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}lt.getFromWindowOrThrow=Bn;function pE(){return Bn("document")}lt.getDocumentOrThrow=pE;function gE(){return cn("document")}var Vu=lt.getDocument=gE;function yE(){return Bn("navigator")}lt.getNavigatorOrThrow=yE;function vE(){return cn("navigator")}var Gu=lt.getNavigator=vE;function _E(){return Bn("location")}lt.getLocationOrThrow=_E;function mE(){return cn("location")}var fp=lt.getLocation=mE;function wE(){return Bn("crypto")}lt.getCryptoOrThrow=wE;function bE(){return cn("crypto")}lt.getCrypto=bE;function EE(){return Bn("localStorage")}lt.getLocalStorageOrThrow=EE;function DE(){return cn("localStorage")}lt.getLocalStorage=DE;var Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});var dp=Wu.getWindowMetadata=void 0;const Of=lt;function SE(){let i,e;try{i=Of.getDocumentOrThrow(),e=Of.getLocationOrThrow()}catch{return null}function t(){const D=i.getElementsByTagName("link"),S=[];for(let x=0;x<D.length;x++){const O=D[x],q=O.getAttribute("rel");if(q&&q.toLowerCase().indexOf("icon")>-1){const H=O.getAttribute("href");if(H)if(H.toLowerCase().indexOf("https:")===-1&&H.toLowerCase().indexOf("http:")===-1&&H.indexOf("//")!==0){let ie=e.protocol+"//"+e.host;if(H.indexOf("/")===0)ie+=H;else{const $=e.pathname.split("/");$.pop();const j=$.join("/");ie+=j+"/"+H}S.push(ie)}else if(H.indexOf("//")===0){const ie=e.protocol+H;S.push(ie)}else S.push(H)}}return S}function s(...D){const S=i.getElementsByTagName("meta");for(let x=0;x<S.length;x++){const O=S[x],q=["itemprop","property","name"].map(H=>O.getAttribute(H)).filter(H=>H?D.includes(H):!1);if(q.length&&q){const H=O.getAttribute("content");if(H)return H}}return""}function o(){let D=s("name","og:site_name","og:title","twitter:title");return D||(D=i.title),D}function c(){return s("description","og:description","twitter:description","keywords")}const l=o(),f=c(),g=e.origin,p=t();return{description:f,url:g,icons:p,name:l}}dp=Wu.getWindowMetadata=SE;var Ds={},IE=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),pp="%[a-f0-9]{2}",Pf=new RegExp("("+pp+")|([^%]+?)","gi"),Cf=new RegExp("("+pp+")+","gi");function mu(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var t=i.slice(0,e),s=i.slice(e);return Array.prototype.concat.call([],mu(t),mu(s))}function xE(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(Pf)||[],t=1;t<e.length;t++)i=mu(e,t).join(""),e=i.match(Pf)||[];return i}}function OE(i){for(var e={"%FE%FF":"ï¿½ï¿½","%FF%FE":"ï¿½ï¿½"},t=Cf.exec(i);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=xE(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Cf.exec(i)}e["%C2"]="ï¿½";for(var o=Object.keys(e),c=0;c<o.length;c++){var l=o[c];i=i.replace(new RegExp(l,"g"),e[l])}return i}var PE=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return OE(i)}},CE=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];const t=i.indexOf(e);return t===-1?[i]:[i.slice(0,t),i.slice(t+e.length)]},AE=function(i,e){for(var t={},s=Object.keys(i),o=Array.isArray(e),c=0;c<s.length;c++){var l=s[c],f=i[l];(o?e.indexOf(l)!==-1:e(l,f,i))&&(t[l]=f)}return t};(function(i){const e=IE,t=PE,s=CE,o=AE,c=$=>$==null,l=Symbol("encodeFragmentIdentifier");function f($){switch($.arrayFormat){case"index":return j=>(C,T)=>{const E=C.length;return T===void 0||$.skipNull&&T===null||$.skipEmptyString&&T===""?C:T===null?[...C,[v(j,$),"[",E,"]"].join("")]:[...C,[v(j,$),"[",v(E,$),"]=",v(T,$)].join("")]};case"bracket":return j=>(C,T)=>T===void 0||$.skipNull&&T===null||$.skipEmptyString&&T===""?C:T===null?[...C,[v(j,$),"[]"].join("")]:[...C,[v(j,$),"[]=",v(T,$)].join("")];case"colon-list-separator":return j=>(C,T)=>T===void 0||$.skipNull&&T===null||$.skipEmptyString&&T===""?C:T===null?[...C,[v(j,$),":list="].join("")]:[...C,[v(j,$),":list=",v(T,$)].join("")];case"comma":case"separator":case"bracket-separator":{const j=$.arrayFormat==="bracket-separator"?"[]=":"=";return C=>(T,E)=>E===void 0||$.skipNull&&E===null||$.skipEmptyString&&E===""?T:(E=E===null?"":E,T.length===0?[[v(C,$),j,v(E,$)].join("")]:[[T,v(E,$)].join($.arrayFormatSeparator)])}default:return j=>(C,T)=>T===void 0||$.skipNull&&T===null||$.skipEmptyString&&T===""?C:T===null?[...C,v(j,$)]:[...C,[v(j,$),"=",v(T,$)].join("")]}}function g($){let j;switch($.arrayFormat){case"index":return(C,T,E)=>{if(j=/\[(\d*)\]$/.exec(C),C=C.replace(/\[\d*\]$/,""),!j){E[C]=T;return}E[C]===void 0&&(E[C]={}),E[C][j[1]]=T};case"bracket":return(C,T,E)=>{if(j=/(\[\])$/.exec(C),C=C.replace(/\[\]$/,""),!j){E[C]=T;return}if(E[C]===void 0){E[C]=[T];return}E[C]=[].concat(E[C],T)};case"colon-list-separator":return(C,T,E)=>{if(j=/(:list)$/.exec(C),C=C.replace(/:list$/,""),!j){E[C]=T;return}if(E[C]===void 0){E[C]=[T];return}E[C]=[].concat(E[C],T)};case"comma":case"separator":return(C,T,E)=>{const u=typeof T=="string"&&T.includes($.arrayFormatSeparator),w=typeof T=="string"&&!u&&D(T,$).includes($.arrayFormatSeparator);T=w?D(T,$):T;const G=u||w?T.split($.arrayFormatSeparator).map(W=>D(W,$)):T===null?T:D(T,$);E[C]=G};case"bracket-separator":return(C,T,E)=>{const u=/(\[\])$/.test(C);if(C=C.replace(/\[\]$/,""),!u){E[C]=T&&D(T,$);return}const w=T===null?[]:T.split($.arrayFormatSeparator).map(G=>D(G,$));if(E[C]===void 0){E[C]=w;return}E[C]=[].concat(E[C],w)};default:return(C,T,E)=>{if(E[C]===void 0){E[C]=T;return}E[C]=[].concat(E[C],T)}}}function p($){if(typeof $!="string"||$.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function v($,j){return j.encode?j.strict?e($):encodeURIComponent($):$}function D($,j){return j.decode?t($):$}function S($){return Array.isArray($)?$.sort():typeof $=="object"?S(Object.keys($)).sort((j,C)=>Number(j)-Number(C)).map(j=>$[j]):$}function x($){const j=$.indexOf("#");return j!==-1&&($=$.slice(0,j)),$}function O($){let j="";const C=$.indexOf("#");return C!==-1&&(j=$.slice(C)),j}function q($){$=x($);const j=$.indexOf("?");return j===-1?"":$.slice(j+1)}function H($,j){return j.parseNumbers&&!Number.isNaN(Number($))&&typeof $=="string"&&$.trim()!==""?$=Number($):j.parseBooleans&&$!==null&&($.toLowerCase()==="true"||$.toLowerCase()==="false")&&($=$.toLowerCase()==="true"),$}function ie($,j){j=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},j),p(j.arrayFormatSeparator);const C=g(j),T=Object.create(null);if(typeof $!="string"||($=$.trim().replace(/^[?#&]/,""),!$))return T;for(const E of $.split("&")){if(E==="")continue;let[u,w]=s(j.decode?E.replace(/\+/g," "):E,"=");w=w===void 0?null:["comma","separator","bracket-separator"].includes(j.arrayFormat)?w:D(w,j),C(D(u,j),w,T)}for(const E of Object.keys(T)){const u=T[E];if(typeof u=="object"&&u!==null)for(const w of Object.keys(u))u[w]=H(u[w],j);else T[E]=H(u,j)}return j.sort===!1?T:(j.sort===!0?Object.keys(T).sort():Object.keys(T).sort(j.sort)).reduce((E,u)=>{const w=T[u];return w&&typeof w=="object"&&!Array.isArray(w)?E[u]=S(w):E[u]=w,E},Object.create(null))}i.extract=q,i.parse=ie,i.stringify=($,j)=>{if(!$)return"";j=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},j),p(j.arrayFormatSeparator);const C=w=>j.skipNull&&c($[w])||j.skipEmptyString&&$[w]==="",T=f(j),E={};for(const w of Object.keys($))C(w)||(E[w]=$[w]);const u=Object.keys(E);return j.sort!==!1&&u.sort(j.sort),u.map(w=>{const G=$[w];return G===void 0?"":G===null?v(w,j):Array.isArray(G)?G.length===0&&j.arrayFormat==="bracket-separator"?v(w,j)+"[]":G.reduce(T(w),[]).join("&"):v(w,j)+"="+v(G,j)}).filter(w=>w.length>0).join("&")},i.parseUrl=($,j)=>{j=Object.assign({decode:!0},j);const[C,T]=s($,"#");return Object.assign({url:C.split("?")[0]||"",query:ie(q($),j)},j&&j.parseFragmentIdentifier&&T?{fragmentIdentifier:D(T,j)}:{})},i.stringifyUrl=($,j)=>{j=Object.assign({encode:!0,strict:!0,[l]:!0},j);const C=x($.url).split("?")[0]||"",T=i.extract($.url),E=i.parse(T,{sort:!1}),u=Object.assign(E,$.query);let w=i.stringify(u,j);w&&(w=`?${w}`);let G=O($.url);return $.fragmentIdentifier&&(G=`#${j[l]?v($.fragmentIdentifier,j):$.fragmentIdentifier}`),`${C}${w}${G}`},i.pick=($,j,C)=>{C=Object.assign({parseFragmentIdentifier:!0,[l]:!1},C);const{url:T,query:E,fragmentIdentifier:u}=i.parseUrl($,C);return i.stringifyUrl({url:T,query:o(E,j),fragmentIdentifier:u},C)},i.exclude=($,j,C)=>{const T=Array.isArray(j)?E=>!j.includes(E):(E,u)=>!j(E,u);return i.pick($,T,C)}})(Ds);const TE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},RE=":";function NE(i){const[e,t]=i.split(RE);return{namespace:e,reference:t}}function $E(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const o=i[s];t.push(...o.accounts)}),t}function gp(i,e){return i.includes(":")?[i]:e.chains||[]}const yp="base10",hr="base16",wu="base64pad",Yu="utf8",vp=0,un=1,FE=0,Af=1,bu=12,Ju=32;function UE(){const i=Ku.generateKeyPair();return{privateKey:lr(i.secretKey,hr),publicKey:lr(i.publicKey,hr)}}function Eu(){const i=qn.randomBytes(Ju);return lr(i,hr)}function LE(i,e){const t=Ku.sharedKey(wr(i,hr),wr(e,hr),!0),s=new Dw(ca.SHA256,t).expand(Ju);return lr(s,hr)}function jE(i){const e=ca.hash(wr(i,hr));return lr(e,hr)}function Ln(i){const e=ca.hash(wr(i,Yu));return lr(e,hr)}function ME(i){return wr(`${i}`,yp)}function Ts(i){return Number(lr(i,yp))}function qE(i){const e=ME(typeof i.type<"u"?i.type:vp);if(Ts(e)===un&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?wr(i.senderPublicKey,hr):void 0,s=typeof i.iv<"u"?wr(i.iv,hr):qn.randomBytes(bu),o=new zu.ChaCha20Poly1305(wr(i.symKey,hr)).seal(s,wr(i.message,Yu));return zE({type:e,sealed:o,iv:s,senderPublicKey:t})}function BE(i){const e=new zu.ChaCha20Poly1305(wr(i.symKey,hr)),{sealed:t,iv:s}=Xo(i.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return lr(o,Yu)}function zE(i){if(Ts(i.type)===un){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return lr(gu([i.type,i.senderPublicKey,i.iv,i.sealed]),wu)}return lr(gu([i.type,i.iv,i.sealed]),wu)}function Xo(i){const e=wr(i,wu),t=e.slice(FE,Af),s=Af;if(Ts(t)===un){const f=s+Ju,g=f+bu,p=e.slice(s,f),v=e.slice(f,g),D=e.slice(g);return{type:t,sealed:D,iv:v,senderPublicKey:p}}const o=s+bu,c=e.slice(s,o),l=e.slice(o);return{type:t,sealed:l,iv:c}}function HE(i,e){const t=Xo(i);return _p({type:Ts(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?lr(t.senderPublicKey,hr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function _p(i){const e=(i==null?void 0:i.type)||vp;if(e===un){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function Tf(i){return i.type===un&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var KE=Object.defineProperty,Rf=Object.getOwnPropertySymbols,kE=Object.prototype.hasOwnProperty,VE=Object.prototype.propertyIsEnumerable,Nf=(i,e,t)=>e in i?KE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,$f=(i,e)=>{for(var t in e||(e={}))kE.call(e,t)&&Nf(i,t,e[t]);if(Rf)for(var t of Rf(e))VE.call(e,t)&&Nf(i,t,e[t]);return i};const GE="ReactNative",Pr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},WE="js";function Qu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function zn(){return!Vu()&&!!Gu()&&navigator.product===GE}function Hn(){return!Qu()&&!!Gu()&&!!Vu()}function Rs(){return zn()?Pr.reactNative:Qu()?Pr.node:Hn()?Pr.browser:Pr.unknown}function YE(){var i;try{return zn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(i=global.Application)==null?void 0:i.applicationId:void 0}catch{return}}function JE(i,e){let t=Ds.parse(i);return t=$f($f({},t),e),i=Ds.stringify(t),i}function QE(){return dp()||{name:"",description:"",url:"",icons:[""]}}function XE(){if(Rs()===Pr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const i=Fb();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function ZE(){var i;const e=Rs();return e===Pr.browser?[e,((i=fp())==null?void 0:i.host)||"unknown"].join(":"):e}function e3(i,e,t){const s=XE(),o=ZE();return[[i,e].join("-"),[WE,t].join("-"),s,o].join("/")}function t3({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:l,bundleId:f}){const g=t.split("?"),p=e3(i,e,s),v={auth:o,ua:p,projectId:c,useOnCloseEvent:l||void 0,origin:f||void 0},D=JE(g[1]||"",v);return g[0]+"?"+D}function on(i,e){return i.filter(t=>e.includes(t)).length===i.length}function mp(i){return Object.fromEntries(i.entries())}function wp(i){return new Map(Object.entries(i))}function Fn(i=ve.FIVE_MINUTES,e){const t=ve.toMiliseconds(i||ve.FIVE_MINUTES);let s,o,c;return{resolve:l=>{c&&s&&(clearTimeout(c),s(l))},reject:l=>{c&&o&&(clearTimeout(c),o(l))},done:()=>new Promise((l,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=l,o=f})}}function Ss(i,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const l=await i;s(l)}catch(l){o(l)}clearTimeout(c)})}function bp(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function r3(i){return bp("topic",i)}function i3(i){return bp("id",i)}function Ep(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Or(i,e){return ve.fromMiliseconds((e||Date.now())+ve.toMiliseconds(i))}function Ui(i){return Date.now()>=ve.toMiliseconds(i)}function $t(i,e){return`${i}${e?`:${e}`:""}`}function Vc(i=[],e=[]){return[...new Set([...i,...e])]}async function n3({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${e}`,l=Rs();l===Pr.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):l===Pr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}async function s3(i,e){try{return await i.getItem(e)||(Hn()?localStorage.getItem(e):void 0)}catch(t){console.error(t)}}const o3="irn";function Du(i){return(i==null?void 0:i.relay)||{protocol:o3}}function Go(i){const e=TE[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var a3=Object.defineProperty,c3=Object.defineProperties,u3=Object.getOwnPropertyDescriptors,Ff=Object.getOwnPropertySymbols,h3=Object.prototype.hasOwnProperty,l3=Object.prototype.propertyIsEnumerable,Uf=(i,e,t)=>e in i?a3(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,f3=(i,e)=>{for(var t in e||(e={}))h3.call(e,t)&&Uf(i,t,e[t]);if(Ff)for(var t of Ff(e))l3.call(e,t)&&Uf(i,t,e[t]);return i},d3=(i,e)=>c3(i,u3(e));function p3(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),l=i[o];t[c]=l}}),t}function Lf(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),o=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",l=Ds.parse(c);return{protocol:s,topic:g3(o[0]),version:parseInt(o[1],10),symKey:l.symKey,relay:p3(l),expiryTimestamp:l.expiryTimestamp?parseInt(l.expiryTimestamp,10):void 0}}function g3(i){return i.startsWith("//")?i.substring(2):i}function y3(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(o=>{const c=t+e+o;i[o]&&(s[c]=i[o])}),s}function v3(i){return`${i.protocol}:${i.topic}@${i.version}?`+Ds.stringify(d3(f3({symKey:i.symKey},y3(i.relay)),{expiryTimestamp:i.expiryTimestamp}))}function Kn(i){const e=[];return i.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function _3(i){const e=[];return Object.values(i).forEach(t=>{e.push(...Kn(t.accounts))}),e}function m3(i,e){const t=[];return Object.values(i).forEach(s=>{Kn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function w3(i,e){const t=[];return Object.values(i).forEach(s=>{Kn(s.accounts).includes(e)&&t.push(...s.events)}),t}function Xu(i){return i.includes(":")}function _s(i){return Xu(i)?i.split(":")[0]:i}const b3={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},E3={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ce(i,e){const{message:t,code:s}=E3[i];return{message:e?`${t} ${e}`:t,code:s}}function mt(i,e){const{message:t,code:s}=b3[i];return{message:e?`${t} ${e}`:t,code:s}}function ni(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function Is(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function ur(i){return typeof i>"u"}function Gt(i,e){return e&&ur(i)?!0:typeof i=="string"&&!!i.trim().length}function Zu(i,e){return e&&ur(i)?!0:typeof i=="number"&&!isNaN(i)}function D3(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),o=Object.keys(t);let c=!0;return on(o,s)?(s.forEach(l=>{const{accounts:f,methods:g,events:p}=i.namespaces[l],v=Kn(f),D=t[l];(!on(gp(l,D),v)||!on(D.methods,g)||!on(D.events,p))&&(c=!1)}),c):!1}function Zo(i){return Gt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function S3(i){if(Gt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Zo(t)}}return!1}function I3(i){if(Gt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function x3(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function O3(i){return i==null?void 0:i.topic}function P3(i,e){let t=null;return Gt(i==null?void 0:i.publicKey,!1)||(t=ce("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function jf(i){let e=!0;return ni(i)?i.length&&(e=i.every(t=>Gt(t,!1))):e=!1,e}function C3(i,e,t){let s=null;return ni(e)&&e.length?e.forEach(o=>{s||Zo(o)||(s=mt("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Zo(i)||(s=mt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function A3(i,e,t){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const l=C3(o,gp(o,c),`${e} ${t}`);l&&(s=l)}),s}function T3(i,e){let t=null;return ni(i)?i.forEach(s=>{t||S3(s)||(t=mt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=mt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function R3(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=T3(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function N3(i,e){let t=null;return jf(i==null?void 0:i.methods)?jf(i==null?void 0:i.events)||(t=mt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=mt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Dp(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=N3(s,`${e}, namespace`);o&&(t=o)}),t}function $3(i,e,t){let s=null;if(i&&Is(i)){const o=Dp(i,e);o&&(s=o);const c=A3(i,e,t);c&&(s=c)}else s=ce("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Gc(i,e){let t=null;if(i&&Is(i)){const s=Dp(i,e);s&&(t=s);const o=R3(i,e);o&&(t=o)}else t=ce("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function Sp(i){return Gt(i.protocol,!0)}function F3(i,e){let t=!1;return e&&!i?t=!0:i&&ni(i)&&i.length&&i.forEach(s=>{t=Sp(s)}),t}function U3(i){return typeof i=="number"}function mr(i){return typeof i<"u"&&typeof i!==null}function L3(i){return!(!i||typeof i!="object"||!i.code||!Zu(i.code,!1)||!i.message||!Gt(i.message,!1))}function j3(i){return!(ur(i)||!Gt(i.method,!1))}function M3(i){return!(ur(i)||ur(i.result)&&ur(i.error)||!Zu(i.id,!1)||!Gt(i.jsonrpc,!1))}function q3(i){return!(ur(i)||!Gt(i.name,!1))}function Mf(i,e){return!(!Zo(e)||!_3(i).includes(e))}function B3(i,e,t){return Gt(t,!1)?m3(i,e).includes(t):!1}function z3(i,e,t){return Gt(t,!1)?w3(i,e).includes(t):!1}function qf(i,e,t){let s=null;const o=H3(i),c=K3(e),l=Object.keys(o),f=Object.keys(c),g=Bf(Object.keys(i)),p=Bf(Object.keys(e)),v=g.filter(D=>!p.includes(D));return v.length&&(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${v.toString()}
      Received: ${Object.keys(e).toString()}`)),on(l,f)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${l.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(D=>{if(!D.includes(":")||s)return;const S=Kn(e[D].accounts);S.includes(D)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${D}
        Required: ${D}
        Approved: ${S.toString()}`))}),l.forEach(D=>{s||(on(o[D].methods,c[D].methods)?on(o[D].events,c[D].events)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${D}`)):s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${D}`))}),s}function H3(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(o=>{e[o]={methods:i[t].methods,events:i[t].events}})}),e}function Bf(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function K3(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=Kn(i[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:i[t].accounts.filter(c=>c.includes(`${o}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function k3(i,e){return Zu(i,!1)&&i<=e.max&&i>=e.min}function zf(){const i=Rs();return new Promise(e=>{switch(i){case Pr.browser:e(V3());break;case Pr.reactNative:e(G3());break;case Pr.node:e(W3());break;default:e(!0)}})}function V3(){return Hn()&&(navigator==null?void 0:navigator.onLine)}async function G3(){if(zn()&&typeof global<"u"&&global!=null&&global.NetInfo){const i=await(global==null?void 0:global.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function W3(){return!0}function Y3(i){switch(Rs()){case Pr.browser:J3(i);break;case Pr.reactNative:Q3(i);break}}function J3(i){!zn()&&Hn()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function Q3(i){zn()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>i(e==null?void 0:e.isConnected)))}const Wc={};let Bo=class{static get(e){return Wc[e]}static set(e,t){Wc[e]=t}static delete(e){delete Wc[e]}};const X3=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Z3=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,eD=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function tD(i,e){if(i==="__proto__"||i==="constructor"&&e&&typeof e=="object"&&"prototype"in e){rD(i);return}return e}function rD(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function zo(i,e={}){if(typeof i!="string")return i;const t=i.trim();if(i[0]==='"'&&i.at(-1)==='"'&&!i.includes("\\"))return t.slice(1,-1);if(t.length<=9){const s=t.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!eD.test(i)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(X3.test(i)||Z3.test(i)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,tD)}return JSON.parse(i)}catch(s){if(e.strict)throw s;return i}}function iD(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function Vt(i,...e){try{return iD(i(...e))}catch(t){return Promise.reject(t)}}function nD(i){const e=typeof i;return i===null||e!=="object"&&e!=="function"}function sD(i){const e=Object.getPrototypeOf(i);return!e||e.isPrototypeOf(Object)}function Wo(i){if(nD(i))return String(i);if(sD(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return Wo(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Ip(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Su="base64:";function oD(i){if(typeof i=="string")return i;Ip();const e=Buffer.from(i).toString("base64");return Su+e}function aD(i){return typeof i!="string"||!i.startsWith(Su)?i:(Ip(),Buffer.from(i.slice(Su.length),"base64"))}function _r(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function cD(...i){return _r(i.join(":"))}function Ho(i){return i=_r(i),i?i+":":""}const uD="memory",hD=()=>{const i=new Map;return{name:uD,options:{},hasItem(e){return i.has(e)},getItem(e){return i.get(e)??null},getItemRaw(e){return i.get(e)??null},setItem(e,t){i.set(e,t)},setItemRaw(e,t){i.set(e,t)},removeItem(e){i.delete(e)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function lD(i={}){const e={mounts:{"":i.driver||hD()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=p=>{for(const v of e.mountpoints)if(p.startsWith(v))return{base:v,relativeKey:p.slice(v.length),driver:e.mounts[v]};return{base:"",relativeKey:p,driver:e.mounts[""]}},s=(p,v)=>e.mountpoints.filter(D=>D.startsWith(p)||v&&p.startsWith(D)).map(D=>({relativeBase:p.length>D.length?p.slice(D.length):void 0,mountpoint:D,driver:e.mounts[D]})),o=(p,v)=>{if(e.watching){v=_r(v);for(const D of e.watchListeners)D(p,v)}},c=async()=>{if(!e.watching){e.watching=!0;for(const p in e.mounts)e.unwatch[p]=await Hf(e.mounts[p],o,p)}},l=async()=>{if(e.watching){for(const p in e.unwatch)await e.unwatch[p]();e.unwatch={},e.watching=!1}},f=(p,v,D)=>{const S=new Map,x=O=>{let q=S.get(O.base);return q||(q={driver:O.driver,base:O.base,items:[]},S.set(O.base,q)),q};for(const O of p){const q=typeof O=="string",H=_r(q?O:O.key),ie=q?void 0:O.value,$=q||!O.options?v:{...v,...O.options},j=t(H);x(j).items.push({key:H,value:ie,relativeKey:j.relativeKey,options:$})}return Promise.all([...S.values()].map(O=>D(O))).then(O=>O.flat())},g={hasItem(p,v={}){p=_r(p);const{relativeKey:D,driver:S}=t(p);return Vt(S.hasItem,D,v)},getItem(p,v={}){p=_r(p);const{relativeKey:D,driver:S}=t(p);return Vt(S.getItem,D,v).then(x=>zo(x))},getItems(p,v){return f(p,v,D=>D.driver.getItems?Vt(D.driver.getItems,D.items.map(S=>({key:S.relativeKey,options:S.options})),v).then(S=>S.map(x=>({key:cD(D.base,x.key),value:zo(x.value)}))):Promise.all(D.items.map(S=>Vt(D.driver.getItem,S.relativeKey,S.options).then(x=>({key:S.key,value:zo(x)})))))},getItemRaw(p,v={}){p=_r(p);const{relativeKey:D,driver:S}=t(p);return S.getItemRaw?Vt(S.getItemRaw,D,v):Vt(S.getItem,D,v).then(x=>aD(x))},async setItem(p,v,D={}){if(v===void 0)return g.removeItem(p);p=_r(p);const{relativeKey:S,driver:x}=t(p);x.setItem&&(await Vt(x.setItem,S,Wo(v),D),x.watch||o("update",p))},async setItems(p,v){await f(p,v,async D=>{D.driver.setItems&&await Vt(D.driver.setItems,D.items.map(S=>({key:S.relativeKey,value:Wo(S.value),options:S.options})),v),D.driver.setItem&&await Promise.all(D.items.map(S=>Vt(D.driver.setItem,S.relativeKey,Wo(S.value),S.options)))})},async setItemRaw(p,v,D={}){if(v===void 0)return g.removeItem(p,D);p=_r(p);const{relativeKey:S,driver:x}=t(p);if(x.setItemRaw)await Vt(x.setItemRaw,S,v,D);else if(x.setItem)await Vt(x.setItem,S,oD(v),D);else return;x.watch||o("update",p)},async removeItem(p,v={}){typeof v=="boolean"&&(v={removeMeta:v}),p=_r(p);const{relativeKey:D,driver:S}=t(p);S.removeItem&&(await Vt(S.removeItem,D,v),(v.removeMeta||v.removeMata)&&await Vt(S.removeItem,D+"$",v),S.watch||o("remove",p))},async getMeta(p,v={}){typeof v=="boolean"&&(v={nativeOnly:v}),p=_r(p);const{relativeKey:D,driver:S}=t(p),x=Object.create(null);if(S.getMeta&&Object.assign(x,await Vt(S.getMeta,D,v)),!v.nativeOnly){const O=await Vt(S.getItem,D+"$",v).then(q=>zo(q));O&&typeof O=="object"&&(typeof O.atime=="string"&&(O.atime=new Date(O.atime)),typeof O.mtime=="string"&&(O.mtime=new Date(O.mtime)),Object.assign(x,O))}return x},setMeta(p,v,D={}){return this.setItem(p+"$",v,D)},removeMeta(p,v={}){return this.removeItem(p+"$",v)},async getKeys(p,v={}){p=Ho(p);const D=s(p,!0);let S=[];const x=[];for(const O of D){const H=(await Vt(O.driver.getKeys,O.relativeBase,v)).map(ie=>O.mountpoint+_r(ie)).filter(ie=>!S.some($=>ie.startsWith($)));x.push(...H),S=[O.mountpoint,...S.filter(ie=>!ie.startsWith(O.mountpoint))]}return p?x.filter(O=>O.startsWith(p)&&!O.endsWith("$")):x.filter(O=>!O.endsWith("$"))},async clear(p,v={}){p=Ho(p),await Promise.all(s(p,!1).map(async D=>{if(D.driver.clear)return Vt(D.driver.clear,D.relativeBase,v);if(D.driver.removeItem){const S=await D.driver.getKeys(D.relativeBase||"",v);return Promise.all(S.map(x=>D.driver.removeItem(x,v)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(p=>Kf(p)))},async watch(p){return await c(),e.watchListeners.push(p),async()=>{e.watchListeners=e.watchListeners.filter(v=>v!==p),e.watchListeners.length===0&&await l()}},async unwatch(){e.watchListeners=[],await l()},mount(p,v){if(p=Ho(p),p&&e.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(e.mountpoints.push(p),e.mountpoints.sort((D,S)=>S.length-D.length)),e.mounts[p]=v,e.watching&&Promise.resolve(Hf(v,o,p)).then(D=>{e.unwatch[p]=D}).catch(console.error),g},async unmount(p,v=!0){p=Ho(p),!(!p||!e.mounts[p])&&(e.watching&&p in e.unwatch&&(e.unwatch[p](),delete e.unwatch[p]),v&&await Kf(e.mounts[p]),e.mountpoints=e.mountpoints.filter(D=>D!==p),delete e.mounts[p])},getMount(p=""){p=_r(p)+":";const v=t(p);return{driver:v.driver,base:v.base}},getMounts(p="",v={}){return p=_r(p),s(p,v.parents).map(S=>({driver:S.driver,base:S.mountpoint}))}};return g}function Hf(i,e,t){return i.watch?i.watch((s,o)=>e(s,t+o)):()=>{}}async function Kf(i){typeof i.dispose=="function"&&await Vt(i.dispose)}function hn(i){return new Promise((e,t)=>{i.oncomplete=i.onsuccess=()=>e(i.result),i.onabort=i.onerror=()=>t(i.error)})}function xp(i,e){const t=indexedDB.open(i);t.onupgradeneeded=()=>t.result.createObjectStore(e);const s=hn(t);return(o,c)=>s.then(l=>c(l.transaction(e,o).objectStore(e)))}let Yc;function Ns(){return Yc||(Yc=xp("keyval-store","keyval")),Yc}function kf(i,e=Ns()){return e("readonly",t=>hn(t.get(i)))}function fD(i,e,t=Ns()){return t("readwrite",s=>(s.put(e,i),hn(s.transaction)))}function dD(i,e=Ns()){return e("readwrite",t=>(t.delete(i),hn(t.transaction)))}function pD(i=Ns()){return i("readwrite",e=>(e.clear(),hn(e.transaction)))}function gD(i,e){return i.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},hn(i.transaction)}function yD(i=Ns()){return i("readonly",e=>{if(e.getAllKeys)return hn(e.getAllKeys());const t=[];return gD(e,s=>t.push(s.key)).then(()=>t)})}const vD=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),_D=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function $s(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return _D(i)}catch{return i}}function an(i){return typeof i=="string"?i:vD(i)||""}const mD="idb-keyval";var wD=(i={})=>{const e=i.base&&i.base.length>0?`${i.base}:`:"",t=o=>e+o;let s;return i.dbName&&i.storeName&&(s=xp(i.dbName,i.storeName)),{name:mD,options:i,async hasItem(o){return!(typeof await kf(t(o),s)>"u")},async getItem(o){return await kf(t(o),s)??null},setItem(o,c){return fD(t(o),c,s)},removeItem(o){return dD(t(o),s)},getKeys(){return yD(s)},clear(){return pD(s)}}};const bD="WALLET_CONNECT_V2_INDEXED_DB",ED="keyvaluestorage";let DD=class{constructor(){this.indexedDb=lD({driver:wD({dbName:bD,storeName:ED})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,an(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Jc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yo={exports:{}};(function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Jc<"u"&&Jc.localStorage?Yo.exports=Jc.localStorage:typeof window<"u"&&window.localStorage?Yo.exports=window.localStorage:Yo.exports=new e})();function SD(i){var e;return[i[0],$s((e=i[1])!=null?e:"")]}class ID{constructor(){this.localStorage=Yo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(SD)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return $s(t)}async setItem(e,t){this.localStorage.setItem(e,an(t))}async removeItem(e){this.localStorage.removeItem(e)}}const xD="wc_storage_version",Vf=1,OD=async(i,e,t)=>{const s=xD,o=await e.getItem(s);if(o&&o>=Vf){t(e);return}const c=await i.getKeys();if(!c.length){t(e);return}const l=[];for(;c.length;){const f=c.shift();if(!f)continue;const g=f.toLowerCase();if(g.includes("wc@")||g.includes("walletconnect")||g.includes("wc_")||g.includes("wallet_connect")){const p=await i.getItem(f);await e.setItem(f,p),l.push(f)}}await e.setItem(s,Vf),t(e),PD(i,l)},PD=async(i,e)=>{e.length&&e.forEach(async t=>{await i.removeItem(t)})};let CD=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new ID;this.storage=e;try{const t=new DD;OD(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var kn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Iu=function(i,e){return Iu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Iu(i,e)};function AD(i,e){Iu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var xu=function(){return xu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},xu.apply(this,arguments)};function TD(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function RD(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function ND(i,e){return function(t,s){e(t,s,i)}}function $D(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function FD(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(D){l(D)}}function g(v){try{p(s.throw(v))}catch(D){l(D)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function UD(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function LD(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function jD(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Ou(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Op(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-->0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function MD(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Op(arguments[e]));return i}function qD(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function xs(i){return this instanceof xs?(this.v=i,this):new xs(i)}function BD(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(x){return new Promise(function(O,q){c.push([S,x,O,q])>1||f(S,x)})})}function f(S,x){try{g(s[S](x))}catch(O){D(c[0][3],O)}}function g(S){S.value instanceof xs?Promise.resolve(S.value.v).then(p,v):D(c[0][2],S)}function p(S){f("next",S)}function v(S){f("throw",S)}function D(S,x){S(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function zD(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:xs(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function HD(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Ou=="function"?Ou(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function KD(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function kD(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function VD(i){return i&&i.__esModule?i:{default:i}}function GD(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function WD(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const YD=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return xu},__asyncDelegator:zD,__asyncGenerator:BD,__asyncValues:HD,__await:xs,__awaiter:FD,__classPrivateFieldGet:GD,__classPrivateFieldSet:WD,__createBinding:LD,__decorate:RD,__exportStar:jD,__extends:AD,__generator:UD,__importDefault:VD,__importStar:kD,__makeTemplateObject:KD,__metadata:$D,__param:ND,__read:Op,__rest:TD,__spread:MD,__spreadArrays:qD,__values:Ou},Symbol.toStringTag,{value:"Module"})),la=Mn(YD);var ds={},Qc={},ps={};let ln=class{};const JD=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ln},Symbol.toStringTag,{value:"Module"})),QD=Mn(JD);var Gf;function XD(){if(Gf)return ps;Gf=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.IHeartBeat=void 0;const i=QD;class e extends i.IEvents{constructor(s){super()}}return ps.IHeartBeat=e,ps}var Wf;function Pp(){return Wf||(Wf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),la.__exportStar(XD(),i)}(Qc)),Qc}var Xc={},nn={},Yf;function ZD(){if(Yf)return nn;Yf=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.HEARTBEAT_EVENTS=nn.HEARTBEAT_INTERVAL=void 0;const i=ve;return nn.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,nn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},nn}var Jf;function Cp(){return Jf||(Jf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),la.__exportStar(ZD(),i)}(Xc)),Xc}var Qf;function e6(){if(Qf)return ds;Qf=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.HeartBeat=void 0;const i=la,e=Gd(),t=ve,s=Pp(),o=Cp();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const g=new c(f);return yield g.init(),g})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,g){this.events.on(f,g)}once(f,g){this.events.once(f,g)}off(f,g){this.events.off(f,g)}removeListener(f,g){this.events.removeListener(f,g)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return ds.HeartBeat=c,ds}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=la;e.__exportStar(e6(),i),e.__exportStar(Pp(),i),e.__exportStar(Cp(),i)})(kn);var Je={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Pu=function(i,e){return Pu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Pu(i,e)};function t6(i,e){Pu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Cu=function(){return Cu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Cu.apply(this,arguments)};function r6(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function i6(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function n6(i,e){return function(t,s){e(t,s,i)}}function s6(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function o6(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(D){l(D)}}function g(v){try{p(s.throw(v))}catch(D){l(D)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function a6(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function c6(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function u6(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Au(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ap(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-->0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function h6(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Ap(arguments[e]));return i}function l6(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Os(i){return this instanceof Os?(this.v=i,this):new Os(i)}function f6(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(x){return new Promise(function(O,q){c.push([S,x,O,q])>1||f(S,x)})})}function f(S,x){try{g(s[S](x))}catch(O){D(c[0][3],O)}}function g(S){S.value instanceof Os?Promise.resolve(S.value.v).then(p,v):D(c[0][2],S)}function p(S){f("next",S)}function v(S){f("throw",S)}function D(S,x){S(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function d6(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Os(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function p6(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Au=="function"?Au(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function g6(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function y6(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function v6(i){return i&&i.__esModule?i:{default:i}}function _6(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function m6(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const w6=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Cu},__asyncDelegator:d6,__asyncGenerator:f6,__asyncValues:p6,__await:Os,__awaiter:o6,__classPrivateFieldGet:_6,__classPrivateFieldSet:m6,__createBinding:c6,__decorate:i6,__exportStar:u6,__extends:t6,__generator:a6,__importDefault:v6,__importStar:y6,__makeTemplateObject:g6,__metadata:s6,__param:n6,__read:Ap,__rest:r6,__spread:h6,__spreadArrays:l6,__values:Au},Symbol.toStringTag,{value:"Module"})),b6=Mn(w6);var Zc,Xf;function E6(){if(Xf)return Zc;Xf=1;function i(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Zc=e;function e(t,s,o){var c=o&&o.stringify||i,l=1;if(typeof t=="object"&&t!==null){var f=s.length+l;if(f===1)return t;var g=new Array(f);g[0]=c(t);for(var p=1;p<f;p++)g[p]=c(s[p]);return g.join(" ")}if(typeof t!="string")return t;var v=s.length;if(v===0)return t;for(var D="",S=1-l,x=-1,O=t&&t.length||0,q=0;q<O;){if(t.charCodeAt(q)===37&&q+1<O){switch(x=x>-1?x:0,t.charCodeAt(q+1)){case 100:case 102:if(S>=v||s[S]==null)break;x<q&&(D+=t.slice(x,q)),D+=Number(s[S]),x=q+2,q++;break;case 105:if(S>=v||s[S]==null)break;x<q&&(D+=t.slice(x,q)),D+=Math.floor(Number(s[S])),x=q+2,q++;break;case 79:case 111:case 106:if(S>=v||s[S]===void 0)break;x<q&&(D+=t.slice(x,q));var H=typeof s[S];if(H==="string"){D+="'"+s[S]+"'",x=q+2,q++;break}if(H==="function"){D+=s[S].name||"<anonymous>",x=q+2,q++;break}D+=c(s[S]),x=q+2,q++;break;case 115:if(S>=v)break;x<q&&(D+=t.slice(x,q)),D+=String(s[S]),x=q+2,q++;break;case 37:x<q&&(D+=t.slice(x,q)),D+="%",x=q+2,q++,S--;break}++S}++q}return x===-1?t:(x<O&&(D+=t.slice(x)),D)}return Zc}var eu,Zf;function D6(){if(Zf)return eu;Zf=1;const i=E6();eu=o;const e=T().console||{},t={mapHttpRequest:O,mapHttpResponse:O,wrapRequestSerializer:q,wrapResponseSerializer:q,wrapErrorSerializer:q,req:O,res:O,err:S};function s(E,u){return Array.isArray(E)?E.filter(function(G){return G!=="!stdSerializers.err"}):E===!0?Object.keys(u):!1}function o(E){E=E||{},E.browser=E.browser||{};const u=E.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const w=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const G=E.serializers||{},W=s(E.browser.serialize,G);let se=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ue=["error","fatal","warn","info","debug","trace"];typeof w=="function"&&(w.error=w.fatal=w.warn=w.info=w.debug=w.trace=w),E.enabled===!1&&(E.level="silent");const de=E.level||"info",b=Object.create(w);b.log||(b.log=H),Object.defineProperty(b,"levelVal",{get:ee}),Object.defineProperty(b,"level",{get:Q,set:k});const A={transmit:u,serialize:W,asObject:E.browser.asObject,levels:ue,timestamp:x(E)};b.levels=o.levels,b.level=de,b.setMaxListeners=b.getMaxListeners=b.emit=b.addListener=b.on=b.prependListener=b.once=b.prependOnceListener=b.removeListener=b.removeAllListeners=b.listeners=b.listenerCount=b.eventNames=b.write=b.flush=H,b.serializers=G,b._serialize=W,b._stdErrSerialize=se,b.child=V,u&&(b._logEvent=D());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Q(){return this._level}function k(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,c(A,b,"error","log"),c(A,b,"fatal","error"),c(A,b,"warn","error"),c(A,b,"info","log"),c(A,b,"debug","log"),c(A,b,"trace","log")}function V(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},W&&J.serializers&&(re.serializers=J.serializers);const we=re.serializers;if(W&&we){var oe=Object.assign({},G,we),be=E.browser.serialize===!0?Object.keys(oe):W;delete J.serializers,g([J],be,oe,this._stdErrSerialize)}function le(_e){this._childLevel=(_e._childLevel|0)+1,this.error=p(_e,J,"error"),this.fatal=p(_e,J,"fatal"),this.warn=p(_e,J,"warn"),this.info=p(_e,J,"info"),this.debug=p(_e,J,"debug"),this.trace=p(_e,J,"trace"),oe&&(this.serializers=oe,this._serialize=be),u&&(this._logEvent=D([].concat(_e._logEvent.bindings,J)))}return le.prototype=this,new le(this)}return b}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:$,unixTime:j,isoTime:C});function c(E,u,w,G){const W=Object.getPrototypeOf(u);u[w]=u.levelVal>u.levels.values[w]?H:W[w]?W[w]:e[w]||e[G]||H,l(E,u,w)}function l(E,u,w){!E.transmit&&u[w]===H||(u[w]=function(G){return function(){const se=E.timestamp(),ue=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var b=0;b<ue.length;b++)ue[b]=arguments[b];if(E.serialize&&!E.asObject&&g(ue,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?G.call(de,f(this,w,ue,se)):G.apply(de,ue),E.transmit){const A=E.transmit.level||u.level,ee=o.levels.values[A],Q=o.levels.values[w];if(Q<ee)return;v(this,{ts:se,methodLevel:w,methodValue:Q,transmitLevel:A,transmitValue:o.levels.values[E.transmit.level||u.level],send:E.transmit.send,val:u.levelVal},ue)}}}(u[w]))}function f(E,u,w,G){E._serialize&&g(w,E._serialize,E.serializers,E._stdErrSerialize);const W=w.slice();let se=W[0];const ue={};G&&(ue.time=G),ue.level=o.levels.values[u];let de=(E._childLevel|0)+1;if(de<1&&(de=1),se!==null&&typeof se=="object"){for(;de--&&typeof W[0]=="object";)Object.assign(ue,W.shift());se=W.length?i(W.shift(),W):void 0}else typeof se=="string"&&(se=i(W.shift(),W));return se!==void 0&&(ue.msg=se),ue}function g(E,u,w,G){for(const W in E)if(G&&E[W]instanceof Error)E[W]=o.stdSerializers.err(E[W]);else if(typeof E[W]=="object"&&!Array.isArray(E[W]))for(const se in E[W])u&&u.indexOf(se)>-1&&se in w&&(E[W][se]=w[se](E[W][se]))}function p(E,u,w){return function(){const G=new Array(1+arguments.length);G[0]=u;for(var W=1;W<G.length;W++)G[W]=arguments[W-1];return E[w].apply(this,G)}}function v(E,u,w){const G=u.send,W=u.ts,se=u.methodLevel,ue=u.methodValue,de=u.val,b=E._logEvent.bindings;g(w,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=W,E._logEvent.messages=w.filter(function(A){return b.indexOf(A)===-1}),E._logEvent.level.label=se,E._logEvent.level.value=ue,G(se,E._logEvent,de),E._logEvent=D(b)}function D(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function S(E){const u={type:E.constructor.name,msg:E.message,stack:E.stack};for(const w in E)u[w]===void 0&&(u[w]=E[w]);return u}function x(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?ie:$}function O(){return{}}function q(E){return E}function H(){}function ie(){return!1}function $(){return Date.now()}function j(){return Math.round(Date.now()/1e3)}function C(){return new Date(Date.now()).toISOString()}function T(){function E(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return eu}var sn={},ed;function Tp(){return ed||(ed=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.PINO_CUSTOM_CONTEXT_KEY=sn.PINO_LOGGER_DEFAULTS=void 0,sn.PINO_LOGGER_DEFAULTS={level:"info"},sn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),sn}var ar={},td;function S6(){if(td)return ar;td=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.generateChildLogger=ar.formatChildLoggerContext=ar.getLoggerContext=ar.setBrowserLoggerContext=ar.getBrowserLoggerContext=ar.getDefaultLoggerOptions=void 0;const i=Tp();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||i.PINO_LOGGER_DEFAULTS.level})}ar.getDefaultLoggerOptions=e;function t(f,g=i.PINO_CUSTOM_CONTEXT_KEY){return f[g]||""}ar.getBrowserLoggerContext=t;function s(f,g,p=i.PINO_CUSTOM_CONTEXT_KEY){return f[p]=g,f}ar.setBrowserLoggerContext=s;function o(f,g=i.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof f.bindings>"u"?p=t(f,g):p=f.bindings().context||"",p}ar.getLoggerContext=o;function c(f,g,p=i.PINO_CUSTOM_CONTEXT_KEY){const v=o(f,p);return v.trim()?`${v}/${g}`:g}ar.formatChildLoggerContext=c;function l(f,g,p=i.PINO_CUSTOM_CONTEXT_KEY){const v=c(f,g,p),D=f.child({context:v});return s(D,v,p)}return ar.generateChildLogger=l,ar}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const e=b6,t=e.__importDefault(D6());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(Tp(),i),e.__exportStar(S6(),i)})(Je);class I6 extends ln{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let x6=class extends ln{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},O6=class{constructor(e,t){this.logger=e,this.core=t}},P6=class extends ln{constructor(e,t){super(),this.relayer=e,this.logger=t}},C6=class extends ln{constructor(e){super()}},A6=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class T6 extends ln{constructor(e,t){super(),this.relayer=e,this.logger=t}}let R6=class extends ln{constructor(e,t){super(),this.core=e,this.logger=t}},N6=class{constructor(e,t){this.projectId=e,this.logger=t}},$6=class{constructor(e,t){this.projectId=e,this.logger=t}},F6=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},U6=class{constructor(e){this.client=e}};var eh={},Rp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Ue,t=Cr;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(g,p){if(p===void 0&&(p=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var v=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=g[v++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(v=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,v,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=g[v++],p--;return this},f.prototype.finish=function(g){if(!this._finished){var p=this._bytesHashed,v=this._bufferLength,D=p/536870912|0,S=p<<3,x=p%128<112?128:256;this._buffer[v]=128;for(var O=v+1;O<x-8;O++)this._buffer[O]=0;e.writeUint32BE(D,this._buffer,x-8),e.writeUint32BE(S,this._buffer,x-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,x),this._finished=!0}for(var O=0;O<this.digestLength/8;O++)e.writeUint32BE(this._stateHi[O],g,O*8),e.writeUint32BE(this._stateLo[O],g,O*8+4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){t.wipe(g.stateHi),t.wipe(g.stateLo),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,g,p,v,D,S,x){for(var O=p[0],q=p[1],H=p[2],ie=p[3],$=p[4],j=p[5],C=p[6],T=p[7],E=v[0],u=v[1],w=v[2],G=v[3],W=v[4],se=v[5],ue=v[6],de=v[7],b,A,ee,Q,k,V,J,re;x>=128;){for(var we=0;we<16;we++){var oe=8*we+S;f[we]=e.readUint32BE(D,oe),g[we]=e.readUint32BE(D,oe+4)}for(var we=0;we<80;we++){var be=O,le=q,_e=H,z=ie,B=$,F=j,d=C,R=T,ae=E,fe=u,Ie=w,ze=G,ke=W,Le=se,pt=ue,gt=de;if(b=T,A=de,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=($>>>14|W<<32-14)^($>>>18|W<<32-18)^(W>>>41-32|$<<32-(41-32)),A=(W>>>14|$<<32-14)^(W>>>18|$<<32-18)^($>>>41-32|W<<32-(41-32)),k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,b=$&j^~$&C,A=W&se^~W&ue,k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,b=o[we*2],A=o[we*2+1],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,b=f[we%16],A=g[we%16],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,ee=J&65535|re<<16,Q=k&65535|V<<16,b=ee,A=Q,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=(O>>>28|E<<32-28)^(E>>>34-32|O<<32-(34-32))^(E>>>39-32|O<<32-(39-32)),A=(E>>>28|O<<32-28)^(O>>>34-32|E<<32-(34-32))^(O>>>39-32|E<<32-(39-32)),k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,b=O&q^O&H^q&H,A=E&u^E&w^u&w,k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,R=J&65535|re<<16,gt=k&65535|V<<16,b=z,A=ze,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=ee,A=Q,k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,z=J&65535|re<<16,ze=k&65535|V<<16,q=be,H=le,ie=_e,$=z,j=B,C=F,T=d,O=R,u=ae,w=fe,G=Ie,W=ze,se=ke,ue=Le,de=pt,E=gt,we%16===15)for(var oe=0;oe<16;oe++)b=f[oe],A=g[oe],k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=f[(oe+9)%16],A=g[(oe+9)%16],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,ee=f[(oe+1)%16],Q=g[(oe+1)%16],b=(ee>>>1|Q<<32-1)^(ee>>>8|Q<<32-8)^ee>>>7,A=(Q>>>1|ee<<32-1)^(Q>>>8|ee<<32-8)^(Q>>>7|ee<<32-7),k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,ee=f[(oe+14)%16],Q=g[(oe+14)%16],b=(ee>>>19|Q<<32-19)^(Q>>>61-32|ee<<32-(61-32))^ee>>>6,A=(Q>>>19|ee<<32-19)^(ee>>>61-32|Q<<32-(61-32))^(Q>>>6|ee<<32-6),k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,f[oe]=J&65535|re<<16,g[oe]=k&65535|V<<16}b=O,A=E,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[0],A=v[0],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[0]=O=J&65535|re<<16,v[0]=E=k&65535|V<<16,b=q,A=u,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[1],A=v[1],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[1]=q=J&65535|re<<16,v[1]=u=k&65535|V<<16,b=H,A=w,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[2],A=v[2],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[2]=H=J&65535|re<<16,v[2]=w=k&65535|V<<16,b=ie,A=G,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[3],A=v[3],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[3]=ie=J&65535|re<<16,v[3]=G=k&65535|V<<16,b=$,A=W,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[4],A=v[4],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[4]=$=J&65535|re<<16,v[4]=W=k&65535|V<<16,b=j,A=se,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[5],A=v[5],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[5]=j=J&65535|re<<16,v[5]=se=k&65535|V<<16,b=C,A=ue,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[6],A=v[6],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[6]=C=J&65535|re<<16,v[6]=ue=k&65535|V<<16,b=T,A=de,k=A&65535,V=A>>>16,J=b&65535,re=b>>>16,b=p[7],A=v[7],k+=A&65535,V+=A>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,p[7]=T=J&65535|re<<16,v[7]=de=k&65535|V<<16,S+=128,x-=128}return S}function l(f){var g=new s;g.update(f);var p=g.digest();return g.clean(),p}i.hash=l})(Rp);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=qn,t=Rp,s=Cr;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(z){const B=new Float64Array(16);if(z)for(let F=0;F<z.length;F++)B[F]=z[F];return B}const c=new Uint8Array(32);c[0]=9;const l=o(),f=o([1]),g=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),v=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),D=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),S=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function x(z,B){for(let F=0;F<16;F++)z[F]=B[F]|0}function O(z){let B=1;for(let F=0;F<16;F++){let d=z[F]+B+65535;B=Math.floor(d/65536),z[F]=d-B*65536}z[0]+=B-1+37*(B-1)}function q(z,B,F){const d=~(F-1);for(let R=0;R<16;R++){const ae=d&(z[R]^B[R]);z[R]^=ae,B[R]^=ae}}function H(z,B){const F=o(),d=o();for(let R=0;R<16;R++)d[R]=B[R];O(d),O(d),O(d);for(let R=0;R<2;R++){F[0]=d[0]-65517;for(let fe=1;fe<15;fe++)F[fe]=d[fe]-65535-(F[fe-1]>>16&1),F[fe-1]&=65535;F[15]=d[15]-32767-(F[14]>>16&1);const ae=F[15]>>16&1;F[14]&=65535,q(d,F,1-ae)}for(let R=0;R<16;R++)z[2*R]=d[R]&255,z[2*R+1]=d[R]>>8}function ie(z,B){let F=0;for(let d=0;d<32;d++)F|=z[d]^B[d];return(1&F-1>>>8)-1}function $(z,B){const F=new Uint8Array(32),d=new Uint8Array(32);return H(F,z),H(d,B),ie(F,d)}function j(z){const B=new Uint8Array(32);return H(B,z),B[0]&1}function C(z,B){for(let F=0;F<16;F++)z[F]=B[2*F]+(B[2*F+1]<<8);z[15]&=32767}function T(z,B,F){for(let d=0;d<16;d++)z[d]=B[d]+F[d]}function E(z,B,F){for(let d=0;d<16;d++)z[d]=B[d]-F[d]}function u(z,B,F){let d,R,ae=0,fe=0,Ie=0,ze=0,ke=0,Le=0,pt=0,gt=0,Me=0,xe=0,Ne=0,$e=0,qe=0,Pe=0,Fe=0,Se=0,Ce=0,He=0,Oe=0,Ve=0,We=0,et=0,tt=0,Qe=0,tr=0,fr=0,Jr=0,rr=0,si=0,Ii=0,Bi=0,Dt=F[0],yt=F[1],St=F[2],It=F[3],bt=F[4],vt=F[5],Ft=F[6],Ut=F[7],xt=F[8],Lt=F[9],Ot=F[10],At=F[11],Pt=F[12],ht=F[13],jt=F[14],Mt=F[15];d=B[0],ae+=d*Dt,fe+=d*yt,Ie+=d*St,ze+=d*It,ke+=d*bt,Le+=d*vt,pt+=d*Ft,gt+=d*Ut,Me+=d*xt,xe+=d*Lt,Ne+=d*Ot,$e+=d*At,qe+=d*Pt,Pe+=d*ht,Fe+=d*jt,Se+=d*Mt,d=B[1],fe+=d*Dt,Ie+=d*yt,ze+=d*St,ke+=d*It,Le+=d*bt,pt+=d*vt,gt+=d*Ft,Me+=d*Ut,xe+=d*xt,Ne+=d*Lt,$e+=d*Ot,qe+=d*At,Pe+=d*Pt,Fe+=d*ht,Se+=d*jt,Ce+=d*Mt,d=B[2],Ie+=d*Dt,ze+=d*yt,ke+=d*St,Le+=d*It,pt+=d*bt,gt+=d*vt,Me+=d*Ft,xe+=d*Ut,Ne+=d*xt,$e+=d*Lt,qe+=d*Ot,Pe+=d*At,Fe+=d*Pt,Se+=d*ht,Ce+=d*jt,He+=d*Mt,d=B[3],ze+=d*Dt,ke+=d*yt,Le+=d*St,pt+=d*It,gt+=d*bt,Me+=d*vt,xe+=d*Ft,Ne+=d*Ut,$e+=d*xt,qe+=d*Lt,Pe+=d*Ot,Fe+=d*At,Se+=d*Pt,Ce+=d*ht,He+=d*jt,Oe+=d*Mt,d=B[4],ke+=d*Dt,Le+=d*yt,pt+=d*St,gt+=d*It,Me+=d*bt,xe+=d*vt,Ne+=d*Ft,$e+=d*Ut,qe+=d*xt,Pe+=d*Lt,Fe+=d*Ot,Se+=d*At,Ce+=d*Pt,He+=d*ht,Oe+=d*jt,Ve+=d*Mt,d=B[5],Le+=d*Dt,pt+=d*yt,gt+=d*St,Me+=d*It,xe+=d*bt,Ne+=d*vt,$e+=d*Ft,qe+=d*Ut,Pe+=d*xt,Fe+=d*Lt,Se+=d*Ot,Ce+=d*At,He+=d*Pt,Oe+=d*ht,Ve+=d*jt,We+=d*Mt,d=B[6],pt+=d*Dt,gt+=d*yt,Me+=d*St,xe+=d*It,Ne+=d*bt,$e+=d*vt,qe+=d*Ft,Pe+=d*Ut,Fe+=d*xt,Se+=d*Lt,Ce+=d*Ot,He+=d*At,Oe+=d*Pt,Ve+=d*ht,We+=d*jt,et+=d*Mt,d=B[7],gt+=d*Dt,Me+=d*yt,xe+=d*St,Ne+=d*It,$e+=d*bt,qe+=d*vt,Pe+=d*Ft,Fe+=d*Ut,Se+=d*xt,Ce+=d*Lt,He+=d*Ot,Oe+=d*At,Ve+=d*Pt,We+=d*ht,et+=d*jt,tt+=d*Mt,d=B[8],Me+=d*Dt,xe+=d*yt,Ne+=d*St,$e+=d*It,qe+=d*bt,Pe+=d*vt,Fe+=d*Ft,Se+=d*Ut,Ce+=d*xt,He+=d*Lt,Oe+=d*Ot,Ve+=d*At,We+=d*Pt,et+=d*ht,tt+=d*jt,Qe+=d*Mt,d=B[9],xe+=d*Dt,Ne+=d*yt,$e+=d*St,qe+=d*It,Pe+=d*bt,Fe+=d*vt,Se+=d*Ft,Ce+=d*Ut,He+=d*xt,Oe+=d*Lt,Ve+=d*Ot,We+=d*At,et+=d*Pt,tt+=d*ht,Qe+=d*jt,tr+=d*Mt,d=B[10],Ne+=d*Dt,$e+=d*yt,qe+=d*St,Pe+=d*It,Fe+=d*bt,Se+=d*vt,Ce+=d*Ft,He+=d*Ut,Oe+=d*xt,Ve+=d*Lt,We+=d*Ot,et+=d*At,tt+=d*Pt,Qe+=d*ht,tr+=d*jt,fr+=d*Mt,d=B[11],$e+=d*Dt,qe+=d*yt,Pe+=d*St,Fe+=d*It,Se+=d*bt,Ce+=d*vt,He+=d*Ft,Oe+=d*Ut,Ve+=d*xt,We+=d*Lt,et+=d*Ot,tt+=d*At,Qe+=d*Pt,tr+=d*ht,fr+=d*jt,Jr+=d*Mt,d=B[12],qe+=d*Dt,Pe+=d*yt,Fe+=d*St,Se+=d*It,Ce+=d*bt,He+=d*vt,Oe+=d*Ft,Ve+=d*Ut,We+=d*xt,et+=d*Lt,tt+=d*Ot,Qe+=d*At,tr+=d*Pt,fr+=d*ht,Jr+=d*jt,rr+=d*Mt,d=B[13],Pe+=d*Dt,Fe+=d*yt,Se+=d*St,Ce+=d*It,He+=d*bt,Oe+=d*vt,Ve+=d*Ft,We+=d*Ut,et+=d*xt,tt+=d*Lt,Qe+=d*Ot,tr+=d*At,fr+=d*Pt,Jr+=d*ht,rr+=d*jt,si+=d*Mt,d=B[14],Fe+=d*Dt,Se+=d*yt,Ce+=d*St,He+=d*It,Oe+=d*bt,Ve+=d*vt,We+=d*Ft,et+=d*Ut,tt+=d*xt,Qe+=d*Lt,tr+=d*Ot,fr+=d*At,Jr+=d*Pt,rr+=d*ht,si+=d*jt,Ii+=d*Mt,d=B[15],Se+=d*Dt,Ce+=d*yt,He+=d*St,Oe+=d*It,Ve+=d*bt,We+=d*vt,et+=d*Ft,tt+=d*Ut,Qe+=d*xt,tr+=d*Lt,fr+=d*Ot,Jr+=d*At,rr+=d*Pt,si+=d*ht,Ii+=d*jt,Bi+=d*Mt,ae+=38*Ce,fe+=38*He,Ie+=38*Oe,ze+=38*Ve,ke+=38*We,Le+=38*et,pt+=38*tt,gt+=38*Qe,Me+=38*tr,xe+=38*fr,Ne+=38*Jr,$e+=38*rr,qe+=38*si,Pe+=38*Ii,Fe+=38*Bi,R=1,d=ae+R+65535,R=Math.floor(d/65536),ae=d-R*65536,d=fe+R+65535,R=Math.floor(d/65536),fe=d-R*65536,d=Ie+R+65535,R=Math.floor(d/65536),Ie=d-R*65536,d=ze+R+65535,R=Math.floor(d/65536),ze=d-R*65536,d=ke+R+65535,R=Math.floor(d/65536),ke=d-R*65536,d=Le+R+65535,R=Math.floor(d/65536),Le=d-R*65536,d=pt+R+65535,R=Math.floor(d/65536),pt=d-R*65536,d=gt+R+65535,R=Math.floor(d/65536),gt=d-R*65536,d=Me+R+65535,R=Math.floor(d/65536),Me=d-R*65536,d=xe+R+65535,R=Math.floor(d/65536),xe=d-R*65536,d=Ne+R+65535,R=Math.floor(d/65536),Ne=d-R*65536,d=$e+R+65535,R=Math.floor(d/65536),$e=d-R*65536,d=qe+R+65535,R=Math.floor(d/65536),qe=d-R*65536,d=Pe+R+65535,R=Math.floor(d/65536),Pe=d-R*65536,d=Fe+R+65535,R=Math.floor(d/65536),Fe=d-R*65536,d=Se+R+65535,R=Math.floor(d/65536),Se=d-R*65536,ae+=R-1+37*(R-1),R=1,d=ae+R+65535,R=Math.floor(d/65536),ae=d-R*65536,d=fe+R+65535,R=Math.floor(d/65536),fe=d-R*65536,d=Ie+R+65535,R=Math.floor(d/65536),Ie=d-R*65536,d=ze+R+65535,R=Math.floor(d/65536),ze=d-R*65536,d=ke+R+65535,R=Math.floor(d/65536),ke=d-R*65536,d=Le+R+65535,R=Math.floor(d/65536),Le=d-R*65536,d=pt+R+65535,R=Math.floor(d/65536),pt=d-R*65536,d=gt+R+65535,R=Math.floor(d/65536),gt=d-R*65536,d=Me+R+65535,R=Math.floor(d/65536),Me=d-R*65536,d=xe+R+65535,R=Math.floor(d/65536),xe=d-R*65536,d=Ne+R+65535,R=Math.floor(d/65536),Ne=d-R*65536,d=$e+R+65535,R=Math.floor(d/65536),$e=d-R*65536,d=qe+R+65535,R=Math.floor(d/65536),qe=d-R*65536,d=Pe+R+65535,R=Math.floor(d/65536),Pe=d-R*65536,d=Fe+R+65535,R=Math.floor(d/65536),Fe=d-R*65536,d=Se+R+65535,R=Math.floor(d/65536),Se=d-R*65536,ae+=R-1+37*(R-1),z[0]=ae,z[1]=fe,z[2]=Ie,z[3]=ze,z[4]=ke,z[5]=Le,z[6]=pt,z[7]=gt,z[8]=Me,z[9]=xe,z[10]=Ne,z[11]=$e,z[12]=qe,z[13]=Pe,z[14]=Fe,z[15]=Se}function w(z,B){u(z,B,B)}function G(z,B){const F=o();let d;for(d=0;d<16;d++)F[d]=B[d];for(d=253;d>=0;d--)w(F,F),d!==2&&d!==4&&u(F,F,B);for(d=0;d<16;d++)z[d]=F[d]}function W(z,B){const F=o();let d;for(d=0;d<16;d++)F[d]=B[d];for(d=250;d>=0;d--)w(F,F),d!==1&&u(F,F,B);for(d=0;d<16;d++)z[d]=F[d]}function se(z,B){const F=o(),d=o(),R=o(),ae=o(),fe=o(),Ie=o(),ze=o(),ke=o(),Le=o();E(F,z[1],z[0]),E(Le,B[1],B[0]),u(F,F,Le),T(d,z[0],z[1]),T(Le,B[0],B[1]),u(d,d,Le),u(R,z[3],B[3]),u(R,R,p),u(ae,z[2],B[2]),T(ae,ae,ae),E(fe,d,F),E(Ie,ae,R),T(ze,ae,R),T(ke,d,F),u(z[0],fe,Ie),u(z[1],ke,ze),u(z[2],ze,Ie),u(z[3],fe,ke)}function ue(z,B,F){for(let d=0;d<4;d++)q(z[d],B[d],F)}function de(z,B){const F=o(),d=o(),R=o();G(R,B[2]),u(F,B[0],R),u(d,B[1],R),H(z,d),z[31]^=j(F)<<7}function b(z,B,F){x(z[0],l),x(z[1],f),x(z[2],f),x(z[3],l);for(let d=255;d>=0;--d){const R=F[d/8|0]>>(d&7)&1;ue(z,B,R),se(B,z),se(z,z),ue(z,B,R)}}function A(z,B){const F=[o(),o(),o(),o()];x(F[0],v),x(F[1],D),x(F[2],f),u(F[3],v,D),b(z,F,B)}function ee(z){if(z.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const B=(0,t.hash)(z);B[0]&=248,B[31]&=127,B[31]|=64;const F=new Uint8Array(32),d=[o(),o(),o(),o()];A(d,B),de(F,d);const R=new Uint8Array(64);return R.set(z),R.set(F,32),{publicKey:F,secretKey:R}}i.generateKeyPairFromSeed=ee;function Q(z){const B=(0,e.randomBytes)(32,z),F=ee(B);return(0,s.wipe)(B),F}i.generateKeyPair=Q;function k(z){if(z.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(z.subarray(32))}i.extractPublicKeyFromSecretKey=k;const V=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(z,B){let F,d,R,ae;for(d=63;d>=32;--d){for(F=0,R=d-32,ae=d-12;R<ae;++R)B[R]+=F-16*B[d]*V[R-(d-32)],F=Math.floor((B[R]+128)/256),B[R]-=F*256;B[R]+=F,B[d]=0}for(F=0,R=0;R<32;R++)B[R]+=F-(B[31]>>4)*V[R],F=B[R]>>8,B[R]&=255;for(R=0;R<32;R++)B[R]-=F*V[R];for(d=0;d<32;d++)B[d+1]+=B[d]>>8,z[d]=B[d]&255}function re(z){const B=new Float64Array(64);for(let F=0;F<64;F++)B[F]=z[F];for(let F=0;F<64;F++)z[F]=0;J(z,B)}function we(z,B){const F=new Float64Array(64),d=[o(),o(),o(),o()],R=(0,t.hash)(z.subarray(0,32));R[0]&=248,R[31]&=127,R[31]|=64;const ae=new Uint8Array(64);ae.set(R.subarray(32),32);const fe=new t.SHA512;fe.update(ae.subarray(32)),fe.update(B);const Ie=fe.digest();fe.clean(),re(Ie),A(d,Ie),de(ae,d),fe.reset(),fe.update(ae.subarray(0,32)),fe.update(z.subarray(32)),fe.update(B);const ze=fe.digest();re(ze);for(let ke=0;ke<32;ke++)F[ke]=Ie[ke];for(let ke=0;ke<32;ke++)for(let Le=0;Le<32;Le++)F[ke+Le]+=ze[ke]*R[Le];return J(ae.subarray(32),F),ae}i.sign=we;function oe(z,B){const F=o(),d=o(),R=o(),ae=o(),fe=o(),Ie=o(),ze=o();return x(z[2],f),C(z[1],B),w(R,z[1]),u(ae,R,g),E(R,R,z[2]),T(ae,z[2],ae),w(fe,ae),w(Ie,fe),u(ze,Ie,fe),u(F,ze,R),u(F,F,ae),W(F,F),u(F,F,R),u(F,F,ae),u(F,F,ae),u(z[0],F,ae),w(d,z[0]),u(d,d,ae),$(d,R)&&u(z[0],z[0],S),w(d,z[0]),u(d,d,ae),$(d,R)?-1:(j(z[0])===B[31]>>7&&E(z[0],l,z[0]),u(z[3],z[0],z[1]),0)}function be(z,B,F){const d=new Uint8Array(32),R=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if(F.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(oe(ae,z))return!1;const fe=new t.SHA512;fe.update(F.subarray(0,32)),fe.update(z),fe.update(B);const Ie=fe.digest();return re(Ie),b(R,ae,Ie),A(ae,F.subarray(32)),se(R,ae),de(d,R),!ie(F,d)}i.verify=be;function le(z){let B=[o(),o(),o(),o()];if(oe(B,z))throw new Error("Ed25519: invalid public key");let F=o(),d=o(),R=B[1];T(F,f,R),E(d,f,R),G(d,d),u(F,F,d);let ae=new Uint8Array(32);return H(ae,F),ae}i.convertPublicKeyToX25519=le;function _e(z){const B=(0,t.hash)(z.subarray(0,32));B[0]&=248,B[31]&=127,B[31]|=64;const F=new Uint8Array(B.subarray(0,32));return(0,s.wipe)(B),F}i.convertSecretKeyToX25519=_e})(eh);const L6="EdDSA",j6="JWT",Np=".",$p="base64url",M6="utf8",q6="utf8",B6=":",z6="did",H6="key",rd="base58btc",K6="z",k6="K36",V6=32;function ea(i){return lr(wr(an(i),M6),$p)}function Fp(i){const e=wr(k6,rd),t=K6+lr(gu([e,i]),rd);return[z6,H6,t].join(B6)}function G6(i){return lr(i,$p)}function W6(i){return wr([ea(i.header),ea(i.payload)].join(Np),q6)}function Y6(i){return[ea(i.header),ea(i.payload),G6(i.signature)].join(Np)}function id(i=qn.randomBytes(V6)){return eh.generateKeyPairFromSeed(i)}async function J6(i,e,t,s,o=ve.fromMiliseconds(Date.now())){const c={alg:L6,typ:j6},l=Fp(s.publicKey),f=o+t,g={iss:l,sub:i,aud:e,iat:o,exp:f},p=W6({header:c,payload:g}),v=eh.sign(s.secretKey,p);return Y6({header:c,payload:g,signature:v})}const Q6="PARSE_ERROR",X6="INVALID_REQUEST",Z6="METHOD_NOT_FOUND",e2="INVALID_PARAMS",Up="INTERNAL_ERROR",th="SERVER_ERROR",t2=[-32700,-32600,-32601,-32602,-32603],bs={[Q6]:{code:-32700,message:"Parse error"},[X6]:{code:-32600,message:"Invalid Request"},[Z6]:{code:-32601,message:"Method not found"},[e2]:{code:-32602,message:"Invalid params"},[Up]:{code:-32603,message:"Internal error"},[th]:{code:-32e3,message:"Server error"}},Lp=th;function r2(i){return t2.includes(i)}function nd(i){return Object.keys(bs).includes(i)?bs[i]:bs[Lp]}function i2(i){const e=Object.values(bs).find(t=>t.code===i);return e||bs[Lp]}function jp(i,e,t){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):i}var Mp={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Tu=function(i,e){return Tu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Tu(i,e)};function n2(i,e){Tu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ru=function(){return Ru=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Ru.apply(this,arguments)};function s2(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function o2(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function a2(i,e){return function(t,s){e(t,s,i)}}function c2(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function u2(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(D){l(D)}}function g(v){try{p(s.throw(v))}catch(D){l(D)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function h2(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function l2(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function f2(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Nu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-->0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function d2(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(qp(arguments[e]));return i}function p2(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ps(i){return this instanceof Ps?(this.v=i,this):new Ps(i)}function g2(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(x){return new Promise(function(O,q){c.push([S,x,O,q])>1||f(S,x)})})}function f(S,x){try{g(s[S](x))}catch(O){D(c[0][3],O)}}function g(S){S.value instanceof Ps?Promise.resolve(S.value.v).then(p,v):D(c[0][2],S)}function p(S){f("next",S)}function v(S){f("throw",S)}function D(S,x){S(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function y2(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Ps(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function v2(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Nu=="function"?Nu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function _2(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function m2(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function w2(i){return i&&i.__esModule?i:{default:i}}function b2(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function E2(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const D2=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ru},__asyncDelegator:y2,__asyncGenerator:g2,__asyncValues:v2,__await:Ps,__awaiter:u2,__classPrivateFieldGet:b2,__classPrivateFieldSet:E2,__createBinding:l2,__decorate:o2,__exportStar:f2,__extends:n2,__generator:h2,__importDefault:w2,__importStar:m2,__makeTemplateObject:_2,__metadata:c2,__param:a2,__read:qp,__rest:s2,__spread:d2,__spreadArrays:p2,__values:Nu},Symbol.toStringTag,{value:"Module"})),S2=Mn(D2);var vi={},sd;function I2(){if(sd)return vi;sd=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.isBrowserCryptoAvailable=vi.getSubtleCrypto=vi.getBrowerCrypto=void 0;function i(){return(Yr===null||Yr===void 0?void 0:Yr.crypto)||(Yr===null||Yr===void 0?void 0:Yr.msCrypto)||{}}vi.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}vi.getSubtleCrypto=e;function t(){return!!i()&&!!e()}return vi.isBrowserCryptoAvailable=t,vi}var _i={},od;function x2(){if(od)return _i;od=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.isBrowser=_i.isNode=_i.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}_i.isReactNative=i;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}_i.isNode=e;function t(){return!i()&&!e()}return _i.isBrowser=t,_i}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=S2;e.__exportStar(I2(),i),e.__exportStar(x2(),i)})(Mp);function rh(i=3){const e=Date.now()*Math.pow(10,i),t=Math.floor(Math.random()*Math.pow(10,i));return e+t}function Bp(i=6){return BigInt(rh(i))}function jn(i,e,t){return{id:t||rh(),jsonrpc:"2.0",method:i,params:e}}function fa(i,e){return{id:i,jsonrpc:"2.0",result:e}}function da(i,e,t){return{id:i,jsonrpc:"2.0",error:O2(e,t)}}function O2(i,e){return typeof i>"u"?nd(Up):(typeof i=="string"&&(i=Object.assign(Object.assign({},nd(th)),{message:i})),typeof e<"u"&&(i.data=e),r2(i.code)&&(i=i2(i.code)),i)}class P2{}class C2 extends P2{constructor(){super()}}class A2 extends C2{constructor(e){super()}}const T2="^https?:",R2="^wss?:";function N2(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function zp(i,e){const t=N2(i);return typeof t>"u"?!1:new RegExp(e).test(t)}function ad(i){return zp(i,T2)}function cd(i){return zp(i,R2)}function $2(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function Hp(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function ih(i){return Hp(i)&&"method"in i}function pa(i){return Hp(i)&&(Ei(i)||Wr(i))}function Ei(i){return"result"in i}function Wr(i){return"error"in i}class Di extends A2{constructor(e){super(e),this.events=new qr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(jn(e.method,e.params||[],e.id||Bp().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Wr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),pa(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const F2=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),U2=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ud=i=>i.split("?")[0],hd=10,L2=F2();let j2=class{constructor(e){if(this.url=e,this.events=new qr.EventEmitter,this.registering=!1,!cd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(an(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!cd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=new URLSearchParams(e).get("origin"),c=Mp.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!$2(e)},l=new L2(e,[],c);U2()?l.onerror=f=>{const g=f;s(this.emitError(g.error))}:l.on("error",f=>{s(this.emitError(f))}),l.onopen=()=>{this.onOpen(l),t(l)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?$s(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=da(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return jp(e,ud(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>hd&&this.events.setMaxListeners(hd)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${ud(this.url)}`));return this.events.emit("register_error",t),t}};var ta={exports:{}};ta.exports;(function(i,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,l=9007199254740991,f="[object Arguments]",g="[object Array]",p="[object AsyncFunction]",v="[object Boolean]",D="[object Date]",S="[object Error]",x="[object Function]",O="[object GeneratorFunction]",q="[object Map]",H="[object Number]",ie="[object Null]",$="[object Object]",j="[object Promise]",C="[object Proxy]",T="[object RegExp]",E="[object Set]",u="[object String]",w="[object Symbol]",G="[object Undefined]",W="[object WeakMap]",se="[object ArrayBuffer]",ue="[object DataView]",de="[object Float32Array]",b="[object Float64Array]",A="[object Int8Array]",ee="[object Int16Array]",Q="[object Int32Array]",k="[object Uint8Array]",V="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",we=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,le={};le[de]=le[b]=le[A]=le[ee]=le[Q]=le[k]=le[V]=le[J]=le[re]=!0,le[f]=le[g]=le[se]=le[v]=le[ue]=le[D]=le[S]=le[x]=le[q]=le[H]=le[$]=le[T]=le[E]=le[u]=le[W]=!1;var _e=typeof Yr=="object"&&Yr&&Yr.Object===Object&&Yr,z=typeof self=="object"&&self&&self.Object===Object&&self,B=_e||z||Function("return this")(),F=e&&!e.nodeType&&e,d=F&&!0&&i&&!i.nodeType&&i,R=d&&d.exports===F,ae=R&&_e.process,fe=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function ze(I,U){for(var te=-1,pe=I==null?0:I.length,at=0,Te=[];++te<pe;){var ft=I[te];U(ft,te,I)&&(Te[at++]=ft)}return Te}function ke(I,U){for(var te=-1,pe=U.length,at=I.length;++te<pe;)I[at+te]=U[te];return I}function Le(I,U){for(var te=-1,pe=I==null?0:I.length;++te<pe;)if(U(I[te],te,I))return!0;return!1}function pt(I,U){for(var te=-1,pe=Array(I);++te<I;)pe[te]=U(te);return pe}function gt(I){return function(U){return I(U)}}function Me(I,U){return I.has(U)}function xe(I,U){return I==null?void 0:I[U]}function Ne(I){var U=-1,te=Array(I.size);return I.forEach(function(pe,at){te[++U]=[at,pe]}),te}function $e(I,U){return function(te){return I(U(te))}}function qe(I){var U=-1,te=Array(I.size);return I.forEach(function(pe){te[++U]=pe}),te}var Pe=Array.prototype,Fe=Function.prototype,Se=Object.prototype,Ce=B["__core-js_shared__"],He=Fe.toString,Oe=Se.hasOwnProperty,Ve=function(){var I=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||"");return I?"Symbol(src)_1."+I:""}(),We=Se.toString,et=RegExp("^"+He.call(Oe).replace(we,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=R?B.Buffer:void 0,Qe=B.Symbol,tr=B.Uint8Array,fr=Se.propertyIsEnumerable,Jr=Pe.splice,rr=Qe?Qe.toStringTag:void 0,si=Object.getOwnPropertySymbols,Ii=tt?tt.isBuffer:void 0,Bi=$e(Object.keys,Object),Dt=br(B,"DataView"),yt=br(B,"Map"),St=br(B,"Promise"),It=br(B,"Set"),bt=br(B,"WeakMap"),vt=br(Object,"create"),Ft=ai(Dt),Ut=ai(yt),xt=ai(St),Lt=ai(It),Ot=ai(bt),At=Qe?Qe.prototype:void 0,Pt=At?At.valueOf:void 0;function ht(I){var U=-1,te=I==null?0:I.length;for(this.clear();++U<te;){var pe=I[U];this.set(pe[0],pe[1])}}function jt(){this.__data__=vt?vt(null):{},this.size=0}function Mt(I){var U=this.has(I)&&delete this.__data__[I];return this.size-=U?1:0,U}function va(I){var U=this.__data__;if(vt){var te=U[I];return te===s?void 0:te}return Oe.call(U,I)?U[I]:void 0}function _a(I){var U=this.__data__;return vt?U[I]!==void 0:Oe.call(U,I)}function ma(I,U){var te=this.__data__;return this.size+=this.has(I)?0:1,te[I]=vt&&U===void 0?s:U,this}ht.prototype.clear=jt,ht.prototype.delete=Mt,ht.prototype.get=va,ht.prototype.has=_a,ht.prototype.set=ma;function Ar(I){var U=-1,te=I==null?0:I.length;for(this.clear();++U<te;){var pe=I[U];this.set(pe[0],pe[1])}}function wa(){this.__data__=[],this.size=0}function ba(I){var U=this.__data__,te=zi(U,I);if(te<0)return!1;var pe=U.length-1;return te==pe?U.pop():Jr.call(U,te,1),--this.size,!0}function Ea(I){var U=this.__data__,te=zi(U,I);return te<0?void 0:U[te][1]}function Da(I){return zi(this.__data__,I)>-1}function Sa(I,U){var te=this.__data__,pe=zi(te,I);return pe<0?(++this.size,te.push([I,U])):te[pe][1]=U,this}Ar.prototype.clear=wa,Ar.prototype.delete=ba,Ar.prototype.get=Ea,Ar.prototype.has=Da,Ar.prototype.set=Sa;function oi(I){var U=-1,te=I==null?0:I.length;for(this.clear();++U<te;){var pe=I[U];this.set(pe[0],pe[1])}}function dn(){this.size=0,this.__data__={hash:new ht,map:new(yt||Ar),string:new ht}}function Ia(I){var U=xi(this,I).delete(I);return this.size-=U?1:0,U}function pn(I){return xi(this,I).get(I)}function xa(I){return xi(this,I).has(I)}function Oa(I,U){var te=xi(this,I),pe=te.size;return te.set(I,U),this.size+=te.size==pe?0:1,this}oi.prototype.clear=dn,oi.prototype.delete=Ia,oi.prototype.get=pn,oi.prototype.has=xa,oi.prototype.set=Oa;function gn(I){var U=-1,te=I==null?0:I.length;for(this.__data__=new oi;++U<te;)this.add(I[U])}function Us(I){return this.__data__.set(I,s),this}function Ls(I){return this.__data__.has(I)}gn.prototype.add=gn.prototype.push=Us,gn.prototype.has=Ls;function Br(I){var U=this.__data__=new Ar(I);this.size=U.size}function Pa(){this.__data__=new Ar,this.size=0}function Ca(I){var U=this.__data__,te=U.delete(I);return this.size=U.size,te}function Aa(I){return this.__data__.get(I)}function Ta(I){return this.__data__.has(I)}function js(I,U){var te=this.__data__;if(te instanceof Ar){var pe=te.__data__;if(!yt||pe.length<t-1)return pe.push([I,U]),this.size=++te.size,this;te=this.__data__=new oi(pe)}return te.set(I,U),this.size=te.size,this}Br.prototype.clear=Pa,Br.prototype.delete=Ca,Br.prototype.get=Aa,Br.prototype.has=Ta,Br.prototype.set=js;function Ms(I,U){var te=_n(I),pe=!te&&Qs(I),at=!te&&!pe&&Wn(I),Te=!te&&!pe&&!at&&eo(I),ft=te||pe||at||Te,qt=ft?pt(I.length,String):[],Xe=qt.length;for(var ct in I)(U||Oe.call(I,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Te&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Vs(ct,Xe)))&&qt.push(ct);return qt}function zi(I,U){for(var te=I.length;te--;)if(Js(I[te][0],U))return te;return-1}function Vn(I,U,te){var pe=U(I);return _n(I)?pe:ke(pe,te(I))}function Hi(I){return I==null?I===void 0?G:ie:rr&&rr in Object(I)?Ks(I):$a(I)}function Gn(I){return ki(I)&&Hi(I)==f}function Ki(I,U,te,pe,at){return I===U?!0:I==null||U==null||!ki(I)&&!ki(U)?I!==I&&U!==U:qs(I,U,te,pe,Ki,at)}function qs(I,U,te,pe,at,Te){var ft=_n(I),qt=_n(U),Xe=ft?g:Qr(I),ct=qt?g:Qr(U);Xe=Xe==f?$:Xe,ct=ct==f?$:ct;var Tt=Xe==$,dr=ct==$,Bt=Xe==ct;if(Bt&&Wn(I)){if(!Wn(U))return!1;ft=!0,Tt=!1}if(Bt&&!Tt)return Te||(Te=new Br),ft||eo(I)?yn(I,U,te,pe,at,Te):Na(I,U,Xe,te,pe,at,Te);if(!(te&o)){var dt=Tt&&Oe.call(I,"__wrapped__"),ir=dr&&Oe.call(U,"__wrapped__");if(dt||ir){var zr=dt?I.value():I,Tr=ir?U.value():U;return Te||(Te=new Br),at(zr,Tr,te,pe,Te)}}return Bt?(Te||(Te=new Br),Hs(I,U,te,pe,at,Te)):!1}function Ra(I){if(!Zs(I)||Ws(I))return!1;var U=mn(I)?et:oe;return U.test(ai(I))}function Bs(I){return ki(I)&&Xs(I.length)&&!!le[Hi(I)]}function zs(I){if(!Ys(I))return Bi(I);var U=[];for(var te in Object(I))Oe.call(I,te)&&te!="constructor"&&U.push(te);return U}function yn(I,U,te,pe,at,Te){var ft=te&o,qt=I.length,Xe=U.length;if(qt!=Xe&&!(ft&&Xe>qt))return!1;var ct=Te.get(I);if(ct&&Te.get(U))return ct==U;var Tt=-1,dr=!0,Bt=te&c?new gn:void 0;for(Te.set(I,U),Te.set(U,I);++Tt<qt;){var dt=I[Tt],ir=U[Tt];if(pe)var zr=ft?pe(ir,dt,Tt,U,I,Te):pe(dt,ir,Tt,I,U,Te);if(zr!==void 0){if(zr)continue;dr=!1;break}if(Bt){if(!Le(U,function(Tr,Xr){if(!Me(Bt,Xr)&&(dt===Tr||at(dt,Tr,te,pe,Te)))return Bt.push(Xr)})){dr=!1;break}}else if(!(dt===ir||at(dt,ir,te,pe,Te))){dr=!1;break}}return Te.delete(I),Te.delete(U),dr}function Na(I,U,te,pe,at,Te,ft){switch(te){case ue:if(I.byteLength!=U.byteLength||I.byteOffset!=U.byteOffset)return!1;I=I.buffer,U=U.buffer;case se:return!(I.byteLength!=U.byteLength||!Te(new tr(I),new tr(U)));case v:case D:case H:return Js(+I,+U);case S:return I.name==U.name&&I.message==U.message;case T:case u:return I==U+"";case q:var qt=Ne;case E:var Xe=pe&o;if(qt||(qt=qe),I.size!=U.size&&!Xe)return!1;var ct=ft.get(I);if(ct)return ct==U;pe|=c,ft.set(I,U);var Tt=yn(qt(I),qt(U),pe,at,Te,ft);return ft.delete(I),Tt;case w:if(Pt)return Pt.call(I)==Pt.call(U)}return!1}function Hs(I,U,te,pe,at,Te){var ft=te&o,qt=vn(I),Xe=qt.length,ct=vn(U),Tt=ct.length;if(Xe!=Tt&&!ft)return!1;for(var dr=Xe;dr--;){var Bt=qt[dr];if(!(ft?Bt in U:Oe.call(U,Bt)))return!1}var dt=Te.get(I);if(dt&&Te.get(U))return dt==U;var ir=!0;Te.set(I,U),Te.set(U,I);for(var zr=ft;++dr<Xe;){Bt=qt[dr];var Tr=I[Bt],Xr=U[Bt];if(pe)var Yn=ft?pe(Xr,Tr,Bt,U,I,Te):pe(Tr,Xr,Bt,I,U,Te);if(!(Yn===void 0?Tr===Xr||at(Tr,Xr,te,pe,Te):Yn)){ir=!1;break}zr||(zr=Bt=="constructor")}if(ir&&!zr){var Vi=I.constructor,Kt=U.constructor;Vi!=Kt&&"constructor"in I&&"constructor"in U&&!(typeof Vi=="function"&&Vi instanceof Vi&&typeof Kt=="function"&&Kt instanceof Kt)&&(ir=!1)}return Te.delete(I),Te.delete(U),ir}function vn(I){return Vn(I,La,ks)}function xi(I,U){var te=I.__data__;return Gs(U)?te[typeof U=="string"?"string":"hash"]:te.map}function br(I,U){var te=xe(I,U);return Ra(te)?te:void 0}function Ks(I){var U=Oe.call(I,rr),te=I[rr];try{I[rr]=void 0;var pe=!0}catch{}var at=We.call(I);return pe&&(U?I[rr]=te:delete I[rr]),at}var ks=si?function(I){return I==null?[]:(I=Object(I),ze(si(I),function(U){return fr.call(I,U)}))}:ot,Qr=Hi;(Dt&&Qr(new Dt(new ArrayBuffer(1)))!=ue||yt&&Qr(new yt)!=q||St&&Qr(St.resolve())!=j||It&&Qr(new It)!=E||bt&&Qr(new bt)!=W)&&(Qr=function(I){var U=Hi(I),te=U==$?I.constructor:void 0,pe=te?ai(te):"";if(pe)switch(pe){case Ft:return ue;case Ut:return q;case xt:return j;case Lt:return E;case Ot:return W}return U});function Vs(I,U){return U=U??l,!!U&&(typeof I=="number"||be.test(I))&&I>-1&&I%1==0&&I<U}function Gs(I){var U=typeof I;return U=="string"||U=="number"||U=="symbol"||U=="boolean"?I!=="__proto__":I===null}function Ws(I){return!!Ve&&Ve in I}function Ys(I){var U=I&&I.constructor,te=typeof U=="function"&&U.prototype||Se;return I===te}function $a(I){return We.call(I)}function ai(I){if(I!=null){try{return He.call(I)}catch{}try{return I+""}catch{}}return""}function Js(I,U){return I===U||I!==I&&U!==U}var Qs=Gn(function(){return arguments}())?Gn:function(I){return ki(I)&&Oe.call(I,"callee")&&!fr.call(I,"callee")},_n=Array.isArray;function Fa(I){return I!=null&&Xs(I.length)&&!mn(I)}var Wn=Ii||st;function Ua(I,U){return Ki(I,U)}function mn(I){if(!Zs(I))return!1;var U=Hi(I);return U==x||U==O||U==p||U==C}function Xs(I){return typeof I=="number"&&I>-1&&I%1==0&&I<=l}function Zs(I){var U=typeof I;return I!=null&&(U=="object"||U=="function")}function ki(I){return I!=null&&typeof I=="object"}var eo=Ie?gt(Ie):Bs;function La(I){return Fa(I)?Ms(I):zs(I)}function ot(){return[]}function st(){return!1}i.exports=Ua})(ta,ta.exports);var M2=ta.exports;const q2=ia(M2);function B2(i,e){return e=e||{},new Promise(function(t,s){var o=new XMLHttpRequest,c=[],l=[],f={},g=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:g,headers:{keys:function(){return c},entries:function(){return l},get:function(v){return f[v.toLowerCase()]},has:function(v){return v.toLowerCase()in f}}}};for(var p in o.open(e.method||"get",i,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(v,D,S){c.push(D=D.toLowerCase()),l.push([D,S]),f[D]=f[D]?f[D]+","+S:S}),t(g())},o.onerror=s,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(p,e.headers[p]);o.send(e.body||null)})}const z2=Object.freeze(Object.defineProperty({__proto__:null,default:B2},Symbol.toStringTag,{value:"Module"})),ld=Mn(z2);var H2=self.fetch||(self.fetch=ld.default||ld);const K2=ia(H2);function k2(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var f=i.length,g=i.charAt(0),p=Math.log(f)/Math.log(256),v=Math.log(256)/Math.log(f);function D(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var q=0,H=0,ie=0,$=O.length;ie!==$&&O[ie]===0;)ie++,q++;for(var j=($-ie)*v+1>>>0,C=new Uint8Array(j);ie!==$;){for(var T=O[ie],E=0,u=j-1;(T!==0||E<H)&&u!==-1;u--,E++)T+=256*C[u]>>>0,C[u]=T%f>>>0,T=T/f>>>0;if(T!==0)throw new Error("Non-zero carry");H=E,ie++}for(var w=j-H;w!==j&&C[w]===0;)w++;for(var G=g.repeat(q);w<j;++w)G+=i.charAt(C[w]);return G}function S(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var q=0;if(O[q]!==" "){for(var H=0,ie=0;O[q]===g;)H++,q++;for(var $=(O.length-q)*p+1>>>0,j=new Uint8Array($);O[q];){var C=t[O.charCodeAt(q)];if(C===255)return;for(var T=0,E=$-1;(C!==0||T<ie)&&E!==-1;E--,T++)C+=f*j[E]>>>0,j[E]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");ie=T,q++}if(O[q]!==" "){for(var u=$-ie;u!==$&&j[u]===0;)u++;for(var w=new Uint8Array(H+($-u)),G=H;u!==$;)w[G++]=j[u++];return w}}}function x(O){var q=S(O);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:S,decode:x}}var V2=k2,G2=V2;const Kp=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},W2=i=>new TextEncoder().encode(i),Y2=i=>new TextDecoder().decode(i);class J2{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Q2{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return kp(this,e)}}class X2{constructor(e){this.decoders=e}or(e){return kp(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const kp=(i,e)=>new X2({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class Z2{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new J2(e,t,s),this.decoder=new Q2(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ga=({name:i,prefix:e,encode:t,decode:s})=>new Z2(i,e,t,s),Fs=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=G2(t,e);return ga({prefix:i,name:e,encode:s,decode:c=>Kp(o(c))})},eS=(i,e,t,s)=>{const o={};for(let v=0;v<e.length;++v)o[e[v]]=v;let c=i.length;for(;i[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let f=0,g=0,p=0;for(let v=0;v<c;++v){const D=o[i[v]];if(D===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<t|D,f+=t,f>=8&&(f-=8,l[p++]=255&g>>f)}if(f>=t||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return l},tS=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,f=0;for(let g=0;g<i.length;++g)for(f=f<<8|i[g],l+=8;l>t;)l-=t,c+=e[o&f>>l];if(l&&(c+=e[o&f<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Jt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>ga({prefix:e,name:i,encode(o){return tS(o,s,t)},decode(o){return eS(o,s,t,i)}}),rS=ga({prefix:"\0",name:"identity",encode:i=>Y2(i),decode:i=>W2(i)});var iS=Object.freeze({__proto__:null,identity:rS});const nS=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var sS=Object.freeze({__proto__:null,base2:nS});const oS=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var aS=Object.freeze({__proto__:null,base8:oS});const cS=Fs({prefix:"9",name:"base10",alphabet:"0123456789"});var uS=Object.freeze({__proto__:null,base10:cS});const hS=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),lS=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var fS=Object.freeze({__proto__:null,base16:hS,base16upper:lS});const dS=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),pS=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),gS=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),yS=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vS=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),_S=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),mS=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),wS=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),bS=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ES=Object.freeze({__proto__:null,base32:dS,base32upper:pS,base32pad:gS,base32padupper:yS,base32hex:vS,base32hexupper:_S,base32hexpad:mS,base32hexpadupper:wS,base32z:bS});const DS=Fs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),SS=Fs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var IS=Object.freeze({__proto__:null,base36:DS,base36upper:SS});const xS=Fs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),OS=Fs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var PS=Object.freeze({__proto__:null,base58btc:xS,base58flickr:OS});const CS=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),AS=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),TS=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),RS=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var NS=Object.freeze({__proto__:null,base64:CS,base64pad:AS,base64url:TS,base64urlpad:RS});const Vp=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),$S=Vp.reduce((i,e,t)=>(i[t]=e,i),[]),FS=Vp.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function US(i){return i.reduce((e,t)=>(e+=$S[t],e),"")}function LS(i){const e=[];for(const t of i){const s=FS[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const jS=ga({prefix:"ðŸš€",name:"base256emoji",encode:US,decode:LS});var MS=Object.freeze({__proto__:null,base256emoji:jS}),qS=Gp,fd=128,BS=127,zS=~BS,HS=Math.pow(2,31);function Gp(i,e,t){e=e||[],t=t||0;for(var s=t;i>=HS;)e[t++]=i&255|fd,i/=128;for(;i&zS;)e[t++]=i&255|fd,i>>>=7;return e[t]=i|0,Gp.bytes=t-s+1,e}var KS=$u,kS=128,dd=127;function $u(i,s){var t=0,s=s||0,o=0,c=s,l,f=i.length;do{if(c>=f)throw $u.bytes=0,new RangeError("Could not decode varint");l=i[c++],t+=o<28?(l&dd)<<o:(l&dd)*Math.pow(2,o),o+=7}while(l>=kS);return $u.bytes=c-s,t}var VS=Math.pow(2,7),GS=Math.pow(2,14),WS=Math.pow(2,21),YS=Math.pow(2,28),JS=Math.pow(2,35),QS=Math.pow(2,42),XS=Math.pow(2,49),ZS=Math.pow(2,56),eI=Math.pow(2,63),tI=function(i){return i<VS?1:i<GS?2:i<WS?3:i<YS?4:i<JS?5:i<QS?6:i<XS?7:i<ZS?8:i<eI?9:10},rI={encode:qS,decode:KS,encodingLength:tI},Wp=rI;const pd=(i,e,t=0)=>(Wp.encode(i,e,t),e),gd=i=>Wp.encodingLength(i),Fu=(i,e)=>{const t=e.byteLength,s=gd(i),o=s+gd(t),c=new Uint8Array(o+t);return pd(i,c,0),pd(t,c,s),c.set(e,o),new iI(i,t,e,c)};class iI{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Yp=({name:i,code:e,encode:t})=>new nI(i,e,t);class nI{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Fu(this.code,t):t.then(s=>Fu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Jp=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),sI=Yp({name:"sha2-256",code:18,encode:Jp("SHA-256")}),oI=Yp({name:"sha2-512",code:19,encode:Jp("SHA-512")});var aI=Object.freeze({__proto__:null,sha256:sI,sha512:oI});const Qp=0,cI="identity",Xp=Kp,uI=i=>Fu(Qp,Xp(i)),hI={code:Qp,name:cI,encode:Xp,digest:uI};var lI=Object.freeze({__proto__:null,identity:hI});new TextEncoder,new TextDecoder;const yd={...iS,...sS,...aS,...uS,...fS,...ES,...IS,...PS,...NS,...MS};({...aI,...lI});function Zp(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function fI(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Zp(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function eg(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const vd=eg("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),tu=eg("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=fI(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),dI={utf8:vd,"utf-8":vd,hex:yd.base16,latin1:tu,ascii:tu,binary:tu,...yd};function pI(i,e="utf8"){const t=dI[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Zp(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const tg="wc",gI=2,nh="core",Li=`${tg}@2:${nh}:`,yI={name:nh,logger:"error"},vI={database:":memory:"},_I="crypto",_d="client_ed25519_seed",mI=ve.ONE_DAY,wI="keychain",bI="0.3",EI="messages",DI="0.3",SI=ve.SIX_HOURS,II="publisher",rg="irn",xI="error",ig="wss://relay.walletconnect.com",md="wss://relay.walletconnect.org",OI="relayer",er={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},PI="_subscription",mi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},CI=ve.ONE_SECOND,AI="2.11.2",TI=1e4,RI="0.3",NI="WALLETCONNECT_CLIENT_ID",Gr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},$I="subscription",FI="0.3",UI=ve.FIVE_SECONDS*1e3,LI="pairing",jI="0.3",gs={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},ms={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ii={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},MI="history",qI="0.3",BI="expirer",Mr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},zI="0.3",ru="verify-api",Un="https://verify.walletconnect.com",Uu="https://verify.walletconnect.org",HI=[Un,Uu],KI="echo",kI="https://echo.walletconnect.com";class VI{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=wI,this.version=bI,this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ce("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,mp(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?wp(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class GI{constructor(e,t,s){this.core=e,this.logger=t,this.name=_I,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=id(o);return Fp(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=UE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),l=id(c),f=Eu();return await J6(f,o,mI,l)},this.generateSharedKey=(o,c,l)=>{this.isInitialized();const f=this.getPrivateKey(o),g=LE(f,c);return this.setSymKey(g,l)},this.setSymKey=async(o,c)=>{this.isInitialized();const l=c||jE(o);return await this.keychain.set(l,o),l},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,l)=>{this.isInitialized();const f=_p(l),g=an(c);if(Tf(f)){const S=f.senderPublicKey,x=f.receiverPublicKey;o=await this.generateSharedKey(S,x)}const p=this.getSymKey(o),{type:v,senderPublicKey:D}=f;return qE({type:v,symKey:p,message:g,senderPublicKey:D})},this.decode=async(o,c,l)=>{this.isInitialized();const f=HE(c,l);if(Tf(f)){const g=f.receiverPublicKey,p=f.senderPublicKey;o=await this.generateSharedKey(g,p)}try{const g=this.getSymKey(o),p=BE({symKey:g,encoded:c});return $s(p)}catch(g){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(g)}},this.getPayloadType=o=>{const c=Xo(o);return Ts(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Xo(o);return c.senderPublicKey?lr(c.senderPublicKey,hr):void 0},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.keychain=s||new VI(this.core,this.logger)}get context(){return Je.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(_d)}catch{e=Eu(),await this.keychain.set(_d,e)}return pI(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class WI extends O6{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=EI,this.version=DI,this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Ln(o);let l=this.messages.get(s);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=o,this.messages.set(s,l),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),l=Ln(o);return typeof c[l]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Je.generateChildLogger(e,this.name),this.core=t}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,mp(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?wp(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class YI extends P6{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new qr.EventEmitter,this.name=II,this.queue=new Map,this.publishTimeout=ve.toMiliseconds(ve.TEN_SECONDS*2),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||SI,g=Du(c),p=(c==null?void 0:c.prompt)||!1,v=(c==null?void 0:c.tag)||0,D=(c==null?void 0:c.id)||Bp().toString(),S={topic:s,message:o,opts:{ttl:f,relay:g,prompt:p,tag:v,id:D}},x=setTimeout(()=>this.queue.set(D,S),this.publishTimeout);try{await await Ss(this.rpcPublish(s,o,f,g,p,v,D),this.publishTimeout,`Failed to publish payload, please try again. id:${D} tag:${v}`),this.removeRequestFromQueue(D),this.relayer.events.emit(er.publish,S)}catch(O){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(D),O;return}finally{clearTimeout(x)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Je.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,l,f){var g,p,v,D;const S={method:Go(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:l},id:f};return ur((g=S.params)==null?void 0:g.prompt)&&((p=S.params)==null||delete p.prompt),ur((v=S.params)==null?void 0:v.tag)&&((D=S.params)==null||delete D.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:S}),this.relayer.request(S)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(kn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(er.connection_stalled);return}this.checkQueue()}),this.relayer.on(er.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class JI{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var QI=Object.defineProperty,XI=Object.defineProperties,ZI=Object.getOwnPropertyDescriptors,wd=Object.getOwnPropertySymbols,e5=Object.prototype.hasOwnProperty,t5=Object.prototype.propertyIsEnumerable,bd=(i,e,t)=>e in i?QI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ys=(i,e)=>{for(var t in e||(e={}))e5.call(e,t)&&bd(i,t,e[t]);if(wd)for(var t of wd(e))t5.call(e,t)&&bd(i,t,e[t]);return i},iu=(i,e)=>XI(i,ZI(e));class r5 extends T6{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new JI,this.events=new qr.EventEmitter,this.name=$I,this.version=FI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Li,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=Du(o),l={topic:s,relay:c};this.pending.set(s,l);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((c,l)=>{const f=new ve.Watch;f.start(o);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(o),c(!0)),f.elapsed(o)>=UI&&(clearInterval(g),f.stop(o),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.clientId=""}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=Du(s);await this.rpcUnsubscribe(e,t,o);const c=mt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Go(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Ss(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(er.connection_stalled)}return Ln(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Go(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Ss(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(er.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Go(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,iu(ys({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,ys({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,ys({},t)),this.topicMap.set(t.topic,e),this.events.emit(Gr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Gr.deleted,iu(ys({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Gr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Gr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);ni(t)&&this.onBatchSubscribe(t.map((s,o)=>iu(ys({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(kn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(er.connect,async()=>{await this.onConnect()}),this.relayer.on(er.disconnect,()=>{this.onDisconnect()}),this.events.on(Gr.created,async e=>{const t=Gr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Gr.deleted,async e=>{const t=Gr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var i5=Object.defineProperty,Ed=Object.getOwnPropertySymbols,n5=Object.prototype.hasOwnProperty,s5=Object.prototype.propertyIsEnumerable,Dd=(i,e,t)=>e in i?i5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,o5=(i,e)=>{for(var t in e||(e={}))n5.call(e,t)&&Dd(i,t,e[t]);if(Ed)for(var t of Ed(e))s5.call(e,t)&&Dd(i,t,e[t]);return i};class a5 extends C6{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new qr.EventEmitter,this.name=OI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.request=async t=>{this.logger.debug("Publishing Request Payload");const s=t.id;try{await this.toEstablishConnection();const o=this.provider.request(t);return this.requestsInFlight.set(s,{promise:o,request:t}),await o}catch(o){throw this.logger.debug("Failed to Publish Request"),this.logger.error(o),o}finally{this.requestsInFlight.delete(s)}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(er.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(er.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(mi.payload,this.onPayloadHandler),this.provider.on(mi.connect,this.onConnectHandler),this.provider.on(mi.disconnect,this.onDisconnectHandler),this.provider.on(mi.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Je.generateChildLogger(e.logger,this.name):Je.pino(Je.getDefaultLoggerOptions({level:e.logger||xI})),this.messages=new WI(this.logger,e.core),this.subscriber=new r5(this,this.logger),this.publisher=new YI(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||ig,this.projectId=e.projectId,this.bundleId=YE(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${md}...`),await this.restartTransport(md)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},TI)}get context(){return Je.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(o)return o;let c;const l=f=>{f.topic===e&&(this.subscriber.off(Gr.created,l),c())};return await Promise.all([new Promise(f=>{c=f,this.subscriber.on(Gr.created,l)}),new Promise(async f=>{o=await this.subscriber.subscribe(e,t),f()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.requestsInFlight.size>0&&(this.logger.debug("Waiting for all in-flight requests to finish before closing transport..."),this.requestsInFlight.forEach(async e=>{await e.promise})),this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Ss(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Gr.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await Ss(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(mi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await zf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Di(new j2(t3({sdkVersion:AI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),ih(e)){if(!e.method.endsWith(PI))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,l={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(o5({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(e),await this.onMessageEvent(l)}else pa(e)&&this.events.emit(er.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(er.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=fa(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(mi.payload,this.onPayloadHandler),this.provider.off(mi.connect,this.onConnectHandler),this.provider.off(mi.disconnect,this.onDisconnectHandler),this.provider.off(mi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(er.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await zf();Y3(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(er.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ve.toMiliseconds(CI)))}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var c5=Object.defineProperty,Sd=Object.getOwnPropertySymbols,u5=Object.prototype.hasOwnProperty,h5=Object.prototype.propertyIsEnumerable,Id=(i,e,t)=>e in i?c5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,xd=(i,e)=>{for(var t in e||(e={}))u5.call(e,t)&&Id(i,t,e[t]);if(Sd)for(var t of Sd(e))h5.call(e,t)&&Id(i,t,e[t]);return i};class ya extends A6{constructor(e,t,s,o=Li,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=RI,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!ur(l)?this.map.set(this.getKey(l),l):x3(l)?this.map.set(l.id,l):O3(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,f)=>{this.isInitialized(),this.map.has(l)?await this.update(l,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:f}),this.map.set(l,f),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(f=>Object.keys(l).every(g=>q2(f[g],l[g]))):this.values),this.update=async(l,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:f});const g=xd(xd({},this.getData(l)),f);this.map.set(l,g),await this.persist()},this.delete=async(l,f)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:f}),this.map.delete(l),await this.persist())},this.logger=Je.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class l5{constructor(e,t){this.core=e,this.logger=t,this.name=LI,this.version=jI,this.events=new Bu,this.initialized=!1,this.storagePrefix=Li,this.ignoredPayloadTypes=[un],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Eu(),o=await this.core.crypto.setSymKey(s),c=Or(ve.FIVE_MINUTES),l={protocol:rg},f={topic:o,expiry:c,relay:l,active:!1},g=v3({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:l,expiryTimestamp:c});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:g}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:l,expiryTimestamp:f}=Lf(s.uri);let g;if(this.pairings.keys.includes(o)&&(g=this.pairings.get(o),g.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const p=f||Or(ve.FIVE_MINUTES),v={topic:o,relay:l,expiry:p,active:!1};return await this.pairings.set(o,v),this.core.expirer.set(o,p),s.activatePairing&&await this.activate({topic:o}),this.events.emit(ms.create,v),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:l})),v},this.activate=async({topic:s})=>{this.isInitialized();const o=Or(ve.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:f,reject:g}=Fn();this.events.once($t("pairing_ping",c),({error:p})=>{p?g(p):f()}),await l()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",mt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const l=jn(o,c),f=await this.core.crypto.encode(s,l),g=gs[o].req;return this.core.history.set(s,l),this.core.relayer.publish(s,f,g),l.id},this.sendResult=async(s,o,c)=>{const l=fa(s,c),f=await this.core.crypto.encode(o,l),g=await this.core.history.get(o,s),p=gs[g.request.method].res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.sendError=async(s,o,c)=>{const l=da(s,c),f=await this.core.crypto.encode(o,l),g=await this.core.history.get(o,s),p=gs[g.request.method]?gs[g.request.method].res:gs.unregistered_method.res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,mt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ui(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,l=(await this.core.history.get(o,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(ms.ping,{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{Ei(o)?this.events.emit($t("pairing_ping",c),{}):Wr(o)&&this.events.emit($t("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(ms.delete,{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:l}=o;try{if(this.registeredMethods.includes(l))return;const f=mt("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(mt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!mr(s)){const{message:l}=ce("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(l)}if(!I3(s.uri)){const{message:l}=ce("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(l)}const c=Lf(s.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:l}=ce("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(l)}if(!(c!=null&&c.symKey)){const{message:l}=ce("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(l)}if(c!=null&&c.expiryTimestamp&&ve.toMiliseconds(c==null?void 0:c.expiryTimestamp)<Date.now()){const{message:l}=ce("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(l)}},this.isValidPing=async s=>{if(!mr(s)){const{message:c}=ce("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!mr(s)){const{message:c}=ce("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Gt(s,!1)){const{message:o}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ui(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ce("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.pairings=new ya(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Je.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(er.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{ih(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):pa(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Mr.expired,async e=>{const{topic:t}=Ep(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(ms.expire,{topic:t}))})}}class f5 extends x6{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new qr.EventEmitter,this.name=MI,this.version=qI,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const l={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Or(ve.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(ii.created,l)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Wr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ii.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(ii.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:jn(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ii.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ii.created,e=>{const t=ii.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ii.updated,e=>{const t=ii.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ii.deleted,e=>{const t=ii.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(kn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ve.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class d5 extends R6{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new qr.EventEmitter,this.name=BI,this.version=zI,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),l={target:c,expiry:o};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Mr.created,{target:c,expiration:l})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Mr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return r3(e);if(typeof e=="number")return i3(e);const{message:t}=ce("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Mr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;ve.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Mr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(kn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Mr.created,e=>{const t=Mr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Mr.expired,e=>{const t=Mr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Mr.deleted,e=>{const t=Mr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class p5 extends N6{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=ru,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||zn()||!Hn())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Uu;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(l){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(l),c=await this.fetchAttestation(s.attestationId,Uu)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(ve.ONE_SECOND*2),l=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?await l.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(ru))return c();window.addEventListener("message",o);const l=document.createElement("iframe");l.id=ru,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,s=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",o),l("verify iframe load timeout")},ve.toMiliseconds(ve.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||Un;return HI.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${Un}`),o=Un),o},this.logger=Je.generateChildLogger(t,this.name),this.verifyUrl=Un,this.abortController=new AbortController,this.isDevEnv=Qu()&&{}.IS_VITEST}get context(){return Je.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(e))}}class g5 extends $6{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=KI,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:l,enableEncrypted:f=!1}=s,g=`${kI}/${this.projectId}/clients`;await K2(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:l,token:c,always_raw:f})})},this.logger=Je.generateChildLogger(t,this.context)}}var y5=Object.defineProperty,Od=Object.getOwnPropertySymbols,v5=Object.prototype.hasOwnProperty,_5=Object.prototype.propertyIsEnumerable,Pd=(i,e,t)=>e in i?y5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Cd=(i,e)=>{for(var t in e||(e={}))v5.call(e,t)&&Pd(i,t,e[t]);if(Od)for(var t of Od(e))_5.call(e,t)&&Pd(i,t,e[t]);return i};class sh extends I6{constructor(e){super(e),this.protocol=tg,this.version=gI,this.name=nh,this.events=new qr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||ig,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||yI.logger}));this.logger=Je.generateChildLogger(t,this.name),this.heartbeat=new kn.HeartBeat,this.crypto=new GI(this,this.logger,e==null?void 0:e.keychain),this.history=new f5(this,this.logger),this.expirer=new d5(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new CD(Cd(Cd({},vI),e==null?void 0:e.storageOptions)),this.relayer=new a5({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new l5(this,this.logger),this.verify=new p5(this.projectId||"",this.logger),this.echoClient=new g5(this.projectId||"",this.logger)}static async init(e){const t=new sh(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(NI,s),t}get context(){return Je.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const m5=sh,ng="wc",sg=2,og="client",oh=`${ng}@${sg}:${og}:`,nu={name:og,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Ad="WALLETCONNECT_DEEPLINK_CHOICE",w5="proposal",ag="Proposal expired",b5="session",Ko=ve.SEVEN_DAYS,E5="engine",wi={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},su={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},bi={idle:"IDLE",active:"ACTIVE"},D5="request",S5=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var I5=Object.defineProperty,x5=Object.defineProperties,O5=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,P5=Object.prototype.hasOwnProperty,C5=Object.prototype.propertyIsEnumerable,Rd=(i,e,t)=>e in i?I5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,cr=(i,e)=>{for(var t in e||(e={}))P5.call(e,t)&&Rd(i,t,e[t]);if(Td)for(var t of Td(e))C5.call(e,t)&&Rd(i,t,e[t]);return i},$n=(i,e)=>x5(i,O5(e));class A5 extends U6{constructor(e){super(e),this.name=E5,this.events=new Bu,this.initialized=!1,this.ignoredPayloadTypes=[un],this.requestQueue={state:bi.idle,queue:[]},this.sessionRequestQueue={state:bi.idle,queue:[]},this.requestQueueDelay=ve.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(wi)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=$n(cr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:f,relays:g}=s;let p=o,v,D=!1;if(p&&(D=this.client.core.pairing.pairings.get(p).active),!p||!D){const{topic:C,uri:T}=await this.client.core.pairing.create();p=C,v=T}const S=await this.client.core.crypto.generateKeyPair(),x=wi.wc_sessionPropose.req.ttl||ve.FIVE_MINUTES,O=Or(x),q=cr({requiredNamespaces:c,optionalNamespaces:l,relays:g??[{protocol:rg}],proposer:{publicKey:S,metadata:this.client.metadata},expiryTimestamp:O},f&&{sessionProperties:f}),{reject:H,resolve:ie,done:$}=Fn(x,ag);if(this.events.once($t("session_connect"),async({error:C,session:T})=>{if(C)H(C);else if(T){T.self.publicKey=S;const E=$n(cr({},T),{requiredNamespaces:q.requiredNamespaces,optionalNamespaces:q.optionalNamespaces});await this.client.session.set(T.topic,E),await this.setExpiry(T.topic,T.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:T.peer.metadata}),ie(E)}}),!p){const{message:C}=ce("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(C)}const j=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:q,throwOnFailedPublish:!0});return await this.setProposal(j,cr({id:j},q)),{uri:v,approval:$}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:l}=t,f=this.client.proposal.get(s);let{pairingTopic:g,proposer:p,requiredNamespaces:v,optionalNamespaces:D}=f;g=g||"";const S=await this.client.core.crypto.generateKeyPair(),x=p.publicKey,O=await this.client.core.crypto.generateSharedKey(S,x);g&&s&&(await this.client.core.pairing.updateMetadata({topic:g,metadata:p.metadata}),await this.sendResult({id:s,topic:g,result:{relay:{protocol:o??"irn"},responderPublicKey:S}}),await this.client.proposal.delete(s,mt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}));const q=cr({relay:{protocol:o??"irn"},namespaces:c,pairingTopic:g,controller:{publicKey:S,metadata:this.client.metadata},expiry:Or(Ko)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(O);const H=$n(cr({},q),{topic:O,requiredNamespaces:v,optionalNamespaces:D,pairingTopic:g,acknowledged:!1,self:q.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:S});await this.client.session.set(O,H);try{await this.sendRequest({topic:O,method:"wc_sessionSettle",params:q,throwOnFailedPublish:!0})}catch(ie){throw this.client.logger.error(ie),this.client.session.delete(O,mt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(O),ie}return await this.setExpiry(O,Or(Ko)),{topic:O,acknowledged:()=>new Promise(ie=>setTimeout(()=>ie(this.client.session.get(O)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,mt("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:l,resolve:f,reject:g}=Fn();return this.events.once($t("session_update",c),({error:p})=>{p?g(p):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:l}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:f}=Fn();return this.events.once($t("session_extend",o),({error:g})=>{g?f(g):l()}),await this.setExpiry(s,Or(Ko)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:l=wi.wc_sessionRequest.req.ttl}=t,f=rh(),{done:g,resolve:p,reject:v}=Fn(l,"Request expired. Please try again.");return this.events.once($t("session_request",f),({error:D,result:S})=>{D?v(D):p(S)}),await Promise.all([new Promise(async D=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:$n(cr({},o),{expiryTimestamp:Or(l)}),chainId:s},expiry:l,throwOnFailedPublish:!0}).catch(S=>v(S)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),D()}),new Promise(async D=>{const S=await s3(this.client.core.storage,Ad);n3({id:f,topic:c,wcDeepLink:S}),D()}),g()]).then(D=>D[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;Ei(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Wr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:f}=Fn();this.events.once($t("session_ping",o),({error:g})=>{g?f(g):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:mt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:o}=ce("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(o)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>D3(s,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var l,f;return((l=c.peerMetadata)==null?void 0:l.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async t=>{const{topic:s,expirerHasDeleted:o=!1,emitEvent:c=!0,id:l=0}=t,{self:f}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,mt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(f.publicKey)&&await this.client.core.crypto.deleteKeyPair(f.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),o||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Ad).catch(g=>this.client.logger.warn(g)),this.getPendingSessionRequests().forEach(g=>{g.topic===s&&this.deletePendingSessionRequest(g.id,mt("USER_DISCONNECTED"))}),c&&this.client.events.emit("session_delete",{id:l,topic:s})},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,mt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=bi.idle,this.client.events.emit("session_request_expire",{id:t}))},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,Or(wi.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async t=>{const{id:s,topic:o,params:c,verifyContext:l}=t,f=c.request.expiryTimestamp||Or(wi.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(s,{id:s,topic:o,params:c,verifyContext:l}),f&&this.client.core.expirer.set(s,f)},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:l,relayRpcId:f,clientRpcId:g,throwOnFailedPublish:p}=t,v=jn(o,c,g);if(Hn()&&S5.includes(o)){const x=Ln(JSON.stringify(v));this.client.core.verify.register({attestationId:x})}const D=await this.client.core.crypto.encode(s,v),S=wi[o].req;return l&&(S.ttl=l),f&&(S.id=f),this.client.core.history.set(s,v),p?(S.internal=$n(cr({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,D,S)):this.client.core.relayer.publish(s,D,S).catch(x=>this.client.logger.error(x)),v.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:l}=t,f=fa(s,c),g=await this.client.core.crypto.encode(o,f),p=await this.client.core.history.get(o,s),v=wi[p.request.method].res;l?(v.internal=$n(cr({},v.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,g,v)):this.client.core.relayer.publish(o,g,v).catch(D=>this.client.logger.error(D)),await this.client.core.history.resolve(f)},this.sendError=async(t,s,o)=>{const c=da(t,o),l=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),g=wi[f.request.method].res;this.client.core.relayer.publish(s,l,g),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{let c=!1;Ui(o.expiry)&&(c=!0),this.client.core.crypto.keychain.has(o.topic)||(c=!0),c&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ui(o.expiryTimestamp)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession({topic:o})),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===bi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=bi.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=bi.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ce("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(cr({},s.params));const l=o.expiryTimestamp||Or(wi.wc_sessionPropose.req.ttl),f=cr({id:c,pairingTopic:t,expiryTimestamp:l},o);await this.setProposal(c,f);const g=Ln(JSON.stringify(s)),p=await this.getVerifyContext(g,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:p})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(Ei(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const f=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const g=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:g});const p=await this.client.core.crypto.generateSharedKey(f,g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const v=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:v}),await this.client.core.pairing.activate({topic:t})}else Wr(s)&&(await this.client.proposal.delete(o,mt("USER_DISCONNECTED")),this.events.emit($t("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:f,expiry:g,namespaces:p,sessionProperties:v,pairingTopic:D}=s.params,S=cr({topic:t,relay:l,expiry:g,namespaces:p,acknowledged:!0,pairingTopic:D,requiredNamespaces:{},optionalNamespaces:{},controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},v&&{sessionProperties:v});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit($t("session_connect"),{session:S}),this.cleanupDuplicatePairings(S)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;Ei(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit($t("session_approve",o),{})):Wr(s)&&(await this.client.session.delete(t,mt("USER_DISCONNECTED")),this.events.emit($t("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const l=`${t}_session_update`,f=Bo.get(l);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(cr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),Bo.set(l,c)}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;Ei(s)?this.events.emit($t("session_update",o),{}):Wr(s)&&this.events.emit($t("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Or(Ko)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;Ei(s)?this.events.emit($t("session_extend",o),{}):Wr(s)&&this.events.emit($t("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{Ei(s)?this.events.emit($t("session_ping",o),{}):Wr(s)&&this.events.emit($t("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(er.publish,async()=>{c(await this.deleteSession({topic:t,id:o}))})}),this.sendResult({id:o,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:mt("USER_DISCONNECTED")})])}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(cr({topic:t},c));const l=Ln(JSON.stringify(jn("wc_sessionRequest",c,o))),f=this.client.session.get(t),g=await this.getVerifyContext(l,f.peer.metadata),p={id:o,topic:t,params:c,verifyContext:g};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;Ei(s)?this.events.emit($t("session_request",o),{result:s.result}):Wr(s)&&this.events.emit($t("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const l=`${t}_session_event_${c.event.name}`,f=Bo.get(l);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(cr({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),Bo.set(l,o)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=bi.idle,this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:s})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(c=>c.topic===t&&c.request.method==="wc_sessionRequest").forEach(c=>{this.events.emit($t("session_request",c.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===bi.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=bi.active,this.client.events.emit("session_request",t)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=t=>{if(t.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);s&&this.onSessionProposeRequest(t.topic,jn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async t=>{if(!mr(t)){const{message:g}=ce("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(g)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:l,relays:f}=t;if(ur(s)||await this.isValidPairingTopic(s),!F3(f,!0)){const{message:g}=ce("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(g)}!ur(o)&&Is(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!ur(c)&&Is(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),ur(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=$3(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!mr(t))throw new Error(ce("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),g=Gc(o,"approve()");if(g)throw new Error(g.message);const p=qf(f.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!Gt(c,!0)){const{message:v}=ce("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(v)}ur(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!mr(t)){const{message:c}=ce("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!L3(o)){const{message:c}=ce("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!mr(t)){const{message:p}=ce("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:s,controller:o,namespaces:c,expiry:l}=t;if(!Sp(s)){const{message:p}=ce("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const f=P3(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const g=Gc(c,"onSessionSettleRequest()");if(g)throw new Error(g.message);if(Ui(l)){const{message:p}=ce("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!mr(t)){const{message:g}=ce("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(g)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),l=Gc(o,"update()");if(l)throw new Error(l.message);const f=qf(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!mr(t)){const{message:o}=ce("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!mr(t)){const{message:g}=ce("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(g)}const{topic:s,request:o,chainId:c,expiry:l}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Mf(f,c)){const{message:g}=ce("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(g)}if(!j3(o)){const{message:g}=ce("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(g)}if(!B3(f,c,o.method)){const{message:g}=ce("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(g)}if(l&&!k3(l,su)){const{message:g}=ce("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${su.min} and ${su.max}`);throw new Error(g)}},this.isValidRespond=async t=>{var s;if(!mr(t)){const{message:l}=ce("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(l)}const{topic:o,response:c}=t;try{await this.isValidSessionTopic(o)}catch(l){throw(s=t==null?void 0:t.response)!=null&&s.id&&this.cleanupAfterResponse(t),l}if(!M3(c)){const{message:l}=ce("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(l)}},this.isValidPing=async t=>{if(!mr(t)){const{message:o}=ce("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!mr(t)){const{message:f}=ce("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!Mf(l,c)){const{message:f}=ce("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!q3(o)){const{message:f}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!z3(l,c,o.name)){const{message:f}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!mr(t)){const{message:o}=ce("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||Un,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Gt(o,!1)){const{message:c}=ce("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(er.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{ih(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):pa(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Mr.expired,async e=>{const{topic:t,id:s}=Ep(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ce("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(ms.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Gt(e,!1)){const{message:t}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ui(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ce("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Gt(e,!1)){const{message:t}=ce("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Ui(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=ce("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=ce("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Gt(e,!1)){const{message:t}=ce("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ce("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!U3(e)){const{message:t}=ce("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Ui(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=ce("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class T5 extends ya{constructor(e,t){super(e,t,w5,oh),this.core=e,this.logger=t}}let R5=class extends ya{constructor(e,t){super(e,t,b5,oh),this.core=e,this.logger=t}};class N5 extends ya{constructor(e,t){super(e,t,D5,oh,s=>s.id),this.core=e,this.logger=t}}let $5=class cg extends F6{constructor(e){super(e),this.protocol=ng,this.version=sg,this.name=nu.name,this.events=new qr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||nu.name,this.metadata=(e==null?void 0:e.metadata)||QE();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||nu.logger}));this.core=(e==null?void 0:e.core)||new m5(e),this.logger=Je.generateChildLogger(t,this.name),this.session=new R5(this.core,this.logger),this.proposal=new T5(this.core,this.logger),this.pendingRequest=new N5(this.core,this.logger),this.engine=new A5(this)}static async init(e){const t=new cg(e);return await t.initialize(),t}get context(){return Je.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Lu={exports:{}};(function(i,e){var t=typeof self<"u"?self:Yr,s=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(l){var f={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function g(b){return b&&DataView.prototype.isPrototypeOf(b)}if(f.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=ArrayBuffer.isView||function(b){return b&&p.indexOf(Object.prototype.toString.call(b))>-1};function D(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function S(b){return typeof b!="string"&&(b=String(b)),b}function x(b){var A={next:function(){var ee=b.shift();return{done:ee===void 0,value:ee}}};return f.iterable&&(A[Symbol.iterator]=function(){return A}),A}function O(b){this.map={},b instanceof O?b.forEach(function(A,ee){this.append(ee,A)},this):Array.isArray(b)?b.forEach(function(A){this.append(A[0],A[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(A){this.append(A,b[A])},this)}O.prototype.append=function(b,A){b=D(b),A=S(A);var ee=this.map[b];this.map[b]=ee?ee+", "+A:A},O.prototype.delete=function(b){delete this.map[D(b)]},O.prototype.get=function(b){return b=D(b),this.has(b)?this.map[b]:null},O.prototype.has=function(b){return this.map.hasOwnProperty(D(b))},O.prototype.set=function(b,A){this.map[D(b)]=S(A)},O.prototype.forEach=function(b,A){for(var ee in this.map)this.map.hasOwnProperty(ee)&&b.call(A,this.map[ee],ee,this)},O.prototype.keys=function(){var b=[];return this.forEach(function(A,ee){b.push(ee)}),x(b)},O.prototype.values=function(){var b=[];return this.forEach(function(A){b.push(A)}),x(b)},O.prototype.entries=function(){var b=[];return this.forEach(function(A,ee){b.push([ee,A])}),x(b)},f.iterable&&(O.prototype[Symbol.iterator]=O.prototype.entries);function q(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function H(b){return new Promise(function(A,ee){b.onload=function(){A(b.result)},b.onerror=function(){ee(b.error)}})}function ie(b){var A=new FileReader,ee=H(A);return A.readAsArrayBuffer(b),ee}function $(b){var A=new FileReader,ee=H(A);return A.readAsText(b),ee}function j(b){for(var A=new Uint8Array(b),ee=new Array(A.length),Q=0;Q<A.length;Q++)ee[Q]=String.fromCharCode(A[Q]);return ee.join("")}function C(b){if(b.slice)return b.slice(0);var A=new Uint8Array(b.byteLength);return A.set(new Uint8Array(b)),A.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(b){this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:f.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:f.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():f.arrayBuffer&&f.blob&&g(b)?(this._bodyArrayBuffer=C(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||v(b))?this._bodyArrayBuffer=C(b):this._bodyText=b=Object.prototype.toString.call(b):this._bodyText="",this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var b=q(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?q(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ie)}),this.text=function(){var b=q(this);if(b)return b;if(this._bodyBlob)return $(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(j(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(G)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function u(b){var A=b.toUpperCase();return E.indexOf(A)>-1?A:b}function w(b,A){A=A||{};var ee=A.body;if(b instanceof w){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,A.headers||(this.headers=new O(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!ee&&b._bodyInit!=null&&(ee=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=A.credentials||this.credentials||"same-origin",(A.headers||!this.headers)&&(this.headers=new O(A.headers)),this.method=u(A.method||this.method||"GET"),this.mode=A.mode||this.mode||null,this.signal=A.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})};function G(b){var A=new FormData;return b.trim().split("&").forEach(function(ee){if(ee){var Q=ee.split("="),k=Q.shift().replace(/\+/g," "),V=Q.join("=").replace(/\+/g," ");A.append(decodeURIComponent(k),decodeURIComponent(V))}}),A}function W(b){var A=new O,ee=b.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(Q){var k=Q.split(":"),V=k.shift().trim();if(V){var J=k.join(":").trim();A.append(V,J)}}),A}T.call(w.prototype);function se(b,A){A||(A={}),this.type="default",this.status=A.status===void 0?200:A.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in A?A.statusText:"OK",this.headers=new O(A.headers),this.url=A.url||"",this._initBody(b)}T.call(se.prototype),se.prototype.clone=function(){return new se(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new O(this.headers),url:this.url})},se.error=function(){var b=new se(null,{status:0,statusText:""});return b.type="error",b};var ue=[301,302,303,307,308];se.redirect=function(b,A){if(ue.indexOf(A)===-1)throw new RangeError("Invalid status code");return new se(null,{status:A,headers:{location:b}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(A,ee){this.message=A,this.name=ee;var Q=Error(A);this.stack=Q.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function de(b,A){return new Promise(function(ee,Q){var k=new w(b,A);if(k.signal&&k.signal.aborted)return Q(new l.DOMException("Aborted","AbortError"));var V=new XMLHttpRequest;function J(){V.abort()}V.onload=function(){var re={status:V.status,statusText:V.statusText,headers:W(V.getAllResponseHeaders()||"")};re.url="responseURL"in V?V.responseURL:re.headers.get("X-Request-URL");var we="response"in V?V.response:V.responseText;ee(new se(we,re))},V.onerror=function(){Q(new TypeError("Network request failed"))},V.ontimeout=function(){Q(new TypeError("Network request failed"))},V.onabort=function(){Q(new l.DOMException("Aborted","AbortError"))},V.open(k.method,k.url,!0),k.credentials==="include"?V.withCredentials=!0:k.credentials==="omit"&&(V.withCredentials=!1),"responseType"in V&&f.blob&&(V.responseType="blob"),k.headers.forEach(function(re,we){V.setRequestHeader(we,re)}),k.signal&&(k.signal.addEventListener("abort",J),V.onreadystatechange=function(){V.readyState===4&&k.signal.removeEventListener("abort",J)}),V.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return de.polyfill=!0,c.fetch||(c.fetch=de,c.Headers=O,c.Request=w,c.Response=se),l.Headers=O,l.Request=w,l.Response=se,l.fetch=de,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,i.exports=e})(Lu,Lu.exports);var F5=Lu.exports;const Nd=ia(F5),U5={Accept:"application/json","Content-Type":"application/json"},L5="POST",$d={headers:U5,method:L5},Fd=10;class qi{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new qr.EventEmitter,this.isAvailable=!1,this.registering=!1,!ad(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=an(e),c=await(await Nd(this.url,Object.assign(Object.assign({},$d),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!ad(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=an({id:1,jsonrpc:"2.0",method:"test",params:[]});await Nd(e,Object.assign(Object.assign({},$d),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?$s(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=da(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return jp(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Fd&&this.events.setMaxListeners(Fd)}}const Ud="error",j5="wss://relay.walletconnect.com",M5="wc",q5="universal_provider",Ld=`${M5}@2:${q5}:`,B5="https://rpc.walletconnect.com/v1/",Si={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var vs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ju={exports:{}};(function(i,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",f="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",p=500,v="__lodash_placeholder__",D=1,S=2,x=4,O=1,q=2,H=1,ie=2,$=4,j=8,C=16,T=32,E=64,u=128,w=256,G=512,W=30,se="...",ue=800,de=16,b=1,A=2,ee=3,Q=1/0,k=9007199254740991,V=17976931348623157e292,J=0/0,re=4294967295,we=re-1,oe=re>>>1,be=[["ary",u],["bind",H],["bindKey",ie],["curry",j],["curryRight",C],["flip",G],["partial",T],["partialRight",E],["rearg",w]],le="[object Arguments]",_e="[object Array]",z="[object AsyncFunction]",B="[object Boolean]",F="[object Date]",d="[object DOMException]",R="[object Error]",ae="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",ze="[object Number]",ke="[object Null]",Le="[object Object]",pt="[object Promise]",gt="[object Proxy]",Me="[object RegExp]",xe="[object Set]",Ne="[object String]",$e="[object Symbol]",qe="[object Undefined]",Pe="[object WeakMap]",Fe="[object WeakSet]",Se="[object ArrayBuffer]",Ce="[object DataView]",He="[object Float32Array]",Oe="[object Float64Array]",Ve="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Qe="[object Uint8ClampedArray]",tr="[object Uint16Array]",fr="[object Uint32Array]",Jr=/\b__p \+= '';/g,rr=/\b(__p \+=) '' \+/g,si=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ii=/&(?:amp|lt|gt|quot|#39);/g,Bi=/[&<>"']/g,Dt=RegExp(Ii.source),yt=RegExp(Bi.source),St=/<%-([\s\S]+?)%>/g,It=/<%([\s\S]+?)%>/g,bt=/<%=([\s\S]+?)%>/g,vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ft=/^\w*$/,Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xt=/[\\^$.*+?()[\]{}|]/g,Lt=RegExp(xt.source),Ot=/^\s+/,At=/\s/,Pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,jt=/,? & /,Mt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,va=/[()=,{}\[\]\/\s]/,_a=/\\(\\)?/g,ma=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ar=/\w*$/,wa=/^[-+]0x[0-9a-f]+$/i,ba=/^0b[01]+$/i,Ea=/^\[object .+?Constructor\]$/,Da=/^0o[0-7]+$/i,Sa=/^(?:0|[1-9]\d*)$/,oi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,dn=/($^)/,Ia=/['\n\r\u2028\u2029\\]/g,pn="\\ud800-\\udfff",xa="\\u0300-\\u036f",Oa="\\ufe20-\\ufe2f",gn="\\u20d0-\\u20ff",Us=xa+Oa+gn,Ls="\\u2700-\\u27bf",Br="a-z\\xdf-\\xf6\\xf8-\\xff",Pa="\\xac\\xb1\\xd7\\xf7",Ca="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Aa="\\u2000-\\u206f",Ta=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",js="A-Z\\xc0-\\xd6\\xd8-\\xde",Ms="\\ufe0e\\ufe0f",zi=Pa+Ca+Aa+Ta,Vn="['â€™]",Hi="["+pn+"]",Gn="["+zi+"]",Ki="["+Us+"]",qs="\\d+",Ra="["+Ls+"]",Bs="["+Br+"]",zs="[^"+pn+zi+qs+Ls+Br+js+"]",yn="\\ud83c[\\udffb-\\udfff]",Na="(?:"+Ki+"|"+yn+")",Hs="[^"+pn+"]",vn="(?:\\ud83c[\\udde6-\\uddff]){2}",xi="[\\ud800-\\udbff][\\udc00-\\udfff]",br="["+js+"]",Ks="\\u200d",ks="(?:"+Bs+"|"+zs+")",Qr="(?:"+br+"|"+zs+")",Vs="(?:"+Vn+"(?:d|ll|m|re|s|t|ve))?",Gs="(?:"+Vn+"(?:D|LL|M|RE|S|T|VE))?",Ws=Na+"?",Ys="["+Ms+"]?",$a="(?:"+Ks+"(?:"+[Hs,vn,xi].join("|")+")"+Ys+Ws+")*",ai="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Js="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Qs=Ys+Ws+$a,_n="(?:"+[Ra,vn,xi].join("|")+")"+Qs,Fa="(?:"+[Hs+Ki+"?",Ki,vn,xi,Hi].join("|")+")",Wn=RegExp(Vn,"g"),Ua=RegExp(Ki,"g"),mn=RegExp(yn+"(?="+yn+")|"+Fa+Qs,"g"),Xs=RegExp([br+"?"+Bs+"+"+Vs+"(?="+[Gn,br,"$"].join("|")+")",Qr+"+"+Gs+"(?="+[Gn,br+ks,"$"].join("|")+")",br+"?"+ks+"+"+Vs,br+"+"+Gs,Js,ai,qs,_n].join("|"),"g"),Zs=RegExp("["+Ks+pn+Us+Ms+"]"),ki=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],La=-1,ot={};ot[He]=ot[Oe]=ot[Ve]=ot[We]=ot[et]=ot[tt]=ot[Qe]=ot[tr]=ot[fr]=!0,ot[le]=ot[_e]=ot[Se]=ot[B]=ot[Ce]=ot[F]=ot[R]=ot[ae]=ot[Ie]=ot[ze]=ot[Le]=ot[Me]=ot[xe]=ot[Ne]=ot[Pe]=!1;var st={};st[le]=st[_e]=st[Se]=st[Ce]=st[B]=st[F]=st[He]=st[Oe]=st[Ve]=st[We]=st[et]=st[Ie]=st[ze]=st[Le]=st[Me]=st[xe]=st[Ne]=st[$e]=st[tt]=st[Qe]=st[tr]=st[fr]=!0,st[R]=st[ae]=st[Pe]=!1;var I={Ã€:"A",Ã:"A",Ã‚:"A",Ãƒ:"A",Ã„:"A",Ã…:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã‡:"C",Ã§:"c",Ã:"D",Ã°:"d",Ãˆ:"E",Ã‰:"E",ÃŠ:"E",Ã‹:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",ÃŒ:"I",Ã:"I",ÃŽ:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã‘:"N",Ã±:"n",Ã’:"O",Ã“:"O",Ã”:"O",Ã•:"O",Ã–:"O",Ã˜:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã™:"U",Ãš:"U",Ã›:"U",Ãœ:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã†:"Ae",Ã¦:"ae",Ãž:"Th",Ã¾:"th",ÃŸ:"ss",Ä€:"A",Ä‚:"A",Ä„:"A",Ä:"a",Äƒ:"a",Ä…:"a",Ä†:"C",Äˆ:"C",ÄŠ:"C",ÄŒ:"C",Ä‡:"c",Ä‰:"c",Ä‹:"c",Ä:"c",ÄŽ:"D",Ä:"D",Ä:"d",Ä‘:"d",Ä’:"E",Ä”:"E",Ä–:"E",Ä˜:"E",Äš:"E",Ä“:"e",Ä•:"e",Ä—:"e",Ä™:"e",Ä›:"e",Äœ:"G",Äž:"G",Ä :"G",Ä¢:"G",Ä:"g",ÄŸ:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å€:"l",Å‚:"l",Åƒ:"N",Å…:"N",Å‡:"N",ÅŠ:"N",Å„:"n",Å†:"n",Åˆ:"n",Å‹:"n",ÅŒ:"O",ÅŽ:"O",Å:"O",Å:"o",Å:"o",Å‘:"o",Å”:"R",Å–:"R",Å˜:"R",Å•:"r",Å—:"r",Å™:"r",Åš:"S",Åœ:"S",Åž:"S",Å :"S",Å›:"s",Å:"s",ÅŸ:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å’:"Oe",Å“:"oe",Å‰:"'n",Å¿:"s"},U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Te=parseInt,ft=typeof vs=="object"&&vs&&vs.Object===Object&&vs,qt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=ft||qt||Function("return this")(),ct=e&&!e.nodeType&&e,Tt=ct&&!0&&i&&!i.nodeType&&i,dr=Tt&&Tt.exports===ct,Bt=dr&&ft.process,dt=function(){try{var L=Tt&&Tt.require&&Tt.require("util").types;return L||Bt&&Bt.binding&&Bt.binding("util")}catch{}}(),ir=dt&&dt.isArrayBuffer,zr=dt&&dt.isDate,Tr=dt&&dt.isMap,Xr=dt&&dt.isRegExp,Yn=dt&&dt.isSet,Vi=dt&&dt.isTypedArray;function Kt(L,Y,K){switch(K.length){case 0:return L.call(Y);case 1:return L.call(Y,K[0]);case 2:return L.call(Y,K[0],K[1]);case 3:return L.call(Y,K[0],K[1],K[2])}return L.apply(Y,K)}function lg(L,Y,K,ge){for(var Ae=-1,rt=L==null?0:L.length;++Ae<rt;){var zt=L[Ae];Y(ge,zt,K(zt),L)}return ge}function Rr(L,Y){for(var K=-1,ge=L==null?0:L.length;++K<ge&&Y(L[K],K,L)!==!1;);return L}function fg(L,Y){for(var K=L==null?0:L.length;K--&&Y(L[K],K,L)!==!1;);return L}function uh(L,Y){for(var K=-1,ge=L==null?0:L.length;++K<ge;)if(!Y(L[K],K,L))return!1;return!0}function Oi(L,Y){for(var K=-1,ge=L==null?0:L.length,Ae=0,rt=[];++K<ge;){var zt=L[K];Y(zt,K,L)&&(rt[Ae++]=zt)}return rt}function to(L,Y){var K=L==null?0:L.length;return!!K&&wn(L,Y,0)>-1}function ja(L,Y,K){for(var ge=-1,Ae=L==null?0:L.length;++ge<Ae;)if(K(Y,L[ge]))return!0;return!1}function _t(L,Y){for(var K=-1,ge=L==null?0:L.length,Ae=Array(ge);++K<ge;)Ae[K]=Y(L[K],K,L);return Ae}function Pi(L,Y){for(var K=-1,ge=Y.length,Ae=L.length;++K<ge;)L[Ae+K]=Y[K];return L}function Ma(L,Y,K,ge){var Ae=-1,rt=L==null?0:L.length;for(ge&&rt&&(K=L[++Ae]);++Ae<rt;)K=Y(K,L[Ae],Ae,L);return K}function dg(L,Y,K,ge){var Ae=L==null?0:L.length;for(ge&&Ae&&(K=L[--Ae]);Ae--;)K=Y(K,L[Ae],Ae,L);return K}function qa(L,Y){for(var K=-1,ge=L==null?0:L.length;++K<ge;)if(Y(L[K],K,L))return!0;return!1}var pg=Ba("length");function gg(L){return L.split("")}function yg(L){return L.match(Mt)||[]}function hh(L,Y,K){var ge;return K(L,function(Ae,rt,zt){if(Y(Ae,rt,zt))return ge=rt,!1}),ge}function ro(L,Y,K,ge){for(var Ae=L.length,rt=K+(ge?1:-1);ge?rt--:++rt<Ae;)if(Y(L[rt],rt,L))return rt;return-1}function wn(L,Y,K){return Y===Y?Pg(L,Y,K):ro(L,lh,K)}function vg(L,Y,K,ge){for(var Ae=K-1,rt=L.length;++Ae<rt;)if(ge(L[Ae],Y))return Ae;return-1}function lh(L){return L!==L}function fh(L,Y){var K=L==null?0:L.length;return K?Ha(L,Y)/K:J}function Ba(L){return function(Y){return Y==null?t:Y[L]}}function za(L){return function(Y){return L==null?t:L[Y]}}function dh(L,Y,K,ge,Ae){return Ae(L,function(rt,zt,ut){K=ge?(ge=!1,rt):Y(K,rt,zt,ut)}),K}function _g(L,Y){var K=L.length;for(L.sort(Y);K--;)L[K]=L[K].value;return L}function Ha(L,Y){for(var K,ge=-1,Ae=L.length;++ge<Ae;){var rt=Y(L[ge]);rt!==t&&(K=K===t?rt:K+rt)}return K}function Ka(L,Y){for(var K=-1,ge=Array(L);++K<L;)ge[K]=Y(K);return ge}function mg(L,Y){return _t(Y,function(K){return[K,L[K]]})}function ph(L){return L&&L.slice(0,_h(L)+1).replace(Ot,"")}function Er(L){return function(Y){return L(Y)}}function ka(L,Y){return _t(Y,function(K){return L[K]})}function Jn(L,Y){return L.has(Y)}function gh(L,Y){for(var K=-1,ge=L.length;++K<ge&&wn(Y,L[K],0)>-1;);return K}function yh(L,Y){for(var K=L.length;K--&&wn(Y,L[K],0)>-1;);return K}function wg(L,Y){for(var K=L.length,ge=0;K--;)L[K]===Y&&++ge;return ge}var bg=za(I),Eg=za(U);function Dg(L){return"\\"+pe[L]}function Sg(L,Y){return L==null?t:L[Y]}function bn(L){return Zs.test(L)}function Ig(L){return ki.test(L)}function xg(L){for(var Y,K=[];!(Y=L.next()).done;)K.push(Y.value);return K}function Va(L){var Y=-1,K=Array(L.size);return L.forEach(function(ge,Ae){K[++Y]=[Ae,ge]}),K}function vh(L,Y){return function(K){return L(Y(K))}}function Ci(L,Y){for(var K=-1,ge=L.length,Ae=0,rt=[];++K<ge;){var zt=L[K];(zt===Y||zt===v)&&(L[K]=v,rt[Ae++]=K)}return rt}function io(L){var Y=-1,K=Array(L.size);return L.forEach(function(ge){K[++Y]=ge}),K}function Og(L){var Y=-1,K=Array(L.size);return L.forEach(function(ge){K[++Y]=[ge,ge]}),K}function Pg(L,Y,K){for(var ge=K-1,Ae=L.length;++ge<Ae;)if(L[ge]===Y)return ge;return-1}function Cg(L,Y,K){for(var ge=K+1;ge--;)if(L[ge]===Y)return ge;return ge}function En(L){return bn(L)?Tg(L):pg(L)}function Hr(L){return bn(L)?Rg(L):gg(L)}function _h(L){for(var Y=L.length;Y--&&At.test(L.charAt(Y)););return Y}var Ag=za(te);function Tg(L){for(var Y=mn.lastIndex=0;mn.test(L);)++Y;return Y}function Rg(L){return L.match(mn)||[]}function Ng(L){return L.match(Xs)||[]}var $g=function L(Y){Y=Y==null?Xe:Dn.defaults(Xe.Object(),Y,Dn.pick(Xe,eo));var K=Y.Array,ge=Y.Date,Ae=Y.Error,rt=Y.Function,zt=Y.Math,ut=Y.Object,Ga=Y.RegExp,Fg=Y.String,Nr=Y.TypeError,no=K.prototype,Ug=rt.prototype,Sn=ut.prototype,so=Y["__core-js_shared__"],oo=Ug.toString,nt=Sn.hasOwnProperty,Lg=0,mh=function(){var r=/[^.]+$/.exec(so&&so.keys&&so.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),ao=Sn.toString,jg=oo.call(ut),Mg=Xe._,qg=Ga("^"+oo.call(nt).replace(xt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),co=dr?Y.Buffer:t,Ai=Y.Symbol,uo=Y.Uint8Array,wh=co?co.allocUnsafe:t,ho=vh(ut.getPrototypeOf,ut),bh=ut.create,Eh=Sn.propertyIsEnumerable,lo=no.splice,Dh=Ai?Ai.isConcatSpreadable:t,Qn=Ai?Ai.iterator:t,Gi=Ai?Ai.toStringTag:t,fo=function(){try{var r=Xi(ut,"defineProperty");return r({},"",{}),r}catch{}}(),Bg=Y.clearTimeout!==Xe.clearTimeout&&Y.clearTimeout,zg=ge&&ge.now!==Xe.Date.now&&ge.now,Hg=Y.setTimeout!==Xe.setTimeout&&Y.setTimeout,po=zt.ceil,go=zt.floor,Wa=ut.getOwnPropertySymbols,Kg=co?co.isBuffer:t,Sh=Y.isFinite,kg=no.join,Vg=vh(ut.keys,ut),Ht=zt.max,Qt=zt.min,Gg=ge.now,Wg=Y.parseInt,Ih=zt.random,Yg=no.reverse,Ya=Xi(Y,"DataView"),Xn=Xi(Y,"Map"),Ja=Xi(Y,"Promise"),In=Xi(Y,"Set"),Zn=Xi(Y,"WeakMap"),es=Xi(ut,"create"),yo=Zn&&new Zn,xn={},Jg=Zi(Ya),Qg=Zi(Xn),Xg=Zi(Ja),Zg=Zi(In),e0=Zi(Zn),vo=Ai?Ai.prototype:t,ts=vo?vo.valueOf:t,xh=vo?vo.toString:t;function _(r){if(Ct(r)&&!Re(r)&&!(r instanceof Ye)){if(r instanceof $r)return r;if(nt.call(r,"__wrapped__"))return Ol(r)}return new $r(r)}var On=function(){function r(){}return function(n){if(!Et(n))return{};if(bh)return bh(n);r.prototype=n;var a=new r;return r.prototype=t,a}}();function _o(){}function $r(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}_.templateSettings={escape:St,evaluate:It,interpolate:bt,variable:"",imports:{_}},_.prototype=_o.prototype,_.prototype.constructor=_,$r.prototype=On(_o.prototype),$r.prototype.constructor=$r;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function t0(){var r=new Ye(this.__wrapped__);return r.__actions__=pr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=pr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=pr(this.__views__),r}function r0(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function i0(){var r=this.__wrapped__.value(),n=this.__dir__,a=Re(r),h=n<0,y=a?r.length:0,m=gy(0,y,this.__views__),P=m.start,N=m.end,M=N-P,X=h?N:P-1,Z=this.__iteratees__,ne=Z.length,he=0,ye=Qt(M,this.__takeCount__);if(!a||!h&&y==M&&ye==M)return Jh(r,this.__actions__);var Ee=[];e:for(;M--&&he<ye;){X+=n;for(var Be=-1,De=r[X];++Be<ne;){var Ge=Z[Be],Ze=Ge.iteratee,Ir=Ge.type,or=Ze(De);if(Ir==A)De=or;else if(!or){if(Ir==b)continue e;break e}}Ee[he++]=De}return Ee}Ye.prototype=On(_o.prototype),Ye.prototype.constructor=Ye;function Wi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function n0(){this.__data__=es?es(null):{},this.size=0}function s0(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function o0(r){var n=this.__data__;if(es){var a=n[r];return a===g?t:a}return nt.call(n,r)?n[r]:t}function a0(r){var n=this.__data__;return es?n[r]!==t:nt.call(n,r)}function c0(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=es&&n===t?g:n,this}Wi.prototype.clear=n0,Wi.prototype.delete=s0,Wi.prototype.get=o0,Wi.prototype.has=a0,Wi.prototype.set=c0;function ci(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function u0(){this.__data__=[],this.size=0}function h0(r){var n=this.__data__,a=mo(n,r);if(a<0)return!1;var h=n.length-1;return a==h?n.pop():lo.call(n,a,1),--this.size,!0}function l0(r){var n=this.__data__,a=mo(n,r);return a<0?t:n[a][1]}function f0(r){return mo(this.__data__,r)>-1}function d0(r,n){var a=this.__data__,h=mo(a,r);return h<0?(++this.size,a.push([r,n])):a[h][1]=n,this}ci.prototype.clear=u0,ci.prototype.delete=h0,ci.prototype.get=l0,ci.prototype.has=f0,ci.prototype.set=d0;function ui(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function p0(){this.size=0,this.__data__={hash:new Wi,map:new(Xn||ci),string:new Wi}}function g0(r){var n=To(this,r).delete(r);return this.size-=n?1:0,n}function y0(r){return To(this,r).get(r)}function v0(r){return To(this,r).has(r)}function _0(r,n){var a=To(this,r),h=a.size;return a.set(r,n),this.size+=a.size==h?0:1,this}ui.prototype.clear=p0,ui.prototype.delete=g0,ui.prototype.get=y0,ui.prototype.has=v0,ui.prototype.set=_0;function Yi(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new ui;++n<a;)this.add(r[n])}function m0(r){return this.__data__.set(r,g),this}function w0(r){return this.__data__.has(r)}Yi.prototype.add=Yi.prototype.push=m0,Yi.prototype.has=w0;function Kr(r){var n=this.__data__=new ci(r);this.size=n.size}function b0(){this.__data__=new ci,this.size=0}function E0(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function D0(r){return this.__data__.get(r)}function S0(r){return this.__data__.has(r)}function I0(r,n){var a=this.__data__;if(a instanceof ci){var h=a.__data__;if(!Xn||h.length<o-1)return h.push([r,n]),this.size=++a.size,this;a=this.__data__=new ui(h)}return a.set(r,n),this.size=a.size,this}Kr.prototype.clear=b0,Kr.prototype.delete=E0,Kr.prototype.get=D0,Kr.prototype.has=S0,Kr.prototype.set=I0;function Oh(r,n){var a=Re(r),h=!a&&en(r),y=!a&&!h&&Fi(r),m=!a&&!h&&!y&&Tn(r),P=a||h||y||m,N=P?Ka(r.length,Fg):[],M=N.length;for(var X in r)(n||nt.call(r,X))&&!(P&&(X=="length"||y&&(X=="offset"||X=="parent")||m&&(X=="buffer"||X=="byteLength"||X=="byteOffset")||di(X,M)))&&N.push(X);return N}function Ph(r){var n=r.length;return n?r[ac(0,n-1)]:t}function x0(r,n){return Ro(pr(r),Ji(n,0,r.length))}function O0(r){return Ro(pr(r))}function Qa(r,n,a){(a!==t&&!kr(r[n],a)||a===t&&!(n in r))&&hi(r,n,a)}function rs(r,n,a){var h=r[n];(!(nt.call(r,n)&&kr(h,a))||a===t&&!(n in r))&&hi(r,n,a)}function mo(r,n){for(var a=r.length;a--;)if(kr(r[a][0],n))return a;return-1}function P0(r,n,a,h){return Ti(r,function(y,m,P){n(h,y,a(y),P)}),h}function Ch(r,n){return r&&ei(n,kt(n),r)}function C0(r,n){return r&&ei(n,yr(n),r)}function hi(r,n,a){n=="__proto__"&&fo?fo(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function Xa(r,n){for(var a=-1,h=n.length,y=K(h),m=r==null;++a<h;)y[a]=m?t:Rc(r,n[a]);return y}function Ji(r,n,a){return r===r&&(a!==t&&(r=r<=a?r:a),n!==t&&(r=r>=n?r:n)),r}function Fr(r,n,a,h,y,m){var P,N=n&D,M=n&S,X=n&x;if(a&&(P=y?a(r,h,y,m):a(r)),P!==t)return P;if(!Et(r))return r;var Z=Re(r);if(Z){if(P=vy(r),!N)return pr(r,P)}else{var ne=Xt(r),he=ne==ae||ne==fe;if(Fi(r))return Zh(r,N);if(ne==Le||ne==le||he&&!y){if(P=M||he?{}:_l(r),!N)return M?oy(r,C0(P,r)):sy(r,Ch(P,r))}else{if(!st[ne])return y?r:{};P=_y(r,ne,N)}}m||(m=new Kr);var ye=m.get(r);if(ye)return ye;m.set(r,P),Gl(r)?r.forEach(function(De){P.add(Fr(De,n,a,De,r,m))}):kl(r)&&r.forEach(function(De,Ge){P.set(Ge,Fr(De,n,a,Ge,r,m))});var Ee=X?M?_c:vc:M?yr:kt,Be=Z?t:Ee(r);return Rr(Be||r,function(De,Ge){Be&&(Ge=De,De=r[Ge]),rs(P,Ge,Fr(De,n,a,Ge,r,m))}),P}function A0(r){var n=kt(r);return function(a){return Ah(a,r,n)}}function Ah(r,n,a){var h=a.length;if(r==null)return!h;for(r=ut(r);h--;){var y=a[h],m=n[y],P=r[y];if(P===t&&!(y in r)||!m(P))return!1}return!0}function Th(r,n,a){if(typeof r!="function")throw new Nr(l);return us(function(){r.apply(t,a)},n)}function is(r,n,a,h){var y=-1,m=to,P=!0,N=r.length,M=[],X=n.length;if(!N)return M;a&&(n=_t(n,Er(a))),h?(m=ja,P=!1):n.length>=o&&(m=Jn,P=!1,n=new Yi(n));e:for(;++y<N;){var Z=r[y],ne=a==null?Z:a(Z);if(Z=h||Z!==0?Z:0,P&&ne===ne){for(var he=X;he--;)if(n[he]===ne)continue e;M.push(Z)}else m(n,ne,h)||M.push(Z)}return M}var Ti=nl(Zr),Rh=nl(ec,!0);function T0(r,n){var a=!0;return Ti(r,function(h,y,m){return a=!!n(h,y,m),a}),a}function wo(r,n,a){for(var h=-1,y=r.length;++h<y;){var m=r[h],P=n(m);if(P!=null&&(N===t?P===P&&!Sr(P):a(P,N)))var N=P,M=m}return M}function R0(r,n,a,h){var y=r.length;for(a=je(a),a<0&&(a=-a>y?0:y+a),h=h===t||h>y?y:je(h),h<0&&(h+=y),h=a>h?0:Yl(h);a<h;)r[a++]=n;return r}function Nh(r,n){var a=[];return Ti(r,function(h,y,m){n(h,y,m)&&a.push(h)}),a}function Wt(r,n,a,h,y){var m=-1,P=r.length;for(a||(a=wy),y||(y=[]);++m<P;){var N=r[m];n>0&&a(N)?n>1?Wt(N,n-1,a,h,y):Pi(y,N):h||(y[y.length]=N)}return y}var Za=sl(),$h=sl(!0);function Zr(r,n){return r&&Za(r,n,kt)}function ec(r,n){return r&&$h(r,n,kt)}function bo(r,n){return Oi(n,function(a){return pi(r[a])})}function Qi(r,n){n=Ni(n,r);for(var a=0,h=n.length;r!=null&&a<h;)r=r[ti(n[a++])];return a&&a==h?r:t}function Fh(r,n,a){var h=n(r);return Re(r)?h:Pi(h,a(r))}function nr(r){return r==null?r===t?qe:ke:Gi&&Gi in ut(r)?py(r):Oy(r)}function tc(r,n){return r>n}function N0(r,n){return r!=null&&nt.call(r,n)}function $0(r,n){return r!=null&&n in ut(r)}function F0(r,n,a){return r>=Qt(n,a)&&r<Ht(n,a)}function rc(r,n,a){for(var h=a?ja:to,y=r[0].length,m=r.length,P=m,N=K(m),M=1/0,X=[];P--;){var Z=r[P];P&&n&&(Z=_t(Z,Er(n))),M=Qt(Z.length,M),N[P]=!a&&(n||y>=120&&Z.length>=120)?new Yi(P&&Z):t}Z=r[0];var ne=-1,he=N[0];e:for(;++ne<y&&X.length<M;){var ye=Z[ne],Ee=n?n(ye):ye;if(ye=a||ye!==0?ye:0,!(he?Jn(he,Ee):h(X,Ee,a))){for(P=m;--P;){var Be=N[P];if(!(Be?Jn(Be,Ee):h(r[P],Ee,a)))continue e}he&&he.push(Ee),X.push(ye)}}return X}function U0(r,n,a,h){return Zr(r,function(y,m,P){n(h,a(y),m,P)}),h}function ns(r,n,a){n=Ni(n,r),r=El(r,n);var h=r==null?r:r[ti(Lr(n))];return h==null?t:Kt(h,r,a)}function Uh(r){return Ct(r)&&nr(r)==le}function L0(r){return Ct(r)&&nr(r)==Se}function j0(r){return Ct(r)&&nr(r)==F}function ss(r,n,a,h,y){return r===n?!0:r==null||n==null||!Ct(r)&&!Ct(n)?r!==r&&n!==n:M0(r,n,a,h,ss,y)}function M0(r,n,a,h,y,m){var P=Re(r),N=Re(n),M=P?_e:Xt(r),X=N?_e:Xt(n);M=M==le?Le:M,X=X==le?Le:X;var Z=M==Le,ne=X==Le,he=M==X;if(he&&Fi(r)){if(!Fi(n))return!1;P=!0,Z=!1}if(he&&!Z)return m||(m=new Kr),P||Tn(r)?gl(r,n,a,h,y,m):fy(r,n,M,a,h,y,m);if(!(a&O)){var ye=Z&&nt.call(r,"__wrapped__"),Ee=ne&&nt.call(n,"__wrapped__");if(ye||Ee){var Be=ye?r.value():r,De=Ee?n.value():n;return m||(m=new Kr),y(Be,De,a,h,m)}}return he?(m||(m=new Kr),dy(r,n,a,h,y,m)):!1}function q0(r){return Ct(r)&&Xt(r)==Ie}function ic(r,n,a,h){var y=a.length,m=y,P=!h;if(r==null)return!m;for(r=ut(r);y--;){var N=a[y];if(P&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++y<m;){N=a[y];var M=N[0],X=r[M],Z=N[1];if(P&&N[2]){if(X===t&&!(M in r))return!1}else{var ne=new Kr;if(h)var he=h(X,Z,M,r,n,ne);if(!(he===t?ss(Z,X,O|q,h,ne):he))return!1}}return!0}function Lh(r){if(!Et(r)||Ey(r))return!1;var n=pi(r)?qg:Ea;return n.test(Zi(r))}function B0(r){return Ct(r)&&nr(r)==Me}function z0(r){return Ct(r)&&Xt(r)==xe}function H0(r){return Ct(r)&&jo(r.length)&&!!ot[nr(r)]}function jh(r){return typeof r=="function"?r:r==null?vr:typeof r=="object"?Re(r)?Bh(r[0],r[1]):qh(r):af(r)}function nc(r){if(!cs(r))return Vg(r);var n=[];for(var a in ut(r))nt.call(r,a)&&a!="constructor"&&n.push(a);return n}function K0(r){if(!Et(r))return xy(r);var n=cs(r),a=[];for(var h in r)h=="constructor"&&(n||!nt.call(r,h))||a.push(h);return a}function sc(r,n){return r<n}function Mh(r,n){var a=-1,h=gr(r)?K(r.length):[];return Ti(r,function(y,m,P){h[++a]=n(y,m,P)}),h}function qh(r){var n=wc(r);return n.length==1&&n[0][2]?wl(n[0][0],n[0][1]):function(a){return a===r||ic(a,r,n)}}function Bh(r,n){return Ec(r)&&ml(n)?wl(ti(r),n):function(a){var h=Rc(a,r);return h===t&&h===n?Nc(a,r):ss(n,h,O|q)}}function Eo(r,n,a,h,y){r!==n&&Za(n,function(m,P){if(y||(y=new Kr),Et(m))k0(r,n,P,a,Eo,h,y);else{var N=h?h(Sc(r,P),m,P+"",r,n,y):t;N===t&&(N=m),Qa(r,P,N)}},yr)}function k0(r,n,a,h,y,m,P){var N=Sc(r,a),M=Sc(n,a),X=P.get(M);if(X){Qa(r,a,X);return}var Z=m?m(N,M,a+"",r,n,P):t,ne=Z===t;if(ne){var he=Re(M),ye=!he&&Fi(M),Ee=!he&&!ye&&Tn(M);Z=M,he||ye||Ee?Re(N)?Z=N:Rt(N)?Z=pr(N):ye?(ne=!1,Z=Zh(M,!0)):Ee?(ne=!1,Z=el(M,!0)):Z=[]:hs(M)||en(M)?(Z=N,en(N)?Z=Jl(N):(!Et(N)||pi(N))&&(Z=_l(M))):ne=!1}ne&&(P.set(M,Z),y(Z,M,h,m,P),P.delete(M)),Qa(r,a,Z)}function zh(r,n){var a=r.length;if(a)return n+=n<0?a:0,di(n,a)?r[n]:t}function Hh(r,n,a){n.length?n=_t(n,function(m){return Re(m)?function(P){return Qi(P,m.length===1?m[0]:m)}:m}):n=[vr];var h=-1;n=_t(n,Er(me()));var y=Mh(r,function(m,P,N){var M=_t(n,function(X){return X(m)});return{criteria:M,index:++h,value:m}});return _g(y,function(m,P){return ny(m,P,a)})}function V0(r,n){return Kh(r,n,function(a,h){return Nc(r,h)})}function Kh(r,n,a){for(var h=-1,y=n.length,m={};++h<y;){var P=n[h],N=Qi(r,P);a(N,P)&&os(m,Ni(P,r),N)}return m}function G0(r){return function(n){return Qi(n,r)}}function oc(r,n,a,h){var y=h?vg:wn,m=-1,P=n.length,N=r;for(r===n&&(n=pr(n)),a&&(N=_t(r,Er(a)));++m<P;)for(var M=0,X=n[m],Z=a?a(X):X;(M=y(N,Z,M,h))>-1;)N!==r&&lo.call(N,M,1),lo.call(r,M,1);return r}function kh(r,n){for(var a=r?n.length:0,h=a-1;a--;){var y=n[a];if(a==h||y!==m){var m=y;di(y)?lo.call(r,y,1):hc(r,y)}}return r}function ac(r,n){return r+go(Ih()*(n-r+1))}function W0(r,n,a,h){for(var y=-1,m=Ht(po((n-r)/(a||1)),0),P=K(m);m--;)P[h?m:++y]=r,r+=a;return P}function cc(r,n){var a="";if(!r||n<1||n>k)return a;do n%2&&(a+=r),n=go(n/2),n&&(r+=r);while(n);return a}function Ke(r,n){return Ic(bl(r,n,vr),r+"")}function Y0(r){return Ph(Rn(r))}function J0(r,n){var a=Rn(r);return Ro(a,Ji(n,0,a.length))}function os(r,n,a,h){if(!Et(r))return r;n=Ni(n,r);for(var y=-1,m=n.length,P=m-1,N=r;N!=null&&++y<m;){var M=ti(n[y]),X=a;if(M==="__proto__"||M==="constructor"||M==="prototype")return r;if(y!=P){var Z=N[M];X=h?h(Z,M,N):t,X===t&&(X=Et(Z)?Z:di(n[y+1])?[]:{})}rs(N,M,X),N=N[M]}return r}var Vh=yo?function(r,n){return yo.set(r,n),r}:vr,Q0=fo?function(r,n){return fo(r,"toString",{configurable:!0,enumerable:!1,value:Fc(n),writable:!0})}:vr;function X0(r){return Ro(Rn(r))}function Ur(r,n,a){var h=-1,y=r.length;n<0&&(n=-n>y?0:y+n),a=a>y?y:a,a<0&&(a+=y),y=n>a?0:a-n>>>0,n>>>=0;for(var m=K(y);++h<y;)m[h]=r[h+n];return m}function Z0(r,n){var a;return Ti(r,function(h,y,m){return a=n(h,y,m),!a}),!!a}function Do(r,n,a){var h=0,y=r==null?h:r.length;if(typeof n=="number"&&n===n&&y<=oe){for(;h<y;){var m=h+y>>>1,P=r[m];P!==null&&!Sr(P)&&(a?P<=n:P<n)?h=m+1:y=m}return y}return uc(r,n,vr,a)}function uc(r,n,a,h){var y=0,m=r==null?0:r.length;if(m===0)return 0;n=a(n);for(var P=n!==n,N=n===null,M=Sr(n),X=n===t;y<m;){var Z=go((y+m)/2),ne=a(r[Z]),he=ne!==t,ye=ne===null,Ee=ne===ne,Be=Sr(ne);if(P)var De=h||Ee;else X?De=Ee&&(h||he):N?De=Ee&&he&&(h||!ye):M?De=Ee&&he&&!ye&&(h||!Be):ye||Be?De=!1:De=h?ne<=n:ne<n;De?y=Z+1:m=Z}return Qt(m,we)}function Gh(r,n){for(var a=-1,h=r.length,y=0,m=[];++a<h;){var P=r[a],N=n?n(P):P;if(!a||!kr(N,M)){var M=N;m[y++]=P===0?0:P}}return m}function Wh(r){return typeof r=="number"?r:Sr(r)?J:+r}function Dr(r){if(typeof r=="string")return r;if(Re(r))return _t(r,Dr)+"";if(Sr(r))return xh?xh.call(r):"";var n=r+"";return n=="0"&&1/r==-Q?"-0":n}function Ri(r,n,a){var h=-1,y=to,m=r.length,P=!0,N=[],M=N;if(a)P=!1,y=ja;else if(m>=o){var X=n?null:hy(r);if(X)return io(X);P=!1,y=Jn,M=new Yi}else M=n?[]:N;e:for(;++h<m;){var Z=r[h],ne=n?n(Z):Z;if(Z=a||Z!==0?Z:0,P&&ne===ne){for(var he=M.length;he--;)if(M[he]===ne)continue e;n&&M.push(ne),N.push(Z)}else y(M,ne,a)||(M!==N&&M.push(ne),N.push(Z))}return N}function hc(r,n){return n=Ni(n,r),r=El(r,n),r==null||delete r[ti(Lr(n))]}function Yh(r,n,a,h){return os(r,n,a(Qi(r,n)),h)}function So(r,n,a,h){for(var y=r.length,m=h?y:-1;(h?m--:++m<y)&&n(r[m],m,r););return a?Ur(r,h?0:m,h?m+1:y):Ur(r,h?m+1:0,h?y:m)}function Jh(r,n){var a=r;return a instanceof Ye&&(a=a.value()),Ma(n,function(h,y){return y.func.apply(y.thisArg,Pi([h],y.args))},a)}function lc(r,n,a){var h=r.length;if(h<2)return h?Ri(r[0]):[];for(var y=-1,m=K(h);++y<h;)for(var P=r[y],N=-1;++N<h;)N!=y&&(m[y]=is(m[y]||P,r[N],n,a));return Ri(Wt(m,1),n,a)}function Qh(r,n,a){for(var h=-1,y=r.length,m=n.length,P={};++h<y;){var N=h<m?n[h]:t;a(P,r[h],N)}return P}function fc(r){return Rt(r)?r:[]}function dc(r){return typeof r=="function"?r:vr}function Ni(r,n){return Re(r)?r:Ec(r,n)?[r]:xl(it(r))}var ey=Ke;function $i(r,n,a){var h=r.length;return a=a===t?h:a,!n&&a>=h?r:Ur(r,n,a)}var Xh=Bg||function(r){return Xe.clearTimeout(r)};function Zh(r,n){if(n)return r.slice();var a=r.length,h=wh?wh(a):new r.constructor(a);return r.copy(h),h}function pc(r){var n=new r.constructor(r.byteLength);return new uo(n).set(new uo(r)),n}function ty(r,n){var a=n?pc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function ry(r){var n=new r.constructor(r.source,Ar.exec(r));return n.lastIndex=r.lastIndex,n}function iy(r){return ts?ut(ts.call(r)):{}}function el(r,n){var a=n?pc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function tl(r,n){if(r!==n){var a=r!==t,h=r===null,y=r===r,m=Sr(r),P=n!==t,N=n===null,M=n===n,X=Sr(n);if(!N&&!X&&!m&&r>n||m&&P&&M&&!N&&!X||h&&P&&M||!a&&M||!y)return 1;if(!h&&!m&&!X&&r<n||X&&a&&y&&!h&&!m||N&&a&&y||!P&&y||!M)return-1}return 0}function ny(r,n,a){for(var h=-1,y=r.criteria,m=n.criteria,P=y.length,N=a.length;++h<P;){var M=tl(y[h],m[h]);if(M){if(h>=N)return M;var X=a[h];return M*(X=="desc"?-1:1)}}return r.index-n.index}function rl(r,n,a,h){for(var y=-1,m=r.length,P=a.length,N=-1,M=n.length,X=Ht(m-P,0),Z=K(M+X),ne=!h;++N<M;)Z[N]=n[N];for(;++y<P;)(ne||y<m)&&(Z[a[y]]=r[y]);for(;X--;)Z[N++]=r[y++];return Z}function il(r,n,a,h){for(var y=-1,m=r.length,P=-1,N=a.length,M=-1,X=n.length,Z=Ht(m-N,0),ne=K(Z+X),he=!h;++y<Z;)ne[y]=r[y];for(var ye=y;++M<X;)ne[ye+M]=n[M];for(;++P<N;)(he||y<m)&&(ne[ye+a[P]]=r[y++]);return ne}function pr(r,n){var a=-1,h=r.length;for(n||(n=K(h));++a<h;)n[a]=r[a];return n}function ei(r,n,a,h){var y=!a;a||(a={});for(var m=-1,P=n.length;++m<P;){var N=n[m],M=h?h(a[N],r[N],N,a,r):t;M===t&&(M=r[N]),y?hi(a,N,M):rs(a,N,M)}return a}function sy(r,n){return ei(r,bc(r),n)}function oy(r,n){return ei(r,yl(r),n)}function Io(r,n){return function(a,h){var y=Re(a)?lg:P0,m=n?n():{};return y(a,r,me(h,2),m)}}function Pn(r){return Ke(function(n,a){var h=-1,y=a.length,m=y>1?a[y-1]:t,P=y>2?a[2]:t;for(m=r.length>3&&typeof m=="function"?(y--,m):t,P&&sr(a[0],a[1],P)&&(m=y<3?t:m,y=1),n=ut(n);++h<y;){var N=a[h];N&&r(n,N,h,m)}return n})}function nl(r,n){return function(a,h){if(a==null)return a;if(!gr(a))return r(a,h);for(var y=a.length,m=n?y:-1,P=ut(a);(n?m--:++m<y)&&h(P[m],m,P)!==!1;);return a}}function sl(r){return function(n,a,h){for(var y=-1,m=ut(n),P=h(n),N=P.length;N--;){var M=P[r?N:++y];if(a(m[M],M,m)===!1)break}return n}}function ay(r,n,a){var h=n&H,y=as(r);function m(){var P=this&&this!==Xe&&this instanceof m?y:r;return P.apply(h?a:this,arguments)}return m}function ol(r){return function(n){n=it(n);var a=bn(n)?Hr(n):t,h=a?a[0]:n.charAt(0),y=a?$i(a,1).join(""):n.slice(1);return h[r]()+y}}function Cn(r){return function(n){return Ma(sf(nf(n).replace(Wn,"")),r,"")}}function as(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=On(r.prototype),h=r.apply(a,n);return Et(h)?h:a}}function cy(r,n,a){var h=as(r);function y(){for(var m=arguments.length,P=K(m),N=m,M=An(y);N--;)P[N]=arguments[N];var X=m<3&&P[0]!==M&&P[m-1]!==M?[]:Ci(P,M);if(m-=X.length,m<a)return ll(r,n,xo,y.placeholder,t,P,X,t,t,a-m);var Z=this&&this!==Xe&&this instanceof y?h:r;return Kt(Z,this,P)}return y}function al(r){return function(n,a,h){var y=ut(n);if(!gr(n)){var m=me(a,3);n=kt(n),a=function(N){return m(y[N],N,y)}}var P=r(n,a,h);return P>-1?y[m?n[P]:P]:t}}function cl(r){return fi(function(n){var a=n.length,h=a,y=$r.prototype.thru;for(r&&n.reverse();h--;){var m=n[h];if(typeof m!="function")throw new Nr(l);if(y&&!P&&Ao(m)=="wrapper")var P=new $r([],!0)}for(h=P?h:a;++h<a;){m=n[h];var N=Ao(m),M=N=="wrapper"?mc(m):t;M&&Dc(M[0])&&M[1]==(u|j|T|w)&&!M[4].length&&M[9]==1?P=P[Ao(M[0])].apply(P,M[3]):P=m.length==1&&Dc(m)?P[N]():P.thru(m)}return function(){var X=arguments,Z=X[0];if(P&&X.length==1&&Re(Z))return P.plant(Z).value();for(var ne=0,he=a?n[ne].apply(this,X):Z;++ne<a;)he=n[ne].call(this,he);return he}})}function xo(r,n,a,h,y,m,P,N,M,X){var Z=n&u,ne=n&H,he=n&ie,ye=n&(j|C),Ee=n&G,Be=he?t:as(r);function De(){for(var Ge=arguments.length,Ze=K(Ge),Ir=Ge;Ir--;)Ze[Ir]=arguments[Ir];if(ye)var or=An(De),xr=wg(Ze,or);if(h&&(Ze=rl(Ze,h,y,ye)),m&&(Ze=il(Ze,m,P,ye)),Ge-=xr,ye&&Ge<X){var Nt=Ci(Ze,or);return ll(r,n,xo,De.placeholder,a,Ze,Nt,N,M,X-Ge)}var Vr=ne?a:this,yi=he?Vr[r]:r;return Ge=Ze.length,N?Ze=Py(Ze,N):Ee&&Ge>1&&Ze.reverse(),Z&&M<Ge&&(Ze.length=M),this&&this!==Xe&&this instanceof De&&(yi=Be||as(yi)),yi.apply(Vr,Ze)}return De}function ul(r,n){return function(a,h){return U0(a,r,n(h),{})}}function Oo(r,n){return function(a,h){var y;if(a===t&&h===t)return n;if(a!==t&&(y=a),h!==t){if(y===t)return h;typeof a=="string"||typeof h=="string"?(a=Dr(a),h=Dr(h)):(a=Wh(a),h=Wh(h)),y=r(a,h)}return y}}function gc(r){return fi(function(n){return n=_t(n,Er(me())),Ke(function(a){var h=this;return r(n,function(y){return Kt(y,h,a)})})})}function Po(r,n){n=n===t?" ":Dr(n);var a=n.length;if(a<2)return a?cc(n,r):n;var h=cc(n,po(r/En(n)));return bn(n)?$i(Hr(h),0,r).join(""):h.slice(0,r)}function uy(r,n,a,h){var y=n&H,m=as(r);function P(){for(var N=-1,M=arguments.length,X=-1,Z=h.length,ne=K(Z+M),he=this&&this!==Xe&&this instanceof P?m:r;++X<Z;)ne[X]=h[X];for(;M--;)ne[X++]=arguments[++N];return Kt(he,y?a:this,ne)}return P}function hl(r){return function(n,a,h){return h&&typeof h!="number"&&sr(n,a,h)&&(a=h=t),n=gi(n),a===t?(a=n,n=0):a=gi(a),h=h===t?n<a?1:-1:gi(h),W0(n,a,h,r)}}function Co(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=jr(n),a=jr(a)),r(n,a)}}function ll(r,n,a,h,y,m,P,N,M,X){var Z=n&j,ne=Z?P:t,he=Z?t:P,ye=Z?m:t,Ee=Z?t:m;n|=Z?T:E,n&=~(Z?E:T),n&$||(n&=~(H|ie));var Be=[r,n,y,ye,ne,Ee,he,N,M,X],De=a.apply(t,Be);return Dc(r)&&Dl(De,Be),De.placeholder=h,Sl(De,r,n)}function yc(r){var n=zt[r];return function(a,h){if(a=jr(a),h=h==null?0:Qt(je(h),292),h&&Sh(a)){var y=(it(a)+"e").split("e"),m=n(y[0]+"e"+(+y[1]+h));return y=(it(m)+"e").split("e"),+(y[0]+"e"+(+y[1]-h))}return n(a)}}var hy=In&&1/io(new In([,-0]))[1]==Q?function(r){return new In(r)}:jc;function fl(r){return function(n){var a=Xt(n);return a==Ie?Va(n):a==xe?Og(n):mg(n,r(n))}}function li(r,n,a,h,y,m,P,N){var M=n&ie;if(!M&&typeof r!="function")throw new Nr(l);var X=h?h.length:0;if(X||(n&=~(T|E),h=y=t),P=P===t?P:Ht(je(P),0),N=N===t?N:je(N),X-=y?y.length:0,n&E){var Z=h,ne=y;h=y=t}var he=M?t:mc(r),ye=[r,n,a,h,y,Z,ne,m,P,N];if(he&&Iy(ye,he),r=ye[0],n=ye[1],a=ye[2],h=ye[3],y=ye[4],N=ye[9]=ye[9]===t?M?0:r.length:Ht(ye[9]-X,0),!N&&n&(j|C)&&(n&=~(j|C)),!n||n==H)var Ee=ay(r,n,a);else n==j||n==C?Ee=cy(r,n,N):(n==T||n==(H|T))&&!y.length?Ee=uy(r,n,a,h):Ee=xo.apply(t,ye);var Be=he?Vh:Dl;return Sl(Be(Ee,ye),r,n)}function dl(r,n,a,h){return r===t||kr(r,Sn[a])&&!nt.call(h,a)?n:r}function pl(r,n,a,h,y,m){return Et(r)&&Et(n)&&(m.set(n,r),Eo(r,n,t,pl,m),m.delete(n)),r}function ly(r){return hs(r)?t:r}function gl(r,n,a,h,y,m){var P=a&O,N=r.length,M=n.length;if(N!=M&&!(P&&M>N))return!1;var X=m.get(r),Z=m.get(n);if(X&&Z)return X==n&&Z==r;var ne=-1,he=!0,ye=a&q?new Yi:t;for(m.set(r,n),m.set(n,r);++ne<N;){var Ee=r[ne],Be=n[ne];if(h)var De=P?h(Be,Ee,ne,n,r,m):h(Ee,Be,ne,r,n,m);if(De!==t){if(De)continue;he=!1;break}if(ye){if(!qa(n,function(Ge,Ze){if(!Jn(ye,Ze)&&(Ee===Ge||y(Ee,Ge,a,h,m)))return ye.push(Ze)})){he=!1;break}}else if(!(Ee===Be||y(Ee,Be,a,h,m))){he=!1;break}}return m.delete(r),m.delete(n),he}function fy(r,n,a,h,y,m,P){switch(a){case Ce:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case Se:return!(r.byteLength!=n.byteLength||!m(new uo(r),new uo(n)));case B:case F:case ze:return kr(+r,+n);case R:return r.name==n.name&&r.message==n.message;case Me:case Ne:return r==n+"";case Ie:var N=Va;case xe:var M=h&O;if(N||(N=io),r.size!=n.size&&!M)return!1;var X=P.get(r);if(X)return X==n;h|=q,P.set(r,n);var Z=gl(N(r),N(n),h,y,m,P);return P.delete(r),Z;case $e:if(ts)return ts.call(r)==ts.call(n)}return!1}function dy(r,n,a,h,y,m){var P=a&O,N=vc(r),M=N.length,X=vc(n),Z=X.length;if(M!=Z&&!P)return!1;for(var ne=M;ne--;){var he=N[ne];if(!(P?he in n:nt.call(n,he)))return!1}var ye=m.get(r),Ee=m.get(n);if(ye&&Ee)return ye==n&&Ee==r;var Be=!0;m.set(r,n),m.set(n,r);for(var De=P;++ne<M;){he=N[ne];var Ge=r[he],Ze=n[he];if(h)var Ir=P?h(Ze,Ge,he,n,r,m):h(Ge,Ze,he,r,n,m);if(!(Ir===t?Ge===Ze||y(Ge,Ze,a,h,m):Ir)){Be=!1;break}De||(De=he=="constructor")}if(Be&&!De){var or=r.constructor,xr=n.constructor;or!=xr&&"constructor"in r&&"constructor"in n&&!(typeof or=="function"&&or instanceof or&&typeof xr=="function"&&xr instanceof xr)&&(Be=!1)}return m.delete(r),m.delete(n),Be}function fi(r){return Ic(bl(r,t,Al),r+"")}function vc(r){return Fh(r,kt,bc)}function _c(r){return Fh(r,yr,yl)}var mc=yo?function(r){return yo.get(r)}:jc;function Ao(r){for(var n=r.name+"",a=xn[n],h=nt.call(xn,n)?a.length:0;h--;){var y=a[h],m=y.func;if(m==null||m==r)return y.name}return n}function An(r){var n=nt.call(_,"placeholder")?_:r;return n.placeholder}function me(){var r=_.iteratee||Uc;return r=r===Uc?jh:r,arguments.length?r(arguments[0],arguments[1]):r}function To(r,n){var a=r.__data__;return by(n)?a[typeof n=="string"?"string":"hash"]:a.map}function wc(r){for(var n=kt(r),a=n.length;a--;){var h=n[a],y=r[h];n[a]=[h,y,ml(y)]}return n}function Xi(r,n){var a=Sg(r,n);return Lh(a)?a:t}function py(r){var n=nt.call(r,Gi),a=r[Gi];try{r[Gi]=t;var h=!0}catch{}var y=ao.call(r);return h&&(n?r[Gi]=a:delete r[Gi]),y}var bc=Wa?function(r){return r==null?[]:(r=ut(r),Oi(Wa(r),function(n){return Eh.call(r,n)}))}:Mc,yl=Wa?function(r){for(var n=[];r;)Pi(n,bc(r)),r=ho(r);return n}:Mc,Xt=nr;(Ya&&Xt(new Ya(new ArrayBuffer(1)))!=Ce||Xn&&Xt(new Xn)!=Ie||Ja&&Xt(Ja.resolve())!=pt||In&&Xt(new In)!=xe||Zn&&Xt(new Zn)!=Pe)&&(Xt=function(r){var n=nr(r),a=n==Le?r.constructor:t,h=a?Zi(a):"";if(h)switch(h){case Jg:return Ce;case Qg:return Ie;case Xg:return pt;case Zg:return xe;case e0:return Pe}return n});function gy(r,n,a){for(var h=-1,y=a.length;++h<y;){var m=a[h],P=m.size;switch(m.type){case"drop":r+=P;break;case"dropRight":n-=P;break;case"take":n=Qt(n,r+P);break;case"takeRight":r=Ht(r,n-P);break}}return{start:r,end:n}}function yy(r){var n=r.match(ht);return n?n[1].split(jt):[]}function vl(r,n,a){n=Ni(n,r);for(var h=-1,y=n.length,m=!1;++h<y;){var P=ti(n[h]);if(!(m=r!=null&&a(r,P)))break;r=r[P]}return m||++h!=y?m:(y=r==null?0:r.length,!!y&&jo(y)&&di(P,y)&&(Re(r)||en(r)))}function vy(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&nt.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function _l(r){return typeof r.constructor=="function"&&!cs(r)?On(ho(r)):{}}function _y(r,n,a){var h=r.constructor;switch(n){case Se:return pc(r);case B:case F:return new h(+r);case Ce:return ty(r,a);case He:case Oe:case Ve:case We:case et:case tt:case Qe:case tr:case fr:return el(r,a);case Ie:return new h;case ze:case Ne:return new h(r);case Me:return ry(r);case xe:return new h;case $e:return iy(r)}}function my(r,n){var a=n.length;if(!a)return r;var h=a-1;return n[h]=(a>1?"& ":"")+n[h],n=n.join(a>2?", ":" "),r.replace(Pt,`{
/* [wrapped with `+n+`] */
`)}function wy(r){return Re(r)||en(r)||!!(Dh&&r&&r[Dh])}function di(r,n){var a=typeof r;return n=n??k,!!n&&(a=="number"||a!="symbol"&&Sa.test(r))&&r>-1&&r%1==0&&r<n}function sr(r,n,a){if(!Et(a))return!1;var h=typeof n;return(h=="number"?gr(a)&&di(n,a.length):h=="string"&&n in a)?kr(a[n],r):!1}function Ec(r,n){if(Re(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Sr(r)?!0:Ft.test(r)||!vt.test(r)||n!=null&&r in ut(n)}function by(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function Dc(r){var n=Ao(r),a=_[n];if(typeof a!="function"||!(n in Ye.prototype))return!1;if(r===a)return!0;var h=mc(a);return!!h&&r===h[0]}function Ey(r){return!!mh&&mh in r}var Dy=so?pi:qc;function cs(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||Sn;return r===a}function ml(r){return r===r&&!Et(r)}function wl(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==t||r in ut(a))}}function Sy(r){var n=Uo(r,function(h){return a.size===p&&a.clear(),h}),a=n.cache;return n}function Iy(r,n){var a=r[1],h=n[1],y=a|h,m=y<(H|ie|u),P=h==u&&a==j||h==u&&a==w&&r[7].length<=n[8]||h==(u|w)&&n[7].length<=n[8]&&a==j;if(!(m||P))return r;h&H&&(r[2]=n[2],y|=a&H?0:$);var N=n[3];if(N){var M=r[3];r[3]=M?rl(M,N,n[4]):N,r[4]=M?Ci(r[3],v):n[4]}return N=n[5],N&&(M=r[5],r[5]=M?il(M,N,n[6]):N,r[6]=M?Ci(r[5],v):n[6]),N=n[7],N&&(r[7]=N),h&u&&(r[8]=r[8]==null?n[8]:Qt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=y,r}function xy(r){var n=[];if(r!=null)for(var a in ut(r))n.push(a);return n}function Oy(r){return ao.call(r)}function bl(r,n,a){return n=Ht(n===t?r.length-1:n,0),function(){for(var h=arguments,y=-1,m=Ht(h.length-n,0),P=K(m);++y<m;)P[y]=h[n+y];y=-1;for(var N=K(n+1);++y<n;)N[y]=h[y];return N[n]=a(P),Kt(r,this,N)}}function El(r,n){return n.length<2?r:Qi(r,Ur(n,0,-1))}function Py(r,n){for(var a=r.length,h=Qt(n.length,a),y=pr(r);h--;){var m=n[h];r[h]=di(m,a)?y[m]:t}return r}function Sc(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var Dl=Il(Vh),us=Hg||function(r,n){return Xe.setTimeout(r,n)},Ic=Il(Q0);function Sl(r,n,a){var h=n+"";return Ic(r,my(h,Cy(yy(h),a)))}function Il(r){var n=0,a=0;return function(){var h=Gg(),y=de-(h-a);if(a=h,y>0){if(++n>=ue)return arguments[0]}else n=0;return r.apply(t,arguments)}}function Ro(r,n){var a=-1,h=r.length,y=h-1;for(n=n===t?h:n;++a<n;){var m=ac(a,y),P=r[m];r[m]=r[a],r[a]=P}return r.length=n,r}var xl=Sy(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(Ut,function(a,h,y,m){n.push(y?m.replace(_a,"$1"):h||a)}),n});function ti(r){if(typeof r=="string"||Sr(r))return r;var n=r+"";return n=="0"&&1/r==-Q?"-0":n}function Zi(r){if(r!=null){try{return oo.call(r)}catch{}try{return r+""}catch{}}return""}function Cy(r,n){return Rr(be,function(a){var h="_."+a[0];n&a[1]&&!to(r,h)&&r.push(h)}),r.sort()}function Ol(r){if(r instanceof Ye)return r.clone();var n=new $r(r.__wrapped__,r.__chain__);return n.__actions__=pr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function Ay(r,n,a){(a?sr(r,n,a):n===t)?n=1:n=Ht(je(n),0);var h=r==null?0:r.length;if(!h||n<1)return[];for(var y=0,m=0,P=K(po(h/n));y<h;)P[m++]=Ur(r,y,y+=n);return P}function Ty(r){for(var n=-1,a=r==null?0:r.length,h=0,y=[];++n<a;){var m=r[n];m&&(y[h++]=m)}return y}function Ry(){var r=arguments.length;if(!r)return[];for(var n=K(r-1),a=arguments[0],h=r;h--;)n[h-1]=arguments[h];return Pi(Re(a)?pr(a):[a],Wt(n,1))}var Ny=Ke(function(r,n){return Rt(r)?is(r,Wt(n,1,Rt,!0)):[]}),$y=Ke(function(r,n){var a=Lr(n);return Rt(a)&&(a=t),Rt(r)?is(r,Wt(n,1,Rt,!0),me(a,2)):[]}),Fy=Ke(function(r,n){var a=Lr(n);return Rt(a)&&(a=t),Rt(r)?is(r,Wt(n,1,Rt,!0),t,a):[]});function Uy(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:je(n),Ur(r,n<0?0:n,h)):[]}function Ly(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:je(n),n=h-n,Ur(r,0,n<0?0:n)):[]}function jy(r,n){return r&&r.length?So(r,me(n,3),!0,!0):[]}function My(r,n){return r&&r.length?So(r,me(n,3),!0):[]}function qy(r,n,a,h){var y=r==null?0:r.length;return y?(a&&typeof a!="number"&&sr(r,n,a)&&(a=0,h=y),R0(r,n,a,h)):[]}function Pl(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var y=a==null?0:je(a);return y<0&&(y=Ht(h+y,0)),ro(r,me(n,3),y)}function Cl(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var y=h-1;return a!==t&&(y=je(a),y=a<0?Ht(h+y,0):Qt(y,h-1)),ro(r,me(n,3),y,!0)}function Al(r){var n=r==null?0:r.length;return n?Wt(r,1):[]}function By(r){var n=r==null?0:r.length;return n?Wt(r,Q):[]}function zy(r,n){var a=r==null?0:r.length;return a?(n=n===t?1:je(n),Wt(r,n)):[]}function Hy(r){for(var n=-1,a=r==null?0:r.length,h={};++n<a;){var y=r[n];h[y[0]]=y[1]}return h}function Tl(r){return r&&r.length?r[0]:t}function Ky(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var y=a==null?0:je(a);return y<0&&(y=Ht(h+y,0)),wn(r,n,y)}function ky(r){var n=r==null?0:r.length;return n?Ur(r,0,-1):[]}var Vy=Ke(function(r){var n=_t(r,fc);return n.length&&n[0]===r[0]?rc(n):[]}),Gy=Ke(function(r){var n=Lr(r),a=_t(r,fc);return n===Lr(a)?n=t:a.pop(),a.length&&a[0]===r[0]?rc(a,me(n,2)):[]}),Wy=Ke(function(r){var n=Lr(r),a=_t(r,fc);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===r[0]?rc(a,t,n):[]});function Yy(r,n){return r==null?"":kg.call(r,n)}function Lr(r){var n=r==null?0:r.length;return n?r[n-1]:t}function Jy(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var y=h;return a!==t&&(y=je(a),y=y<0?Ht(h+y,0):Qt(y,h-1)),n===n?Cg(r,n,y):ro(r,lh,y,!0)}function Qy(r,n){return r&&r.length?zh(r,je(n)):t}var Xy=Ke(Rl);function Rl(r,n){return r&&r.length&&n&&n.length?oc(r,n):r}function Zy(r,n,a){return r&&r.length&&n&&n.length?oc(r,n,me(a,2)):r}function ev(r,n,a){return r&&r.length&&n&&n.length?oc(r,n,t,a):r}var tv=fi(function(r,n){var a=r==null?0:r.length,h=Xa(r,n);return kh(r,_t(n,function(y){return di(y,a)?+y:y}).sort(tl)),h});function rv(r,n){var a=[];if(!(r&&r.length))return a;var h=-1,y=[],m=r.length;for(n=me(n,3);++h<m;){var P=r[h];n(P,h,r)&&(a.push(P),y.push(h))}return kh(r,y),a}function xc(r){return r==null?r:Yg.call(r)}function iv(r,n,a){var h=r==null?0:r.length;return h?(a&&typeof a!="number"&&sr(r,n,a)?(n=0,a=h):(n=n==null?0:je(n),a=a===t?h:je(a)),Ur(r,n,a)):[]}function nv(r,n){return Do(r,n)}function sv(r,n,a){return uc(r,n,me(a,2))}function ov(r,n){var a=r==null?0:r.length;if(a){var h=Do(r,n);if(h<a&&kr(r[h],n))return h}return-1}function av(r,n){return Do(r,n,!0)}function cv(r,n,a){return uc(r,n,me(a,2),!0)}function uv(r,n){var a=r==null?0:r.length;if(a){var h=Do(r,n,!0)-1;if(kr(r[h],n))return h}return-1}function hv(r){return r&&r.length?Gh(r):[]}function lv(r,n){return r&&r.length?Gh(r,me(n,2)):[]}function fv(r){var n=r==null?0:r.length;return n?Ur(r,1,n):[]}function dv(r,n,a){return r&&r.length?(n=a||n===t?1:je(n),Ur(r,0,n<0?0:n)):[]}function pv(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:je(n),n=h-n,Ur(r,n<0?0:n,h)):[]}function gv(r,n){return r&&r.length?So(r,me(n,3),!1,!0):[]}function yv(r,n){return r&&r.length?So(r,me(n,3)):[]}var vv=Ke(function(r){return Ri(Wt(r,1,Rt,!0))}),_v=Ke(function(r){var n=Lr(r);return Rt(n)&&(n=t),Ri(Wt(r,1,Rt,!0),me(n,2))}),mv=Ke(function(r){var n=Lr(r);return n=typeof n=="function"?n:t,Ri(Wt(r,1,Rt,!0),t,n)});function wv(r){return r&&r.length?Ri(r):[]}function bv(r,n){return r&&r.length?Ri(r,me(n,2)):[]}function Ev(r,n){return n=typeof n=="function"?n:t,r&&r.length?Ri(r,t,n):[]}function Oc(r){if(!(r&&r.length))return[];var n=0;return r=Oi(r,function(a){if(Rt(a))return n=Ht(a.length,n),!0}),Ka(n,function(a){return _t(r,Ba(a))})}function Nl(r,n){if(!(r&&r.length))return[];var a=Oc(r);return n==null?a:_t(a,function(h){return Kt(n,t,h)})}var Dv=Ke(function(r,n){return Rt(r)?is(r,n):[]}),Sv=Ke(function(r){return lc(Oi(r,Rt))}),Iv=Ke(function(r){var n=Lr(r);return Rt(n)&&(n=t),lc(Oi(r,Rt),me(n,2))}),xv=Ke(function(r){var n=Lr(r);return n=typeof n=="function"?n:t,lc(Oi(r,Rt),t,n)}),Ov=Ke(Oc);function Pv(r,n){return Qh(r||[],n||[],rs)}function Cv(r,n){return Qh(r||[],n||[],os)}var Av=Ke(function(r){var n=r.length,a=n>1?r[n-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Nl(r,a)});function $l(r){var n=_(r);return n.__chain__=!0,n}function Tv(r,n){return n(r),r}function No(r,n){return n(r)}var Rv=fi(function(r){var n=r.length,a=n?r[0]:0,h=this.__wrapped__,y=function(m){return Xa(m,r)};return n>1||this.__actions__.length||!(h instanceof Ye)||!di(a)?this.thru(y):(h=h.slice(a,+a+(n?1:0)),h.__actions__.push({func:No,args:[y],thisArg:t}),new $r(h,this.__chain__).thru(function(m){return n&&!m.length&&m.push(t),m}))});function Nv(){return $l(this)}function $v(){return new $r(this.value(),this.__chain__)}function Fv(){this.__values__===t&&(this.__values__=Wl(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function Uv(){return this}function Lv(r){for(var n,a=this;a instanceof _o;){var h=Ol(a);h.__index__=0,h.__values__=t,n?y.__wrapped__=h:n=h;var y=h;a=a.__wrapped__}return y.__wrapped__=r,n}function jv(){var r=this.__wrapped__;if(r instanceof Ye){var n=r;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:No,args:[xc],thisArg:t}),new $r(n,this.__chain__)}return this.thru(xc)}function Mv(){return Jh(this.__wrapped__,this.__actions__)}var qv=Io(function(r,n,a){nt.call(r,a)?++r[a]:hi(r,a,1)});function Bv(r,n,a){var h=Re(r)?uh:T0;return a&&sr(r,n,a)&&(n=t),h(r,me(n,3))}function zv(r,n){var a=Re(r)?Oi:Nh;return a(r,me(n,3))}var Hv=al(Pl),Kv=al(Cl);function kv(r,n){return Wt($o(r,n),1)}function Vv(r,n){return Wt($o(r,n),Q)}function Gv(r,n,a){return a=a===t?1:je(a),Wt($o(r,n),a)}function Fl(r,n){var a=Re(r)?Rr:Ti;return a(r,me(n,3))}function Ul(r,n){var a=Re(r)?fg:Rh;return a(r,me(n,3))}var Wv=Io(function(r,n,a){nt.call(r,a)?r[a].push(n):hi(r,a,[n])});function Yv(r,n,a,h){r=gr(r)?r:Rn(r),a=a&&!h?je(a):0;var y=r.length;return a<0&&(a=Ht(y+a,0)),Mo(r)?a<=y&&r.indexOf(n,a)>-1:!!y&&wn(r,n,a)>-1}var Jv=Ke(function(r,n,a){var h=-1,y=typeof n=="function",m=gr(r)?K(r.length):[];return Ti(r,function(P){m[++h]=y?Kt(n,P,a):ns(P,n,a)}),m}),Qv=Io(function(r,n,a){hi(r,a,n)});function $o(r,n){var a=Re(r)?_t:Mh;return a(r,me(n,3))}function Xv(r,n,a,h){return r==null?[]:(Re(n)||(n=n==null?[]:[n]),a=h?t:a,Re(a)||(a=a==null?[]:[a]),Hh(r,n,a))}var Zv=Io(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function e1(r,n,a){var h=Re(r)?Ma:dh,y=arguments.length<3;return h(r,me(n,4),a,y,Ti)}function t1(r,n,a){var h=Re(r)?dg:dh,y=arguments.length<3;return h(r,me(n,4),a,y,Rh)}function r1(r,n){var a=Re(r)?Oi:Nh;return a(r,Lo(me(n,3)))}function i1(r){var n=Re(r)?Ph:Y0;return n(r)}function n1(r,n,a){(a?sr(r,n,a):n===t)?n=1:n=je(n);var h=Re(r)?x0:J0;return h(r,n)}function s1(r){var n=Re(r)?O0:X0;return n(r)}function o1(r){if(r==null)return 0;if(gr(r))return Mo(r)?En(r):r.length;var n=Xt(r);return n==Ie||n==xe?r.size:nc(r).length}function a1(r,n,a){var h=Re(r)?qa:Z0;return a&&sr(r,n,a)&&(n=t),h(r,me(n,3))}var c1=Ke(function(r,n){if(r==null)return[];var a=n.length;return a>1&&sr(r,n[0],n[1])?n=[]:a>2&&sr(n[0],n[1],n[2])&&(n=[n[0]]),Hh(r,Wt(n,1),[])}),Fo=zg||function(){return Xe.Date.now()};function u1(r,n){if(typeof n!="function")throw new Nr(l);return r=je(r),function(){if(--r<1)return n.apply(this,arguments)}}function Ll(r,n,a){return n=a?t:n,n=r&&n==null?r.length:n,li(r,u,t,t,t,t,n)}function jl(r,n){var a;if(typeof n!="function")throw new Nr(l);return r=je(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=t),a}}var Pc=Ke(function(r,n,a){var h=H;if(a.length){var y=Ci(a,An(Pc));h|=T}return li(r,h,n,a,y)}),Ml=Ke(function(r,n,a){var h=H|ie;if(a.length){var y=Ci(a,An(Ml));h|=T}return li(n,h,r,a,y)});function ql(r,n,a){n=a?t:n;var h=li(r,j,t,t,t,t,t,n);return h.placeholder=ql.placeholder,h}function Bl(r,n,a){n=a?t:n;var h=li(r,C,t,t,t,t,t,n);return h.placeholder=Bl.placeholder,h}function zl(r,n,a){var h,y,m,P,N,M,X=0,Z=!1,ne=!1,he=!0;if(typeof r!="function")throw new Nr(l);n=jr(n)||0,Et(a)&&(Z=!!a.leading,ne="maxWait"in a,m=ne?Ht(jr(a.maxWait)||0,n):m,he="trailing"in a?!!a.trailing:he);function ye(Nt){var Vr=h,yi=y;return h=y=t,X=Nt,P=r.apply(yi,Vr),P}function Ee(Nt){return X=Nt,N=us(Ge,n),Z?ye(Nt):P}function Be(Nt){var Vr=Nt-M,yi=Nt-X,cf=n-Vr;return ne?Qt(cf,m-yi):cf}function De(Nt){var Vr=Nt-M,yi=Nt-X;return M===t||Vr>=n||Vr<0||ne&&yi>=m}function Ge(){var Nt=Fo();if(De(Nt))return Ze(Nt);N=us(Ge,Be(Nt))}function Ze(Nt){return N=t,he&&h?ye(Nt):(h=y=t,P)}function Ir(){N!==t&&Xh(N),X=0,h=M=y=N=t}function or(){return N===t?P:Ze(Fo())}function xr(){var Nt=Fo(),Vr=De(Nt);if(h=arguments,y=this,M=Nt,Vr){if(N===t)return Ee(M);if(ne)return Xh(N),N=us(Ge,n),ye(M)}return N===t&&(N=us(Ge,n)),P}return xr.cancel=Ir,xr.flush=or,xr}var h1=Ke(function(r,n){return Th(r,1,n)}),l1=Ke(function(r,n,a){return Th(r,jr(n)||0,a)});function f1(r){return li(r,G)}function Uo(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Nr(l);var a=function(){var h=arguments,y=n?n.apply(this,h):h[0],m=a.cache;if(m.has(y))return m.get(y);var P=r.apply(this,h);return a.cache=m.set(y,P)||m,P};return a.cache=new(Uo.Cache||ui),a}Uo.Cache=ui;function Lo(r){if(typeof r!="function")throw new Nr(l);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function d1(r){return jl(2,r)}var p1=ey(function(r,n){n=n.length==1&&Re(n[0])?_t(n[0],Er(me())):_t(Wt(n,1),Er(me()));var a=n.length;return Ke(function(h){for(var y=-1,m=Qt(h.length,a);++y<m;)h[y]=n[y].call(this,h[y]);return Kt(r,this,h)})}),Cc=Ke(function(r,n){var a=Ci(n,An(Cc));return li(r,T,t,n,a)}),Hl=Ke(function(r,n){var a=Ci(n,An(Hl));return li(r,E,t,n,a)}),g1=fi(function(r,n){return li(r,w,t,t,t,n)});function y1(r,n){if(typeof r!="function")throw new Nr(l);return n=n===t?n:je(n),Ke(r,n)}function v1(r,n){if(typeof r!="function")throw new Nr(l);return n=n==null?0:Ht(je(n),0),Ke(function(a){var h=a[n],y=$i(a,0,n);return h&&Pi(y,h),Kt(r,this,y)})}function _1(r,n,a){var h=!0,y=!0;if(typeof r!="function")throw new Nr(l);return Et(a)&&(h="leading"in a?!!a.leading:h,y="trailing"in a?!!a.trailing:y),zl(r,n,{leading:h,maxWait:n,trailing:y})}function m1(r){return Ll(r,1)}function w1(r,n){return Cc(dc(n),r)}function b1(){if(!arguments.length)return[];var r=arguments[0];return Re(r)?r:[r]}function E1(r){return Fr(r,x)}function D1(r,n){return n=typeof n=="function"?n:t,Fr(r,x,n)}function S1(r){return Fr(r,D|x)}function I1(r,n){return n=typeof n=="function"?n:t,Fr(r,D|x,n)}function x1(r,n){return n==null||Ah(r,n,kt(n))}function kr(r,n){return r===n||r!==r&&n!==n}var O1=Co(tc),P1=Co(function(r,n){return r>=n}),en=Uh(function(){return arguments}())?Uh:function(r){return Ct(r)&&nt.call(r,"callee")&&!Eh.call(r,"callee")},Re=K.isArray,C1=ir?Er(ir):L0;function gr(r){return r!=null&&jo(r.length)&&!pi(r)}function Rt(r){return Ct(r)&&gr(r)}function A1(r){return r===!0||r===!1||Ct(r)&&nr(r)==B}var Fi=Kg||qc,T1=zr?Er(zr):j0;function R1(r){return Ct(r)&&r.nodeType===1&&!hs(r)}function N1(r){if(r==null)return!0;if(gr(r)&&(Re(r)||typeof r=="string"||typeof r.splice=="function"||Fi(r)||Tn(r)||en(r)))return!r.length;var n=Xt(r);if(n==Ie||n==xe)return!r.size;if(cs(r))return!nc(r).length;for(var a in r)if(nt.call(r,a))return!1;return!0}function $1(r,n){return ss(r,n)}function F1(r,n,a){a=typeof a=="function"?a:t;var h=a?a(r,n):t;return h===t?ss(r,n,t,a):!!h}function Ac(r){if(!Ct(r))return!1;var n=nr(r);return n==R||n==d||typeof r.message=="string"&&typeof r.name=="string"&&!hs(r)}function U1(r){return typeof r=="number"&&Sh(r)}function pi(r){if(!Et(r))return!1;var n=nr(r);return n==ae||n==fe||n==z||n==gt}function Kl(r){return typeof r=="number"&&r==je(r)}function jo(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=k}function Et(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function Ct(r){return r!=null&&typeof r=="object"}var kl=Tr?Er(Tr):q0;function L1(r,n){return r===n||ic(r,n,wc(n))}function j1(r,n,a){return a=typeof a=="function"?a:t,ic(r,n,wc(n),a)}function M1(r){return Vl(r)&&r!=+r}function q1(r){if(Dy(r))throw new Ae(c);return Lh(r)}function B1(r){return r===null}function z1(r){return r==null}function Vl(r){return typeof r=="number"||Ct(r)&&nr(r)==ze}function hs(r){if(!Ct(r)||nr(r)!=Le)return!1;var n=ho(r);if(n===null)return!0;var a=nt.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&oo.call(a)==jg}var Tc=Xr?Er(Xr):B0;function H1(r){return Kl(r)&&r>=-k&&r<=k}var Gl=Yn?Er(Yn):z0;function Mo(r){return typeof r=="string"||!Re(r)&&Ct(r)&&nr(r)==Ne}function Sr(r){return typeof r=="symbol"||Ct(r)&&nr(r)==$e}var Tn=Vi?Er(Vi):H0;function K1(r){return r===t}function k1(r){return Ct(r)&&Xt(r)==Pe}function V1(r){return Ct(r)&&nr(r)==Fe}var G1=Co(sc),W1=Co(function(r,n){return r<=n});function Wl(r){if(!r)return[];if(gr(r))return Mo(r)?Hr(r):pr(r);if(Qn&&r[Qn])return xg(r[Qn]());var n=Xt(r),a=n==Ie?Va:n==xe?io:Rn;return a(r)}function gi(r){if(!r)return r===0?r:0;if(r=jr(r),r===Q||r===-Q){var n=r<0?-1:1;return n*V}return r===r?r:0}function je(r){var n=gi(r),a=n%1;return n===n?a?n-a:n:0}function Yl(r){return r?Ji(je(r),0,re):0}function jr(r){if(typeof r=="number")return r;if(Sr(r))return J;if(Et(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=Et(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=ph(r);var a=ba.test(r);return a||Da.test(r)?Te(r.slice(2),a?2:8):wa.test(r)?J:+r}function Jl(r){return ei(r,yr(r))}function Y1(r){return r?Ji(je(r),-k,k):r===0?r:0}function it(r){return r==null?"":Dr(r)}var J1=Pn(function(r,n){if(cs(n)||gr(n)){ei(n,kt(n),r);return}for(var a in n)nt.call(n,a)&&rs(r,a,n[a])}),Ql=Pn(function(r,n){ei(n,yr(n),r)}),qo=Pn(function(r,n,a,h){ei(n,yr(n),r,h)}),Q1=Pn(function(r,n,a,h){ei(n,kt(n),r,h)}),X1=fi(Xa);function Z1(r,n){var a=On(r);return n==null?a:Ch(a,n)}var e_=Ke(function(r,n){r=ut(r);var a=-1,h=n.length,y=h>2?n[2]:t;for(y&&sr(n[0],n[1],y)&&(h=1);++a<h;)for(var m=n[a],P=yr(m),N=-1,M=P.length;++N<M;){var X=P[N],Z=r[X];(Z===t||kr(Z,Sn[X])&&!nt.call(r,X))&&(r[X]=m[X])}return r}),t_=Ke(function(r){return r.push(t,pl),Kt(Xl,t,r)});function r_(r,n){return hh(r,me(n,3),Zr)}function i_(r,n){return hh(r,me(n,3),ec)}function n_(r,n){return r==null?r:Za(r,me(n,3),yr)}function s_(r,n){return r==null?r:$h(r,me(n,3),yr)}function o_(r,n){return r&&Zr(r,me(n,3))}function a_(r,n){return r&&ec(r,me(n,3))}function c_(r){return r==null?[]:bo(r,kt(r))}function u_(r){return r==null?[]:bo(r,yr(r))}function Rc(r,n,a){var h=r==null?t:Qi(r,n);return h===t?a:h}function h_(r,n){return r!=null&&vl(r,n,N0)}function Nc(r,n){return r!=null&&vl(r,n,$0)}var l_=ul(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=ao.call(n)),r[n]=a},Fc(vr)),f_=ul(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=ao.call(n)),nt.call(r,n)?r[n].push(a):r[n]=[a]},me),d_=Ke(ns);function kt(r){return gr(r)?Oh(r):nc(r)}function yr(r){return gr(r)?Oh(r,!0):K0(r)}function p_(r,n){var a={};return n=me(n,3),Zr(r,function(h,y,m){hi(a,n(h,y,m),h)}),a}function g_(r,n){var a={};return n=me(n,3),Zr(r,function(h,y,m){hi(a,y,n(h,y,m))}),a}var y_=Pn(function(r,n,a){Eo(r,n,a)}),Xl=Pn(function(r,n,a,h){Eo(r,n,a,h)}),v_=fi(function(r,n){var a={};if(r==null)return a;var h=!1;n=_t(n,function(m){return m=Ni(m,r),h||(h=m.length>1),m}),ei(r,_c(r),a),h&&(a=Fr(a,D|S|x,ly));for(var y=n.length;y--;)hc(a,n[y]);return a});function __(r,n){return Zl(r,Lo(me(n)))}var m_=fi(function(r,n){return r==null?{}:V0(r,n)});function Zl(r,n){if(r==null)return{};var a=_t(_c(r),function(h){return[h]});return n=me(n),Kh(r,a,function(h,y){return n(h,y[0])})}function w_(r,n,a){n=Ni(n,r);var h=-1,y=n.length;for(y||(y=1,r=t);++h<y;){var m=r==null?t:r[ti(n[h])];m===t&&(h=y,m=a),r=pi(m)?m.call(r):m}return r}function b_(r,n,a){return r==null?r:os(r,n,a)}function E_(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:os(r,n,a,h)}var ef=fl(kt),tf=fl(yr);function D_(r,n,a){var h=Re(r),y=h||Fi(r)||Tn(r);if(n=me(n,4),a==null){var m=r&&r.constructor;y?a=h?new m:[]:Et(r)?a=pi(m)?On(ho(r)):{}:a={}}return(y?Rr:Zr)(r,function(P,N,M){return n(a,P,N,M)}),a}function S_(r,n){return r==null?!0:hc(r,n)}function I_(r,n,a){return r==null?r:Yh(r,n,dc(a))}function x_(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:Yh(r,n,dc(a),h)}function Rn(r){return r==null?[]:ka(r,kt(r))}function O_(r){return r==null?[]:ka(r,yr(r))}function P_(r,n,a){return a===t&&(a=n,n=t),a!==t&&(a=jr(a),a=a===a?a:0),n!==t&&(n=jr(n),n=n===n?n:0),Ji(jr(r),n,a)}function C_(r,n,a){return n=gi(n),a===t?(a=n,n=0):a=gi(a),r=jr(r),F0(r,n,a)}function A_(r,n,a){if(a&&typeof a!="boolean"&&sr(r,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&n===t?(r=0,n=1):(r=gi(r),n===t?(n=r,r=0):n=gi(n)),r>n){var h=r;r=n,n=h}if(a||r%1||n%1){var y=Ih();return Qt(r+y*(n-r+at("1e-"+((y+"").length-1))),n)}return ac(r,n)}var T_=Cn(function(r,n,a){return n=n.toLowerCase(),r+(a?rf(n):n)});function rf(r){return $c(it(r).toLowerCase())}function nf(r){return r=it(r),r&&r.replace(oi,bg).replace(Ua,"")}function R_(r,n,a){r=it(r),n=Dr(n);var h=r.length;a=a===t?h:Ji(je(a),0,h);var y=a;return a-=n.length,a>=0&&r.slice(a,y)==n}function N_(r){return r=it(r),r&&yt.test(r)?r.replace(Bi,Eg):r}function $_(r){return r=it(r),r&&Lt.test(r)?r.replace(xt,"\\$&"):r}var F_=Cn(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),U_=Cn(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),L_=ol("toLowerCase");function j_(r,n,a){r=it(r),n=je(n);var h=n?En(r):0;if(!n||h>=n)return r;var y=(n-h)/2;return Po(go(y),a)+r+Po(po(y),a)}function M_(r,n,a){r=it(r),n=je(n);var h=n?En(r):0;return n&&h<n?r+Po(n-h,a):r}function q_(r,n,a){r=it(r),n=je(n);var h=n?En(r):0;return n&&h<n?Po(n-h,a)+r:r}function B_(r,n,a){return a||n==null?n=0:n&&(n=+n),Wg(it(r).replace(Ot,""),n||0)}function z_(r,n,a){return(a?sr(r,n,a):n===t)?n=1:n=je(n),cc(it(r),n)}function H_(){var r=arguments,n=it(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var K_=Cn(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function k_(r,n,a){return a&&typeof a!="number"&&sr(r,n,a)&&(n=a=t),a=a===t?re:a>>>0,a?(r=it(r),r&&(typeof n=="string"||n!=null&&!Tc(n))&&(n=Dr(n),!n&&bn(r))?$i(Hr(r),0,a):r.split(n,a)):[]}var V_=Cn(function(r,n,a){return r+(a?" ":"")+$c(n)});function G_(r,n,a){return r=it(r),a=a==null?0:Ji(je(a),0,r.length),n=Dr(n),r.slice(a,a+n.length)==n}function W_(r,n,a){var h=_.templateSettings;a&&sr(r,n,a)&&(n=t),r=it(r),n=qo({},n,h,dl);var y=qo({},n.imports,h.imports,dl),m=kt(y),P=ka(y,m),N,M,X=0,Z=n.interpolate||dn,ne="__p += '",he=Ga((n.escape||dn).source+"|"+Z.source+"|"+(Z===bt?ma:dn).source+"|"+(n.evaluate||dn).source+"|$","g"),ye="//# sourceURL="+(nt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++La+"]")+`
`;r.replace(he,function(De,Ge,Ze,Ir,or,xr){return Ze||(Ze=Ir),ne+=r.slice(X,xr).replace(Ia,Dg),Ge&&(N=!0,ne+=`' +
__e(`+Ge+`) +
'`),or&&(M=!0,ne+=`';
`+or+`;
__p += '`),Ze&&(ne+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),X=xr+De.length,De}),ne+=`';
`;var Ee=nt.call(n,"variable")&&n.variable;if(!Ee)ne=`with (obj) {
`+ne+`
}
`;else if(va.test(Ee))throw new Ae(f);ne=(M?ne.replace(Jr,""):ne).replace(rr,"$1").replace(si,"$1;"),ne="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(M?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ne+`return __p
}`;var Be=of(function(){return rt(m,ye+"return "+ne).apply(t,P)});if(Be.source=ne,Ac(Be))throw Be;return Be}function Y_(r){return it(r).toLowerCase()}function J_(r){return it(r).toUpperCase()}function Q_(r,n,a){if(r=it(r),r&&(a||n===t))return ph(r);if(!r||!(n=Dr(n)))return r;var h=Hr(r),y=Hr(n),m=gh(h,y),P=yh(h,y)+1;return $i(h,m,P).join("")}function X_(r,n,a){if(r=it(r),r&&(a||n===t))return r.slice(0,_h(r)+1);if(!r||!(n=Dr(n)))return r;var h=Hr(r),y=yh(h,Hr(n))+1;return $i(h,0,y).join("")}function Z_(r,n,a){if(r=it(r),r&&(a||n===t))return r.replace(Ot,"");if(!r||!(n=Dr(n)))return r;var h=Hr(r),y=gh(h,Hr(n));return $i(h,y).join("")}function em(r,n){var a=W,h=se;if(Et(n)){var y="separator"in n?n.separator:y;a="length"in n?je(n.length):a,h="omission"in n?Dr(n.omission):h}r=it(r);var m=r.length;if(bn(r)){var P=Hr(r);m=P.length}if(a>=m)return r;var N=a-En(h);if(N<1)return h;var M=P?$i(P,0,N).join(""):r.slice(0,N);if(y===t)return M+h;if(P&&(N+=M.length-N),Tc(y)){if(r.slice(N).search(y)){var X,Z=M;for(y.global||(y=Ga(y.source,it(Ar.exec(y))+"g")),y.lastIndex=0;X=y.exec(Z);)var ne=X.index;M=M.slice(0,ne===t?N:ne)}}else if(r.indexOf(Dr(y),N)!=N){var he=M.lastIndexOf(y);he>-1&&(M=M.slice(0,he))}return M+h}function tm(r){return r=it(r),r&&Dt.test(r)?r.replace(Ii,Ag):r}var rm=Cn(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),$c=ol("toUpperCase");function sf(r,n,a){return r=it(r),n=a?t:n,n===t?Ig(r)?Ng(r):yg(r):r.match(n)||[]}var of=Ke(function(r,n){try{return Kt(r,t,n)}catch(a){return Ac(a)?a:new Ae(a)}}),im=fi(function(r,n){return Rr(n,function(a){a=ti(a),hi(r,a,Pc(r[a],r))}),r});function nm(r){var n=r==null?0:r.length,a=me();return r=n?_t(r,function(h){if(typeof h[1]!="function")throw new Nr(l);return[a(h[0]),h[1]]}):[],Ke(function(h){for(var y=-1;++y<n;){var m=r[y];if(Kt(m[0],this,h))return Kt(m[1],this,h)}})}function sm(r){return A0(Fr(r,D))}function Fc(r){return function(){return r}}function om(r,n){return r==null||r!==r?n:r}var am=cl(),cm=cl(!0);function vr(r){return r}function Uc(r){return jh(typeof r=="function"?r:Fr(r,D))}function um(r){return qh(Fr(r,D))}function hm(r,n){return Bh(r,Fr(n,D))}var lm=Ke(function(r,n){return function(a){return ns(a,r,n)}}),fm=Ke(function(r,n){return function(a){return ns(r,a,n)}});function Lc(r,n,a){var h=kt(n),y=bo(n,h);a==null&&!(Et(n)&&(y.length||!h.length))&&(a=n,n=r,r=this,y=bo(n,kt(n)));var m=!(Et(a)&&"chain"in a)||!!a.chain,P=pi(r);return Rr(y,function(N){var M=n[N];r[N]=M,P&&(r.prototype[N]=function(){var X=this.__chain__;if(m||X){var Z=r(this.__wrapped__),ne=Z.__actions__=pr(this.__actions__);return ne.push({func:M,args:arguments,thisArg:r}),Z.__chain__=X,Z}return M.apply(r,Pi([this.value()],arguments))})}),r}function dm(){return Xe._===this&&(Xe._=Mg),this}function jc(){}function pm(r){return r=je(r),Ke(function(n){return zh(n,r)})}var gm=gc(_t),ym=gc(uh),vm=gc(qa);function af(r){return Ec(r)?Ba(ti(r)):G0(r)}function _m(r){return function(n){return r==null?t:Qi(r,n)}}var mm=hl(),wm=hl(!0);function Mc(){return[]}function qc(){return!1}function bm(){return{}}function Em(){return""}function Dm(){return!0}function Sm(r,n){if(r=je(r),r<1||r>k)return[];var a=re,h=Qt(r,re);n=me(n),r-=re;for(var y=Ka(h,n);++a<r;)n(a);return y}function Im(r){return Re(r)?_t(r,ti):Sr(r)?[r]:pr(xl(it(r)))}function xm(r){var n=++Lg;return it(r)+n}var Om=Oo(function(r,n){return r+n},0),Pm=yc("ceil"),Cm=Oo(function(r,n){return r/n},1),Am=yc("floor");function Tm(r){return r&&r.length?wo(r,vr,tc):t}function Rm(r,n){return r&&r.length?wo(r,me(n,2),tc):t}function Nm(r){return fh(r,vr)}function $m(r,n){return fh(r,me(n,2))}function Fm(r){return r&&r.length?wo(r,vr,sc):t}function Um(r,n){return r&&r.length?wo(r,me(n,2),sc):t}var Lm=Oo(function(r,n){return r*n},1),jm=yc("round"),Mm=Oo(function(r,n){return r-n},0);function qm(r){return r&&r.length?Ha(r,vr):0}function Bm(r,n){return r&&r.length?Ha(r,me(n,2)):0}return _.after=u1,_.ary=Ll,_.assign=J1,_.assignIn=Ql,_.assignInWith=qo,_.assignWith=Q1,_.at=X1,_.before=jl,_.bind=Pc,_.bindAll=im,_.bindKey=Ml,_.castArray=b1,_.chain=$l,_.chunk=Ay,_.compact=Ty,_.concat=Ry,_.cond=nm,_.conforms=sm,_.constant=Fc,_.countBy=qv,_.create=Z1,_.curry=ql,_.curryRight=Bl,_.debounce=zl,_.defaults=e_,_.defaultsDeep=t_,_.defer=h1,_.delay=l1,_.difference=Ny,_.differenceBy=$y,_.differenceWith=Fy,_.drop=Uy,_.dropRight=Ly,_.dropRightWhile=jy,_.dropWhile=My,_.fill=qy,_.filter=zv,_.flatMap=kv,_.flatMapDeep=Vv,_.flatMapDepth=Gv,_.flatten=Al,_.flattenDeep=By,_.flattenDepth=zy,_.flip=f1,_.flow=am,_.flowRight=cm,_.fromPairs=Hy,_.functions=c_,_.functionsIn=u_,_.groupBy=Wv,_.initial=ky,_.intersection=Vy,_.intersectionBy=Gy,_.intersectionWith=Wy,_.invert=l_,_.invertBy=f_,_.invokeMap=Jv,_.iteratee=Uc,_.keyBy=Qv,_.keys=kt,_.keysIn=yr,_.map=$o,_.mapKeys=p_,_.mapValues=g_,_.matches=um,_.matchesProperty=hm,_.memoize=Uo,_.merge=y_,_.mergeWith=Xl,_.method=lm,_.methodOf=fm,_.mixin=Lc,_.negate=Lo,_.nthArg=pm,_.omit=v_,_.omitBy=__,_.once=d1,_.orderBy=Xv,_.over=gm,_.overArgs=p1,_.overEvery=ym,_.overSome=vm,_.partial=Cc,_.partialRight=Hl,_.partition=Zv,_.pick=m_,_.pickBy=Zl,_.property=af,_.propertyOf=_m,_.pull=Xy,_.pullAll=Rl,_.pullAllBy=Zy,_.pullAllWith=ev,_.pullAt=tv,_.range=mm,_.rangeRight=wm,_.rearg=g1,_.reject=r1,_.remove=rv,_.rest=y1,_.reverse=xc,_.sampleSize=n1,_.set=b_,_.setWith=E_,_.shuffle=s1,_.slice=iv,_.sortBy=c1,_.sortedUniq=hv,_.sortedUniqBy=lv,_.split=k_,_.spread=v1,_.tail=fv,_.take=dv,_.takeRight=pv,_.takeRightWhile=gv,_.takeWhile=yv,_.tap=Tv,_.throttle=_1,_.thru=No,_.toArray=Wl,_.toPairs=ef,_.toPairsIn=tf,_.toPath=Im,_.toPlainObject=Jl,_.transform=D_,_.unary=m1,_.union=vv,_.unionBy=_v,_.unionWith=mv,_.uniq=wv,_.uniqBy=bv,_.uniqWith=Ev,_.unset=S_,_.unzip=Oc,_.unzipWith=Nl,_.update=I_,_.updateWith=x_,_.values=Rn,_.valuesIn=O_,_.without=Dv,_.words=sf,_.wrap=w1,_.xor=Sv,_.xorBy=Iv,_.xorWith=xv,_.zip=Ov,_.zipObject=Pv,_.zipObjectDeep=Cv,_.zipWith=Av,_.entries=ef,_.entriesIn=tf,_.extend=Ql,_.extendWith=qo,Lc(_,_),_.add=Om,_.attempt=of,_.camelCase=T_,_.capitalize=rf,_.ceil=Pm,_.clamp=P_,_.clone=E1,_.cloneDeep=S1,_.cloneDeepWith=I1,_.cloneWith=D1,_.conformsTo=x1,_.deburr=nf,_.defaultTo=om,_.divide=Cm,_.endsWith=R_,_.eq=kr,_.escape=N_,_.escapeRegExp=$_,_.every=Bv,_.find=Hv,_.findIndex=Pl,_.findKey=r_,_.findLast=Kv,_.findLastIndex=Cl,_.findLastKey=i_,_.floor=Am,_.forEach=Fl,_.forEachRight=Ul,_.forIn=n_,_.forInRight=s_,_.forOwn=o_,_.forOwnRight=a_,_.get=Rc,_.gt=O1,_.gte=P1,_.has=h_,_.hasIn=Nc,_.head=Tl,_.identity=vr,_.includes=Yv,_.indexOf=Ky,_.inRange=C_,_.invoke=d_,_.isArguments=en,_.isArray=Re,_.isArrayBuffer=C1,_.isArrayLike=gr,_.isArrayLikeObject=Rt,_.isBoolean=A1,_.isBuffer=Fi,_.isDate=T1,_.isElement=R1,_.isEmpty=N1,_.isEqual=$1,_.isEqualWith=F1,_.isError=Ac,_.isFinite=U1,_.isFunction=pi,_.isInteger=Kl,_.isLength=jo,_.isMap=kl,_.isMatch=L1,_.isMatchWith=j1,_.isNaN=M1,_.isNative=q1,_.isNil=z1,_.isNull=B1,_.isNumber=Vl,_.isObject=Et,_.isObjectLike=Ct,_.isPlainObject=hs,_.isRegExp=Tc,_.isSafeInteger=H1,_.isSet=Gl,_.isString=Mo,_.isSymbol=Sr,_.isTypedArray=Tn,_.isUndefined=K1,_.isWeakMap=k1,_.isWeakSet=V1,_.join=Yy,_.kebabCase=F_,_.last=Lr,_.lastIndexOf=Jy,_.lowerCase=U_,_.lowerFirst=L_,_.lt=G1,_.lte=W1,_.max=Tm,_.maxBy=Rm,_.mean=Nm,_.meanBy=$m,_.min=Fm,_.minBy=Um,_.stubArray=Mc,_.stubFalse=qc,_.stubObject=bm,_.stubString=Em,_.stubTrue=Dm,_.multiply=Lm,_.nth=Qy,_.noConflict=dm,_.noop=jc,_.now=Fo,_.pad=j_,_.padEnd=M_,_.padStart=q_,_.parseInt=B_,_.random=A_,_.reduce=e1,_.reduceRight=t1,_.repeat=z_,_.replace=H_,_.result=w_,_.round=jm,_.runInContext=L,_.sample=i1,_.size=o1,_.snakeCase=K_,_.some=a1,_.sortedIndex=nv,_.sortedIndexBy=sv,_.sortedIndexOf=ov,_.sortedLastIndex=av,_.sortedLastIndexBy=cv,_.sortedLastIndexOf=uv,_.startCase=V_,_.startsWith=G_,_.subtract=Mm,_.sum=qm,_.sumBy=Bm,_.template=W_,_.times=Sm,_.toFinite=gi,_.toInteger=je,_.toLength=Yl,_.toLower=Y_,_.toNumber=jr,_.toSafeInteger=Y1,_.toString=it,_.toUpper=J_,_.trim=Q_,_.trimEnd=X_,_.trimStart=Z_,_.truncate=em,_.unescape=tm,_.uniqueId=xm,_.upperCase=rm,_.upperFirst=$c,_.each=Fl,_.eachRight=Ul,_.first=Tl,Lc(_,function(){var r={};return Zr(_,function(n,a){nt.call(_.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),_.VERSION=s,Rr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){_[r].placeholder=_}),Rr(["drop","take"],function(r,n){Ye.prototype[r]=function(a){a=a===t?1:Ht(je(a),0);var h=this.__filtered__&&!n?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Qt(a,h.__takeCount__):h.__views__.push({size:Qt(a,re),type:r+(h.__dir__<0?"Right":"")}),h},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Rr(["filter","map","takeWhile"],function(r,n){var a=n+1,h=a==b||a==ee;Ye.prototype[r]=function(y){var m=this.clone();return m.__iteratees__.push({iteratee:me(y,3),type:a}),m.__filtered__=m.__filtered__||h,m}}),Rr(["head","last"],function(r,n){var a="take"+(n?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Rr(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(vr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Ye(this):this.map(function(a){return ns(a,r,n)})}),Ye.prototype.reject=function(r){return this.filter(Lo(me(r)))},Ye.prototype.slice=function(r,n){r=je(r);var a=this;return a.__filtered__&&(r>0||n<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==t&&(n=je(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Zr(Ye.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),h=/^(?:head|last)$/.test(n),y=_[h?"take"+(n=="last"?"Right":""):n],m=h||/^find/.test(n);y&&(_.prototype[n]=function(){var P=this.__wrapped__,N=h?[1]:arguments,M=P instanceof Ye,X=N[0],Z=M||Re(P),ne=function(Ge){var Ze=y.apply(_,Pi([Ge],N));return h&&he?Ze[0]:Ze};Z&&a&&typeof X=="function"&&X.length!=1&&(M=Z=!1);var he=this.__chain__,ye=!!this.__actions__.length,Ee=m&&!he,Be=M&&!ye;if(!m&&Z){P=Be?P:new Ye(this);var De=r.apply(P,N);return De.__actions__.push({func:No,args:[ne],thisArg:t}),new $r(De,he)}return Ee&&Be?r.apply(this,N):(De=this.thru(ne),Ee?h?De.value()[0]:De.value():De)})}),Rr(["pop","push","shift","sort","splice","unshift"],function(r){var n=no[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",h=/^(?:pop|shift)$/.test(r);_.prototype[r]=function(){var y=arguments;if(h&&!this.__chain__){var m=this.value();return n.apply(Re(m)?m:[],y)}return this[a](function(P){return n.apply(Re(P)?P:[],y)})}}),Zr(Ye.prototype,function(r,n){var a=_[n];if(a){var h=a.name+"";nt.call(xn,h)||(xn[h]=[]),xn[h].push({name:n,func:a})}}),xn[xo(t,ie).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=t0,Ye.prototype.reverse=r0,Ye.prototype.value=i0,_.prototype.at=Rv,_.prototype.chain=Nv,_.prototype.commit=$v,_.prototype.next=Fv,_.prototype.plant=Lv,_.prototype.reverse=jv,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=Mv,_.prototype.first=_.prototype.head,Qn&&(_.prototype[Qn]=Uv),_},Dn=$g();Tt?((Tt.exports=Dn)._=Dn,ct._=Dn):Xe._=Dn}).call(vs)})(ju,ju.exports);var z5=Object.defineProperty,H5=Object.defineProperties,K5=Object.getOwnPropertyDescriptors,jd=Object.getOwnPropertySymbols,k5=Object.prototype.hasOwnProperty,V5=Object.prototype.propertyIsEnumerable,Md=(i,e,t)=>e in i?z5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ko=(i,e)=>{for(var t in e||(e={}))k5.call(e,t)&&Md(i,t,e[t]);if(jd)for(var t of jd(e))V5.call(e,t)&&Md(i,t,e[t]);return i},G5=(i,e)=>H5(i,K5(e));function ji(i,e,t){var s;const o=NE(i);return((s=e.rpcMap)==null?void 0:s[o.reference])||`${B5}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function fn(i){return i.includes(":")?i.split(":")[1]:i}function ug(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function W5(i,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(i));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function qd(i={},e={}){const t=Bd(i),s=Bd(e);return ju.exports.merge(t,s)}function Bd(i){var e,t,s,o;const c={};if(!Is(i))return c;for(const[l,f]of Object.entries(i)){const g=Xu(l)?[l]:f.chains,p=f.methods||[],v=f.events||[],D=f.rpcMap||{},S=_s(l);c[S]=G5(ko(ko({},c[S]),f),{chains:Vc(g,(e=c[S])==null?void 0:e.chains),methods:Vc(p,(t=c[S])==null?void 0:t.methods),events:Vc(v,(s=c[S])==null?void 0:s.events),rpcMap:ko(ko({},D),(o=c[S])==null?void 0:o.rpcMap)})}return c}function Y5(i){return i.includes(":")?i.split(":")[2]:i}function J5(i){const e={};for(const[t,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],l=s.accounts||[],f=Xu(t)?[t]:s.chains?s.chains:ug(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:l}}return e}function ou(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):(i=i.includes(":")?i.split(":")[1]:i,isNaN(Number(i))?i:Number(i))}const hg={},wt=i=>hg[i],au=(i,e)=>{hg[i]=e};class Q5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Di(new qi(s,wt("disableProviderPing")))}}class X5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||ji(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Di(new qi(s,wt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=parseInt(fn(t));e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class Z5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Di(new qi(s,wt("disableProviderPing")))}}class ex{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Di(new qi(s,wt("disableProviderPing")))}}class tx{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),o=fn(t);e[o]=this.createHttpProvider(o,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Di(new qi(s,wt("disableProviderPing")))}}class rx{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Di(new qi(s,wt("disableProviderPing")))}}class ix{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Di(new qi(s,wt("disableProviderPing")))}}class nx{constructor(e){this.name="near",this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||ji(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Si.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace);return typeof s>"u"?void 0:new Di(new qi(s,wt("disableProviderPing")))}}var sx=Object.defineProperty,ox=Object.defineProperties,ax=Object.getOwnPropertyDescriptors,zd=Object.getOwnPropertySymbols,cx=Object.prototype.hasOwnProperty,ux=Object.prototype.propertyIsEnumerable,Hd=(i,e,t)=>e in i?sx(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Vo=(i,e)=>{for(var t in e||(e={}))cx.call(e,t)&&Hd(i,t,e[t]);if(zd)for(var t of zd(e))ux.call(e,t)&&Hd(i,t,e[t]);return i},cu=(i,e)=>ox(i,ax(e));class ah{constructor(e){this.events=new Bu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Ud})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new ah(e);return await t.initialize(),t}async request(e,t,s){const[o,c]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:Vo({},e),chainId:`${o}:${c}`,topic:this.session.topic,expiry:s})}sendAsync(e,t,s,o){const c=new Date().getTime();this.request(e,s,o).then(l=>t(null,fa(c,l))).catch(l=>t(l,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:mt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c;const l=J5(c.namespaces);this.namespaces=qd(this.namespaces,l),this.persist("namespaces",this.namespaces)}).catch(c=>{if(c.message!==ag)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(ni(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await $5.init({logger:this.providerOpts.logger||Ud,relayUrl:this.providerOpts.relayUrl||j5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>_s(t)))];au("client",this.client),au("events",this.events),au("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=W5(t,this.session),o=ug(s),c=qd(this.namespaces,this.optionalNamespaces),l=cu(Vo({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new X5({namespace:l});break;case"solana":this.rpcProviders[t]=new Z5({namespace:l});break;case"cosmos":this.rpcProviders[t]=new ex({namespace:l});break;case"polkadot":this.rpcProviders[t]=new Q5({namespace:l});break;case"cip34":this.rpcProviders[t]=new tx({namespace:l});break;case"elrond":this.rpcProviders[t]=new rx({namespace:l});break;case"multiversx":this.rpcProviders[t]=new ix({namespace:l});break;case"near":this.rpcProviders[t]=new nx({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&ni(o)&&this.events.emit("accountsChanged",o.map(Y5))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,l=_s(o),f=ou(o)!==ou(c)?`${l}:${ou(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=cu(Vo({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",cu(Vo({},mt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Si.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(l=>_s(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=_s(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[s,o]=this.validateChain(e);o&&(t||this.getProvider(s).setDefaultChain(o),this.namespaces[s]?this.namespaces[s].defaultChain=o:this.namespaces[`${s}:${o}`]?this.namespaces[`${s}:${o}`].defaultChain=o:this.namespaces[`${s}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Ld}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Ld}/${e}`)}}const hx=ah,lx="wc",fx="ethereum_provider",dx=`${lx}@2:${fx}:`,px="https://rpc.walletconnect.com/v1/",Mu=["eth_sendTransaction","personal_sign"],gx=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],qu=["chainChanged","accountsChanged"],yx=["chainChanged","accountsChanged","message","disconnect","connect"];var vx=Object.defineProperty,_x=Object.defineProperties,mx=Object.getOwnPropertyDescriptors,Kd=Object.getOwnPropertySymbols,wx=Object.prototype.hasOwnProperty,bx=Object.prototype.propertyIsEnumerable,kd=(i,e,t)=>e in i?vx(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ws=(i,e)=>{for(var t in e||(e={}))wx.call(e,t)&&kd(i,t,e[t]);if(Kd)for(var t of Kd(e))bx.call(e,t)&&kd(i,t,e[t]);return i},Vd=(i,e)=>_x(i,mx(e));function ra(i){return Number(i[0].split(":")[1])}function uu(i){return`0x${i.toString(16)}`}function Ex(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:l,rpcMap:f}=i;if(!ni(e))throw new Error("Invalid chains");const g={chains:e,methods:s||Mu,events:c||qu,rpcMap:ws({},e.length?{[ra(e)]:f[ra(e)]}:{})},p=c==null?void 0:c.filter(x=>!qu.includes(x)),v=s==null?void 0:s.filter(x=>!Mu.includes(x));if(!t&&!l&&!o&&!(p!=null&&p.length)&&!(v!=null&&v.length))return{required:e.length?g:void 0};const D=(p==null?void 0:p.length)&&(v==null?void 0:v.length)||!t,S={chains:[...new Set(D?g.chains.concat(t||[]):t)],methods:[...new Set(g.methods.concat(o!=null&&o.length?o:gx))],events:[...new Set(g.events.concat(l!=null&&l.length?l:yx))],rpcMap:f};return{required:e.length?g:void 0,optional:t.length?S:void 0}}class ch{constructor(){this.events=new qr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=dx,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new ch;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,s){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),s)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=Ex(this.rpc);try{const o=await new Promise(async(l,f)=>{var g;this.rpc.showQrModal&&((g=this.modal)==null||g.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Vd(ws({namespaces:ws({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(p=>{l(p)}).catch(p=>{f(new Error(p.message))})});if(!o)return;const c=$E(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:uu(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",uu(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Vd(ws({},mt("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",uu(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],l=o.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||Mu:[],g=o.length?(e==null?void 0:e.events)||qu:[],p=(e==null?void 0:e.optionalMethods)||[],v=(e==null?void 0:e.optionalEvents)||[],D=(e==null?void 0:e.rpcMap)||this.buildRpcMap(l,e.projectId),S=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(x=>this.formatChainId(x)),optionalChains:c.map(x=>this.formatChainId(x)),methods:f,events:g,optionalMethods:p,optionalEvents:v,rpcMap:D,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:S,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ra(this.rpc.chains):ra(this.rpc.optionalChains),this.signer=await hx.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await Hm(()=>import("./index-fa2362af.js").then(o=>o.i),["assets/index-fa2362af.js","assets/index-05d1abdc.js","assets/index-aa39e671.css"]);t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(ws({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&ni(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&ni(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${px}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const Bx=ch;export{Bx as EthereumProvider,yx as OPTIONAL_EVENTS,gx as OPTIONAL_METHODS,qu as REQUIRED_EVENTS,Mu as REQUIRED_METHODS,ch as default};